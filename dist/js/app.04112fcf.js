(function(t){function e(e){for(var o,a,r=e[0],h=e[1],c=e[2],d=0,u=[];d<r.length;d++)a=r[d],Object.prototype.hasOwnProperty.call(n,a)&&n[a]&&u.push(n[a][0]),n[a]=0;for(o in h)Object.prototype.hasOwnProperty.call(h,o)&&(t[o]=h[o]);l&&l(e);while(u.length)u.shift()();return s.push.apply(s,c||[]),i()}function i(){for(var t,e=0;e<s.length;e++){for(var i=s[e],o=!0,r=1;r<i.length;r++){var h=i[r];0!==n[h]&&(o=!1)}o&&(s.splice(e--,1),t=a(a.s=i[0]))}return t}var o={},n={app:0},s=[];function a(e){if(o[e])return o[e].exports;var i=o[e]={i:e,l:!1,exports:{}};return t[e].call(i.exports,i,i.exports,a),i.l=!0,i.exports}a.m=t,a.c=o,a.d=function(t,e,i){a.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},a.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.t=function(t,e){if(1&e&&(t=a(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(a.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)a.d(i,o,function(e){return t[e]}.bind(null,o));return i},a.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return a.d(e,"a",e),e},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.p="";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],h=r.push.bind(r);r.push=e,r=r.slice();for(var c=0;c<r.length;c++)e(r[c]);var l=h;s.push([0,"chunk-vendors"]),i()})({0:function(t,e,i){t.exports=i("56d7")},"0346":function(t,e,i){"use strict";var o=i("ee91"),n=i.n(o);n.a},"034f":function(t,e,i){"use strict";var o=i("85ec"),n=i.n(o);n.a},"12be":function(t,e,i){},"233e":function(t,e,i){"use strict";var o=i("2c62"),n=i.n(o);n.a},"2c62":function(t,e,i){},3504:function(t){t.exports=JSON.parse('{"node":{"head":"外形","fill":"背景","stroke":"边框","font":"文字","fontSize":"大小","fontStyle":"样式","textFill":"颜色","position":"位置","nodeAlign":"对齐方式","prefabrication":"预制样式"},"group":{"head":"外形","fill":"背景","stroke":"边框","showHead":"显示头部","font":"文字","fontStyle":"样式","fontSize":"大小","fontBackground":"背景","align":"对齐方式","textFill":"颜色","position":"位置","prefabrication":"预制样式"},"edge":{"head":"样式","fill":"文字背景","stroke":"边框","lineDash":"线段样式","lineStyle":"线段形式","turningDistance":"转折距离","font":"文字","fontStyle":"样式","fontSize":"大小","textFill":"颜色","nodeAlign":"节点对齐","position":"Position","prefabrication":"预制样式"}}')},3821:function(t,e,i){},4481:function(t,e,i){t.exports=i.p+"img/icon-save.41b84637.svg"},4813:function(t,e,i){},5490:function(t,e,i){"use strict";var o=i("a6b6"),n=i.n(o);n.a},"56d7":function(t,e,i){"use strict";i.r(e);i("e260"),i("e6cf"),i("cca6"),i("a79d"),i("b64b"),i("159b");var o=i("2b0e"),n=i("a925");o["a"].use(n["a"]);var s="zh",a="localeLanguage",r={zh:i("3504"),en:i("edd4")},h=new n["a"]({locale:s,messages:r}),c=function(t){void 0===t&&(t=window.localStorage.getItem(a),void 0===r[t]&&(t=s)),window.localStorage.setItem(a,t),Object.keys(r).forEach((function(t){document.body.classList.remove("lang-".concat(t))})),document.body.classList.add("lang-".concat(t)),document.body.setAttribute("lang",t),o["a"].config.lang=t,h.locale=t};window.i18n=h;var l=h,d=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"app"}},[i("MainPage")],1)},u=[],f=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"MainPage"},[i("Header"),i("Toolbar"),i("Editor"),i("Property"),i("Map")],1)},p=[],g=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"header"},[o("span",{staticClass:"iconfont icon-open",staticStyle:{float:"left","margin-left":"10px","font-size":"18px"},on:{click:function(e){return e.stopPropagation(),t.openFile(e)}}}),o("ul",[t._l(t.icon,(function(e,i){return o("li",{key:i,class:"iconfont "+e.icon+" "+e.class,attrs:{title:e.cmd},on:{click:function(i){return t.command(e)}}})})),o("li",{on:{click:function(e){return e.stopPropagation(),t.save("local")}}},[o("img",{staticClass:"icon-save",attrs:{src:i("4481"),title:"save"}})]),o("li",{attrs:{title:"output"}},[o("span",{staticClass:"iconfont icon-upload-demo",on:{click:function(e){return e.stopPropagation(),t.showUpload(e)}}}),o("ul",{directives:[{name:"show",rawName:"v-show",value:t.upload,expression:"upload"}]},[o("li",{staticClass:"iconfont icon-JSON",on:{click:function(e){return e.stopPropagation(),t.save("json")}}},[o("span",[t._v("JSON")])]),o("li",{staticClass:"iconfont icon-PNG",on:{click:function(e){return e.stopPropagation(),t.save("png")}}},[o("span",[t._v("PNG")])]),o("li",{staticClass:"iconfont icon-jpg",on:{click:function(e){return e.stopPropagation(),t.save("case")}}},[o("span",[t._v("CASE")])])])])],2),o("input",{staticStyle:{display:"none"},attrs:{type:"file",id:"file"}}),o("div",{staticClass:"language",on:{mouseenter:t.mouseenter,mouseleave:t.mouseleave}},[o("span",[t._v(t._s(t.lang))]),o("ul",{directives:[{name:"show",rawName:"v-show",value:t.showLang,expression:"showLang"}]},[o("li",{on:{click:function(e){return e.stopPropagation(),t.changeLanguage("zh")}}},[t._v("中文")]),o("li",{on:{click:function(e){return e.stopPropagation(),t.changeLanguage("en")}}},[t._v("English")])])])])},y=[],x=(i("c975"),i("b0c0"),i("8a79"),new o["a"]),v={name:"Header",data:function(){return{language:"zh",showLang:!1,icon:[{icon:"icon-undo",name:"撤销",cmd:"undo",class:"disable"},{icon:"icon-redo",name:"恢复",cmd:"redo",class:"disable"},{icon:"icon-fengexian",name:"分割",cmd:"line",class:"disable"},{icon:"icon-copy",name:"复制",cmd:"copy",class:"disable"},{icon:"icon-shanchu",name:"删除",cmd:"delete",class:"disable"},{icon:"icon-fengexian",name:"分割",cmd:"line",class:"disable"}],disable:!0,upload:!1}},computed:{lang:function(){return"zh"==this.language?"中文":"English"}},mounted:function(){var t=this;x.$on("selectNode",(function(){t.status="selectNode",t.changeDisable(!0)})),x.$on("selectNodes",(function(){t.status="selectNodes",t.changeDisable(!0)})),x.$on("clearSelect",(function(){t.status="clearSelect",t.changeDisable(!1)})),x.$on("selectGroup",(function(){t.status="selectGroup",t.changeDisable(!0)})),x.$on("undoredo",(function(e){t.enableUndo(e.undo),t.enableRedo(e.redo)})),x.$on("selectEdge",(function(){t.status="selectEdge",t.changeDisable(!0)}));var e=document.getElementById("file");e.addEventListener("change",(function(t){var i=t.target.files[0];if(i&&i.name.endsWith("json")){var o=new FileReader;o.readAsText(i),o.onload=function(){try{x.$emit("initFlow",{data:JSON.parse(this.result)})}catch(t){alert("数据出错")}}}e.value=""}),!1),this.language=localStorage.getItem("localeLanguage")||"zh",this.changeLanguage(this.language)},methods:{openFile:function(){document.getElementById("file").click()},changeLanguage:function(t){this.language=t,x.$emit("changeLanguage",{language:t})},mouseenter:function(){this.showLang=!0},mouseleave:function(){this.showLang=!1},command:function(t){"disable"!=t.class&&x.$emit(t.cmd)},changeDisable:function(t){t?this.icon.forEach((function(t){-1==["undo","redo"].indexOf(t.cmd)&&(t.class="")})):this.icon.forEach((function(t){-1==["undo","redo"].indexOf(t.cmd)&&(t.class="disable")})),this.disable=t},enableUndo:function(t){this.icon[0].class=t?"":"disable"},enableRedo:function(t){this.icon[1].class=t?"":"disable"},showUpload:function(){this.upload=!this.upload},save:function(t){this.upload=!1,x.$emit("saveData",{type:t})}}},m=v,w=(i("7afc"),i("2877")),b=Object(w["a"])(m,g,y,!1,null,"79228928",null),k=b.exports,O=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"toolbar"},[t._l(t.shape,(function(e){return i("div",{key:e.id,staticClass:"shape clearfix"},[i("div",{staticClass:"shape-header"},[t._v(t._s(e.header))]),"line"===e.id?i("ul",t._l(e.icon,(function(e){return i("li",{key:e.command,class:"iconfont "+e.iconName+(e.isActive?" active":""),attrs:{draggable:"false"},on:{click:function(i){return t.handleLineTypeClick(e)}}},[i("div",{attrs:{title:e.text},domProps:{innerHTML:t._s(e.path)}})])})),0):i("ul",t._l(e.icon,(function(e){return i("li",{key:e.command,class:"iconfont "+e.iconName,attrs:{draggable:"true"},on:{dragstart:function(i){return t.dragstart(i,e)}}},[i("div",{attrs:{title:e.text},domProps:{innerHTML:t._s(e.path)}})])})),0)])})),t.customize.length?i("div",{staticClass:"shape clearfix shape-image"},[i("div",{staticClass:"shape-header clearfix"},[t._v(" My Images ")]),i("ul",{staticClass:"clearfix"},t._l(t.precustomize,(function(e,o){return i("li",{key:o,attrs:{draggable:"true"},on:{dragstart:function(i){return t.dragstart(i,e)}}},[i("img",{attrs:{draggable:"false",src:e.image,alt:""}})])})),0),t.customize.length>=15?i("div",{staticClass:"shape-header clearfix",staticStyle:{"text-align":"center","font-size":"12px"},on:{click:function(e){e.stopPropagation(),t.showAllImage=!t.showAllImage}}},[t._v(" More Images ")]):t._e(),t.showAllImage?i("ul",{staticClass:"all-image clearfix"},t._l(t.customize,(function(e,o){return i("li",{key:o,attrs:{draggable:"true"},on:{dragstart:function(i){return t.dragstart(i,e)}}},[i("img",{attrs:{draggable:"false",src:e.image,alt:""}})])})),0):t._e()]):t._e(),i("div",{staticClass:"toolbar-btn",on:{click:function(e){e.stopPropagation(),t.showCustomize=!t.showCustomize}}},[t._v(" + 添加自定义 ")]),t.showCustomize?i("div",{staticClass:"customize-win"},[i("div",{staticClass:"customize-win-header"},[i("span",[t._v("添加自定义图片")]),i("div",{staticClass:"close iconfont icon-guanbi",on:{click:function(e){e.stopPropagation(),t.showCustomize=!1}}})]),i("div",{staticClass:"customize-image"},[i("ul",[t._l(t.customize,(function(e,o){return i("li",{key:o,attrs:{draggable:"true"}},[i("span",{staticClass:"iconfont icon-guanbi",on:{click:function(i){return i.stopPropagation(),t.removeImage(e)}}}),i("img",{attrs:{draggable:"false",src:e.image,alt:""}})])})),i("li",{on:{click:function(e){e.stopPropagation(),t.showUpload=!t.showUpload}}},[i("span",{staticClass:"iconfont icon-add",staticStyle:{color:"#666","font-size":"48px","line-height":"44px","text-align":"center",cursor:"pointer"}})])],2)])]):t._e(),t.showUpload?i("div",{staticClass:"upload-win"},[i("div",{staticClass:"customize-win-header"},[i("div",{staticClass:"close iconfont icon-guanbi",on:{click:function(e){e.stopPropagation(),t.showUpload=!1}}})]),i("div",{staticClass:"upload-win-content"},[i("span",[t._v("图片链接")]),i("input",{directives:[{name:"model",rawName:"v-model",value:t.imageUrl,expression:"imageUrl"}],staticClass:"image-url",attrs:{placeholder:"请输入图片链接",type:"text"},domProps:{value:t.imageUrl},on:{input:function(e){e.target.composing||(t.imageUrl=e.target.value)}}}),t._m(0)]),i("div",{staticClass:"upload-win-footer"},[i("button",{on:{click:t.addImage}},[t._v("确定")])])]):t._e()],2)},T=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("ul",[i("li",[t._v(" 图床选择 "),i("ul",[i("li",[i("a",{attrs:{href:"https://postimages.org/",target:"_blank"}},[t._v("postimages")])]),i("li",[i("a",{attrs:{href:"https://sm.ms/",target:"_blank"}},[t._v("sm.ms")])])])])])}],D=(i("fb6a"),i("a434"),i("2ca0"),{name:"Toolbar",data:function(){return{showCustomize:!1,showUpload:!1,showAllImage:!1,imageUrl:"",shape:[{id:"line",header:"Line",icon:[{iconName:"icon-zhixianjiantou",text:"rounded rectangle",type:"line",isActive:!1},{iconName:"icon-zhexianjiantou",text:"rounded rectangle",type:"polyline",isActive:!0},{iconName:"icon-quxianjiantou",text:"rounded rectangle",type:"bs",isActive:!1}]},{id:"flowChart",header:"FlowChart",icon:[{path:'<svg style="left: 1px; top: 1px; width: 32px; height: 30px; display: block; position: relative; overflow: hidden;"><g><g></g><g><g transform="translate(0.5,0.5)" style="visibility: visible;"><rect x="1.44" y="7.68" width="28.8" height="14.4" rx="2.16" ry="2.16" fill="#ffffff" stroke="#000000" stroke-width="1.3" pointer-events="all"></rect></g></g><g></g><g></g></g></svg>',iconName:"",text:"rounded rectangle",command:"rectangle"},{path:'<svg style="left: 1px; top: 1px; width: 32px; height: 30px; display: block; position: relative; overflow: hidden;"><g><g></g><g><g transform="translate(0.5,0.5)" style="visibility: visible;"><ellipse cx="15.98" cy="14.96" rx="13.600000000000001" ry="13.600000000000001" fill="#ffffff" stroke="#000000" stroke-width="1.3" pointer-events="all"></ellipse></g></g><g></g><g></g></g></svg>',iconName:"circle",text:"圆形",command:"circular"},{path:'<svg style="left: 1px; top: 1px; width: 32px; height: 30px; display: block; position: relative; overflow: hidden;"><g><g></g><g><g transform="translate(0.5,0.5)" style="visibility: visible;"><rect x="0.73" y="7.3" width="29.2" height="14.6" fill="none" stroke="white" pointer-events="stroke" visibility="hidden" stroke-width="9"></rect><rect x="0.73" y="7.3" width="29.2" height="14.6" fill="none" stroke="none" pointer-events="all"></rect></g><g style=""><g transform="translate(7,10)scale(0.73)"><foreignObject style="overflow:visible;" pointer-events="all" width="22" height="12"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 24px; white-space: normal; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">Text</div></div></foreignObject></g></g></g><g></g><g></g></g></svg>',iconName:"",text:"text",command:"text"},{path:'<svg style="left: 1px; top: 1px; width: 32px; height: 30px; display: block; position: relative; overflow: hidden;"><g><g></g><g><g transform="translate(0.5,0.5)" style="visibility: visible;"><path d="M 15.98 1.36 L 29.58 14.96 L 15.98 28.56 L 2.38 14.96 Z" fill="#ffffff" stroke="#000000" stroke-width="1.3" stroke-miterlimit="10" pointer-events="all"></path></g></g><g></g><g></g></g></svg>',iconName:"",text:"diamond",command:"diamond"},{path:'<svg style="left: 1px; top: 1px; width: 32px; height: 30px; display: block; position: relative; overflow: hidden;"><g><g></g><g><g transform="translate(0.5,0.5)" style="visibility: visible;"><path d="M 1.44 22.08 L 7.2 7.68 L 30.24 7.68 L 24.48 22.08 Z" fill="#ffffff" stroke="#000000" stroke-width="1.3" stroke-miterlimit="10" pointer-events="all"></path></g></g><g></g><g></g></g></svg>',iconName:"",text:"parallelogram",command:"parallelogram"},{path:'<svg style="left: 1px; top: 1px; width: 32px; height: 30px; display: block; position: relative; overflow: hidden;"><g><g></g><g><g transform="translate(0.5,0.5)" style="visibility: visible;"><path d="M 1.2 10.5 L 18.81 10.5 L 18.81 4.5 L 30.3 15 L 18.81 25.5 L 18.81 19.5 L 1.2 19.5 Z" fill="#ffffff" stroke="#000000" stroke-width="1.3" stroke-miterlimit="10" pointer-events="all"></path></g></g><g></g><g></g></g></svg>',iconName:"",text:"right arrow",command:"arrowRight"},{path:'<svg style="left: 1px; top: 1px; width: 32px; height: 30px; display: block; position: relative; overflow: hidden;"><g><g></g><g><g transform="translate(0.5,0.5)" style="visibility: visible;"><path d="M 10.2 6 L 21.6 6 C 26.57 6 30.6 10.03 30.6 15 C 30.6 19.97 26.57 24 21.6 24 L 10.2 24 C 5.23 24 1.2 19.97 1.2 15 C 1.2 10.03 5.23 6 10.2 6 Z" fill="#ffffff" stroke="#000000" stroke-width="1.3" stroke-miterlimit="10" pointer-events="all"></path></g></g><g></g><g></g></g></svg>',iconName:"",text:"terminator",command:"roundRect"}]}],customize:[]}},computed:{precustomize:function(){return this.customize.slice().splice(0,15)}},mounted:function(){var t=localStorage.getItem("customize-icon");try{if(t){var e=JSON.parse(t);this.customize=e}}catch(i){window.console.log(i)}},methods:{addImage:function(){if(this.imageUrl&&this.imageUrl.startsWith("http")){var t={image:this.imageUrl};this.customize.push(t),this.store(),this.showUpload=!1,this.imageUrl=""}},store:function(){localStorage.setItem("customize-icon",JSON.stringify(this.customize))},removeImage:function(t){var e=this.customize.indexOf(t);e>-1&&(this.customize.splice(e,1),this.store())},dragstart:function(t,e){t.dataTransfer.setData("addShape",JSON.stringify(e))},handleLineTypeClick:function(t){x.$emit("changeCurLineType",t.type),this.shape.forEach((function(t){"line"===t.id&&t.icon.forEach((function(t){t.isActive=!1}))})),t.isActive=!0},uploadImage:function(t){var e=t.target.files[0];if(e){var i=e.type,o=new FormData;o.append("smfile",e),["image/jpeg","image/png"].indexOf(i)>-1&&this.ajax({method:"POST",url:"https://sm.ms//api/v2/upload",body:o,succseeFn:function(t){window.console.log(t)},failFn:function(t){window.console.log(t)}})}},ajax:function(t){var e=t.method,i=t.url,o=t.body,n=t.succseeFn,s=t.failFn,a=new XMLHttpRequest;a.open(e,i,!0),a.setRequestHeader("Content-type","multipart/form-data"),a.setRequestHeader("Authorization",""),a.onreadystatechange=function(){4===a.readyState&&(a.status>=200&&a.status<300?n.call(void 0,a.responseText):a.status>=400&&s.call(void 0,a))},a.send(o)}}}),P=D,j=(i("233e"),Object(w["a"])(P,O,T,!1,null,"74b5ebad",null)),S=j.exports,E=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"editor",on:{dragover:t.dragover,dragstart:t.dragstart,drop:t.drop}},[i("div",{attrs:{id:"flowEditor"}}),i("Edit",{directives:[{name:"show",rawName:"v-show",value:t.editModel,expression:"editModel"}],ref:"edit",staticClass:"text-editor",style:{left:t.left+"px",top:t.top+"px","min-width":t.width+"px","min-height":t.height+"px"},on:{blurFunc:t.updateText},model:{value:t.text,callback:function(e){t.text=e},expression:"text"}}),i("div",{staticClass:"download-win",attrs:{id:"download-win"}},[i("div",{staticClass:"download-header"},[t._v(" 请右击下载 "),i("span",{staticClass:"iconfont icon-guanbi",staticStyle:{float:"right",color:"red","margin-right":"6px"},on:{click:function(e){return e.stopPropagation(),t.closeDownLoadWin(e)}}})]),i("div",{attrs:{id:"download-canvas"}})])],1)},C=[],z=(i("99af"),i("a15b"),i("d3b7"),i("e25e"),i("ac1f"),i("3ca3"),i("5319"),i("1276"),i("498a"),i("ddb0"),i("2b3d"),i("3b18"),i("f64c")),N=(i("a4d3"),i("4de4"),i("d81d"),i("e439"),i("dbb4"),i("acd8"),i("25f0"),i("ade3")),G=i("d4ec"),A=i("bee2"),F=i("99de"),_=i("7e84"),I=i("257e"),B=i("262e"),$=i("95c0"),R=i.n($),L=function(){function t(e){Object(G["a"])(this,t),this.limit=e||30,this.undos=[],this.redos=[],this.saveCommand=null}return Object(A["a"])(t,[{key:"execute",value:function(t){this.clearRedo(),t.execute();var e=this.undos.length;e>=this.limit&&this.undos.shift(),this.undos.push(t),this.change(t)}},{key:"undo",value:function(){if(this.canUndo()){var t=this.undos.pop();this.redos.push(t),t.undo(),this.change(t)}}},{key:"canUndo",value:function(){return this.undos.length}},{key:"redo",value:function(){if(this.canRedo()){var t=this.redos.pop();this.undos.push(t),t.redo(),this.change(t)}}},{key:"canRedo",value:function(){return this.redos.length}},{key:"save",value:function(){this.saveCommand,this.undos[this.undos.length-1]}},{key:"dirty",value:function(){return this.saveCommand!=this.undos[this.undos.length-1]}},{key:"clearRedo",value:function(){this.redos=[]}},{key:"clear",value:function(){this.undos=[],this.redos=[],this.saveCommand=null,this.change({name:"clear"})}},{key:"change",value:function(){}}]),t}(),W=L;i("cb29");function M(t,e){for(var i in t)i in e||(e[i]=t[i]);return e}var H=M,q={getAnchors:function(){return this.anchors.slice()},getAnchorByIndex:function(t){return this.anchors.filter((function(e){return e.index==t}))[0]},active:function(){this.selected=!0,this.attr({style:{shadowColor:"yellow",shadowBlur:3}})},unactive:function(){this.selected=!1,this.attr({style:{shadowColor:"",shadowBlur:0}})},refreshEdge:function(){this.createAnchors(),this.anch&&this.anch.refresh(),this.__zr&&this.__zr.trigger("refreshEdge",{node:this})}},U=function(t){function e(t){var i;return Object(G["a"])(this,e),i=Object(F["a"])(this,Object(_["a"])(e).call(this,t)),i.data=t,i.oldfill=i.data.style.fill,i.anchors=[],i.nodeType="node",i.createAnchors(),i}return Object(B["a"])(e,t),Object(A["a"])(e,[{key:"createAnchors",value:function(){this.anchors=[];var t=new R.a.Group,e=t.getBoundingRect([this]),i={x:e.x+e.width/2,y:e.y,index:1,node:this,direct:"top"},o={x:e.x+e.width,y:e.y+e.height/2,index:2,node:this,direct:"right"},n={x:e.x+e.width/2,y:e.y+e.height,index:3,node:this,direct:"bottom"},s={x:e.x,y:e.y+e.height/2,index:4,node:this,direct:"left"};this.anchors.push(i,o,n,s)}}]),e}(R.a.Rect);H(q,U.prototype);var J=U,Y=function(t){function e(t){var i;return Object(G["a"])(this,e),i=Object(F["a"])(this,Object(_["a"])(e).call(this,t)),i.data=t,i.oldfill=i.data.style.fill,i.anchors=[],i.nodeType="node",i.createAnchors(),i}return Object(B["a"])(e,t),Object(A["a"])(e,[{key:"createAnchors",value:function(){this.anchors=[];var t=new R.a.Group,e=t.getBoundingRect([this]),i=e.y+e.height/2,o={x:e.x+e.width/2,y:e.y,index:1,node:this,direct:"top"},n={x:e.x+e.width,y:e.y+e.height/2,index:2,node:this,direct:"right"},s={x:e.x+e.width/2,y:e.y+e.height,index:3,node:this,direct:"bottom"},a={x:e.x,y:e.y+e.height/2,index:4,node:this,direct:"left"};this.anchors.push(o,n,s,a);var r=this.getPoint(e.width/4,e),h={x:e.x+3*e.width/4,y:i+r-2,index:5,node:this,direct:"right"},c={x:e.x+3*e.width/4,y:i-r+2,index:6,node:this,direct:"right"},l={x:e.x+e.width/4,y:i+r-2,index:7,node:this,direct:"left"},d={x:e.x+e.width/4,y:i-r+2,index:8,node:this,direct:"left"};this.anchors.push(h,c,l,d)}},{key:"getPoint",value:function(t,e){var i=e.width/2,o=e.height/2,n=Math.sqrt(o*o*Math.sqrt(1-t*t/(i*i)));return n}}]),e}(R.a.Ellipse);H(q,Y.prototype);var X=Y,Q=R.a.Path.extend({type:"diamond",shape:{x:0,y:0,width:0,height:0},buildPath:function(t,e){var i=e.x,o=e.y,n=e.height,s=e.width;t.moveTo(i+s/2,o),t.lineTo(i+s,o+n/2),t.lineTo(i+s/2,o+n),t.lineTo(i,o+n/2),t.closePath()}}),Z=function(t){function e(t){var i;return Object(G["a"])(this,e),i=Object(F["a"])(this,Object(_["a"])(e).call(this,t)),i.data=t,i.oldfill=i.data.style.fill,i.anchors=[],i.nodeType="node",i.createAnchors(),i}return Object(B["a"])(e,t),Object(A["a"])(e,[{key:"createAnchors",value:function(){var t=new R.a.Group;this.anchors=[];var e=t.getBoundingRect([this]),i={x:e.x+e.width/2,y:e.y,index:1,node:this,direct:"top"},o={x:e.x+e.width,y:e.y+e.height/2,index:2,node:this,direct:"right"},n={x:e.x+e.width/2,y:e.y+e.height,index:3,node:this,direct:"bottom"},s={x:e.x,y:e.y+e.height/2,index:4,node:this,direct:"left"};this.anchors.push(i,o,n,s)}}]),e}(Q);H(q,Z.prototype);var K=Z,V=R.a.Path.extend({type:"parallelogram",shape:{x:0,y:0,width:0,height:0},buildPath:function(t,e){var i=e.x,o=e.y,n=e.height,s=e.width;t.moveTo(i+s/6,o),t.lineTo(i+s,o),t.lineTo(i+5*s/6,o+n),t.lineTo(i,o+n),t.closePath()}}),tt=function(t){function e(t){var i;return Object(G["a"])(this,e),i=Object(F["a"])(this,Object(_["a"])(e).call(this,t)),i.data=t,i.oldfill=i.data.style.fill,i.anchors=[],i.nodeType="node",i.createAnchors(),i}return Object(B["a"])(e,t),Object(A["a"])(e,[{key:"createAnchors",value:function(){this.anchors=[];var t=new R.a.Group,e=t.getBoundingRect([this]),i={x:e.x+e.width/2,y:e.y,index:1,node:this,direct:"top"},o={x:e.x+11*e.width/12,y:e.y+e.height/2,index:2,node:this,direct:"right"},n={x:e.x+e.width/2,y:e.y+e.height,index:3,node:this,direct:"bottom"},s={x:e.x+e.width/12,y:e.y+e.height/2,index:4,node:this,direct:"left"};this.anchors.push(i,o,n,s)}}]),e}(V);H(q,tt.prototype);var et=tt,it=R.a.Path.extend({type:"cloud",shape:{x:0,y:0,width:0,height:0},buildPath:function(t,e){var i,o,n=e.x,s=e.y,a=e.height,r=e.width,h=20,c=parseInt(r/h),l=parseInt(a/h);t.moveTo(n,s);for(var d=1;d<=c;d++){i=n+d*h,o=s;var u=i-h/2,f=o-h/2;t.quadraticCurveTo(u,f,i,o)}if(r%h!=0){var p=r-c*h,g=i+p/2,y=s-h/2;t.quadraticCurveTo(g,y,n+r,s)}for(var x=1;x<=l;x++){i=n+r,o=s+x*h;var v=i+h/2,m=o-h/2;t.quadraticCurveTo(v,m,i,o)}if(a%h!=0){var w=a-l*h,b=i+h/2,k=o+w/2;t.quadraticCurveTo(b,k,n+r,s+a)}for(var O=1;O<=c;O++){i=n+r-h*O,o=s+a;var T=i+h/2,D=o+h/2;t.quadraticCurveTo(T,D,i,o),t.lineTo(i,o)}if(r%h!=0){var P=r-c*h,j=i-P/2,S=o+h/2;t.quadraticCurveTo(j,S,n,s+a)}for(var E=1;E<=l;E++){i=n,o=s+a-E*h;var C=i-h/2,z=o+h/2;t.quadraticCurveTo(C,z,i,o)}if(a%h!=0){var N=a-l*h,G=i-h/2,A=o-N/2;t.quadraticCurveTo(G,A,n,s)}t.closePath()}}),ot=function(t){function e(t){var i;return Object(G["a"])(this,e),i=Object(F["a"])(this,Object(_["a"])(e).call(this,t)),i.data=t,i.oldfill=i.data.style.fill,i.antchrs=[],i.nodeType="node",i.createAntchrs(),i}return Object(B["a"])(e,t),Object(A["a"])(e,[{key:"createAntchrs",value:function(){this.antchrs=[];var t=new R.a.Group,e=t.getBoundingRect([this]),i={x:e.x+e.width/2,y:e.y,index:1,node:this,direct:"top"},o={x:e.x+e.width,y:e.y+e.height/2,index:2,node:this,direct:"right"},n={x:e.x+e.width/2,y:e.y+e.height,index:3,node:this,direct:"bottom"},s={x:e.x,y:e.y+e.height/2,index:4,node:this,direct:"left"};this.antchrs.push(i,o,n,s)}}]),e}(it);H(q,ot.prototype);var nt=ot,st=R.a.Path.extend({type:"arrowRight",shape:{x:0,y:0,width:0,height:0},buildPath:function(t,e){var i=e.x,o=e.y,n=e.height,s=e.width,a=parseInt(i+s-36),r=parseInt(o+n/5),h=parseInt(o+n/5*4);t.moveTo(i,r),t.lineTo(a,r),t.lineTo(a,o),t.lineTo(i+s,o+n/2),t.lineTo(a,o+n),t.lineTo(a,h),t.lineTo(i,h),t.closePath()}}),at=function(t){function e(t){var i;return Object(G["a"])(this,e),i=Object(F["a"])(this,Object(_["a"])(e).call(this,t)),i.data=t,i.oldfill=i.data.style.fill,i.anchors=[],i.nodeType="node",i.createAnchors(),i}return Object(B["a"])(e,t),Object(A["a"])(e,[{key:"createAnchors",value:function(){var t=new R.a.Group;this.anchors=[];var e=t.getBoundingRect([this]),i={x:e.x+e.width/2,y:e.y+e.height/5,index:1,node:this,direct:"top"},o={x:e.x+e.width,y:e.y+e.height/2,index:2,node:this,direct:"right"},n={x:e.x+e.width/2,y:e.y+e.height/5*4,index:3,node:this,direct:"bottom"},s={x:e.x,y:e.y+e.height/2,index:4,node:this,direct:"left"};this.anchors.push(i,o,n,s)}}]),e}(st);H(q,at.prototype);var rt=at;function ht(t,e){var i,o,n,s,a,r=e.x,h=e.y,c=e.width,l=e.height,d=e.r;c<0&&(r+=c,c=-c),l<0&&(h+=l,l=-l),"number"===typeof d?i=o=n=s=d:d instanceof Array?1===d.length?i=o=n=s=d[0]:2===d.length?(i=n=d[0],o=s=d[1]):3===d.length?(i=d[0],o=s=d[1],n=d[2]):(i=d[0],o=d[1],n=d[2],s=d[3]):i=o=n=s=0,i+o>c&&(a=i+o,i*=c/a,o*=c/a),n+s>c&&(a=n+s,n*=c/a,s*=c/a),o+n>l&&(a=o+n,o*=l/a,n*=l/a),i+s>l&&(a=i+s,i*=l/a,s*=l/a),t.moveTo(r+i,h),t.lineTo(r+c-o,h),0!==o&&t.arc(r+c-o,h+o,o,-Math.PI/2,0),t.lineTo(r+c,h+l-n),0!==n&&t.arc(r+c-n,h+l-n,n,0,Math.PI/2),t.lineTo(r+s,h+l),0!==s&&t.arc(r+s,h+l-s,s,Math.PI/2,Math.PI),t.lineTo(r,h+i),0!==i&&t.arc(r+i,h+i,i,Math.PI,1.5*Math.PI)}var ct=R.a.Path.extend({type:"aroundRect",shape:{x:0,y:0,width:0,height:0},buildPath:function(t,e){var i=e.width,o=e.height,n=Math.max(i,o);e.r=n,ht(t,e),t.closePath()}}),lt=function(t){function e(t){var i;return Object(G["a"])(this,e),i=Object(F["a"])(this,Object(_["a"])(e).call(this,t)),i.data=t,i.oldfill=i.data.style.fill,i.anchors=[],i.nodeType="node",i.createAnchors(),i}return Object(B["a"])(e,t),Object(A["a"])(e,[{key:"createAnchors",value:function(){this.anchors=[];var t=new R.a.Group,e=t.getBoundingRect([this]),i={x:e.x+e.width/2,y:e.y,index:1,node:this,direct:"top"},o={x:e.x+e.width,y:e.y+e.height/2,index:2,node:this,direct:"right"},n={x:e.x+e.width/2,y:e.y+e.height,index:3,node:this,direct:"bottom"},s={x:e.x,y:e.y+e.height/2,index:4,node:this,direct:"left"};this.anchors.push(i,o,n,s)}}]),e}(ct);H(q,lt.prototype);var dt=lt,ut=R.a.Path.extend({type:"preRect",shape:{x:0,y:0,width:0,height:0},buildPath:function(t,e){var i=e.x,o=e.y,n=e.width,s=e.height,a=2;e.r=a,ht(t,e);var r=parseInt(i+n/10),h=parseInt(i+n/10*9);t.moveTo(r,o),t.lineTo(r,o+s),t.moveTo(h,o),t.lineTo(h,o+s),t.closePath()}}),ft=function(t){function e(t){var i;return Object(G["a"])(this,e),i=Object(F["a"])(this,Object(_["a"])(e).call(this,t)),i.data=t,i.oldfill=i.data.style.fill,i.anchors=[],i.nodeType="node",i.createAnchors(),i}return Object(B["a"])(e,t),Object(A["a"])(e,[{key:"createAnchors",value:function(){this.anchors=[];var t=new R.a.Group,e=t.getBoundingRect([this]),i={x:e.x+e.width/2,y:e.y,index:1,node:this,direct:"top"},o={x:e.x+e.width,y:e.y+e.height/2,index:2,node:this,direct:"right"},n={x:e.x+e.width/2,y:e.y+e.height,index:3,node:this,direct:"bottom"},s={x:e.x,y:e.y+e.height/2,index:4,node:this,direct:"left"};this.anchors.push(i,o,n,s)}}]),e}(ut);H(q,ft.prototype);var pt=ft,gt=R.a.Path.extend({type:"document",shape:{x:0,y:0,width:0,height:0},buildPath:function(t,e){var i=e.width,o=e.height,n=e.x,s=e.y;t.moveTo(n,s),t.lineTo(n+i,s),t.lineTo(n+i,s+o-14),t.quadraticCurveTo(n+i/4*3,parseInt(s+o-20),n+i/2,parseInt(s+o-14)),t.quadraticCurveTo(n+i/4,s+o,n,parseInt(s+o-7)),t.lineTo(n,s),t.closePath()}}),yt=function(t){function e(t){var i;return Object(G["a"])(this,e),i=Object(F["a"])(this,Object(_["a"])(e).call(this,t)),i.data=t,i.oldfill=i.data.style.fill,i.anchors=[],i.nodeType="node",i.createAnchors(),i}return Object(B["a"])(e,t),Object(A["a"])(e,[{key:"createAnchors",value:function(){this.anchors=[];var t=new R.a.Group,e=t.getBoundingRect([this]),i={x:e.x+e.width/2,y:e.y,index:1,node:this,direct:"top"},o={x:e.x+e.width,y:e.y+e.height/2,index:2,node:this,direct:"right"},n={x:e.x+e.width/2,y:e.y+e.height-10,index:3,node:this,direct:"bottom"},s={x:e.x,y:e.y+e.height/2,index:4,node:this,direct:"left"};this.anchors.push(i,o,n,s)}}]),e}(gt);H(q,yt.prototype);var xt=yt,vt=R.a.Path.extend({type:"delay",shape:{x:0,y:0,width:0,height:0},buildPath:function(t,e){var i=e.x,o=e.y,n=e.width,s=e.height,a=s/2;t.moveTo(i,o),t.lineTo(i+n-a,o),t.arc(i+n-a,o+a,a,-Math.PI/2,Math.PI/2,!1),t.lineTo(i,o+s),t.closePath()}}),mt=function(t){function e(t){var i;return Object(G["a"])(this,e),i=Object(F["a"])(this,Object(_["a"])(e).call(this,t)),i.data=t,i.oldfill=i.data.style.fill,i.anchors=[],i.nodeType="node",i.createAnchors(),i}return Object(B["a"])(e,t),Object(A["a"])(e,[{key:"createAnchors",value:function(){this.anchors=[];var t=new R.a.Group,e=t.getBoundingRect([this]),i={x:e.x+e.width/2,y:e.y,index:1,node:this,direct:"top"},o={x:e.x+e.width,y:e.y+e.height/2,index:2,node:this,direct:"right"},n={x:e.x+e.width/2,y:e.y+e.height,index:3,node:this,direct:"bottom"},s={x:e.x,y:e.y+e.height/2,index:4,node:this,direct:"left"};this.anchors.push(i,o,n,s)}}]),e}(vt);H(q,mt.prototype);var wt=mt,bt=R.a.Path.extend({type:"card",shape:{x:0,y:0,width:0,height:0},buildPath:function(t,e){var i=e.x,o=e.y,n=e.width,s=e.height;t.moveTo(i+15,o),t.lineTo(i+n,o),t.lineTo(i+n,o+s),t.lineTo(i,o+s),t.lineTo(i,o+15),t.closePath()}}),kt=function(t){function e(t){var i;return Object(G["a"])(this,e),i=Object(F["a"])(this,Object(_["a"])(e).call(this,t)),i.data=t,i.oldfill=i.data.style.fill,i.anchors=[],i.nodeType="node",i.createAnchors(),i}return Object(B["a"])(e,t),Object(A["a"])(e,[{key:"createAnchors",value:function(){this.anchors=[];var t=new R.a.Group,e=t.getBoundingRect([this]),i={x:e.x+e.width/2,y:e.y,index:1,node:this,direct:"top"},o={x:e.x+e.width,y:e.y+e.height/2,index:2,node:this,direct:"right"},n={x:e.x+e.width/2,y:e.y+e.height,index:3,node:this,direct:"bottom"},s={x:e.x,y:e.y+e.height/2,index:4,node:this,direct:"left"};this.anchors.push(i,o,n,s)}}]),e}(bt);H(q,kt.prototype);var Ot=kt,Tt=R.a.Path.extend({type:"cylinder",shape:{x:0,y:0,width:0,height:0},buildPath:function(t,e){var i=e.x,o=e.y,n=e.height,s=e.width;t.moveTo(i,o+5),t.quadraticCurveTo(i+s/6,o,i+s/2,o),t.quadraticCurveTo(i+5*s/6,o,i+s,o+5),t.lineTo(i+s,o+n-5),t.quadraticCurveTo(i+5*s/6,o+n,i+s/2,o+n),t.quadraticCurveTo(i+s/6,o+n,i,o+n-5),t.closePath(),t.moveTo(i+s,o+5),t.quadraticCurveTo(i+5*s/6,o+10,i+s/2,o+10),t.quadraticCurveTo(i+s/6,o+10,i,o+5)}}),Dt=function(t){function e(t){var i;return Object(G["a"])(this,e),i=Object(F["a"])(this,Object(_["a"])(e).call(this,t)),i.data=t,i.oldfill=i.data.style.fill,i.anchors=[],i.nodeType="node",i.createAnchors(),i}return Object(B["a"])(e,t),Object(A["a"])(e,[{key:"createAnchors",value:function(){var t=new R.a.Group;this.anchors=[];var e=t.getBoundingRect([this]),i={x:e.x+e.width/2,y:e.y,index:1,node:this,direct:"top"},o={x:e.x+e.width,y:e.y+e.height/2,index:2,node:this,direct:"right"},n={x:e.x+e.width/2,y:e.y+e.height,index:3,node:this,direct:"bottom"},s={x:e.x,y:e.y+e.height/2,index:4,node:this,direct:"left"};this.anchors.push(i,o,n,s)}}]),e}(Tt);H(q,Dt.prototype);var Pt=Dt,jt=R.a.Path.extend({type:"prepare",shape:{x:0,y:0,width:0,height:0},buildPath:function(t,e){var i=e.x,o=e.y,n=e.width,s=e.height;t.moveTo(i+16,o),t.lineTo(i+n-16,o),t.lineTo(i+n,o+s/2),t.lineTo(i+n-16,o+s),t.lineTo(i+16,o+s),t.lineTo(i,o+s/2),t.closePath()}}),St=function(t){function e(t){var i;return Object(G["a"])(this,e),i=Object(F["a"])(this,Object(_["a"])(e).call(this,t)),i.data=t,i.oldfill=i.data.style.fill,i.anchors=[],i.nodeType="node",i.createAnchors(),i}return Object(B["a"])(e,t),Object(A["a"])(e,[{key:"createAnchors",value:function(){this.anchors=[];var t=new R.a.Group,e=t.getBoundingRect([this]),i={x:e.x+e.width/2,y:e.y,index:1,node:this,direct:"top"},o={x:e.x+e.width,y:e.y+e.height/2,index:2,node:this,direct:"right"},n={x:e.x+e.width/2,y:e.y+e.height,index:3,node:this,direct:"bottom"},s={x:e.x,y:e.y+e.height/2,index:4,node:this,direct:"left"};this.anchors.push(i,o,n,s)}}]),e}(jt);H(q,St.prototype);var Et=St,Ct=R.a.Path.extend({type:"loop",shape:{x:0,y:0,width:0,height:0},buildPath:function(t,e){var i=e.x,o=e.y,n=e.width,s=e.height;t.moveTo(i+16,o),t.lineTo(i+n-16,o),t.lineTo(i+n,o+16),t.lineTo(i+n,o+s),t.lineTo(i,o+s),t.lineTo(i,o+16),t.closePath()}}),zt=function(t){function e(t){var i;return Object(G["a"])(this,e),i=Object(F["a"])(this,Object(_["a"])(e).call(this,t)),i.data=t,i.oldfill=i.data.style.fill,i.anchors=[],i.nodeType="node",i.createAnchors(),i}return Object(B["a"])(e,t),Object(A["a"])(e,[{key:"createAnchors",value:function(){this.anchors=[];var t=new R.a.Group,e=t.getBoundingRect([this]),i={x:e.x+e.width/2,y:e.y,index:1,node:this,direct:"top"},o={x:e.x+e.width,y:e.y+e.height/2,index:2,node:this,direct:"right"},n={x:e.x+e.width/2,y:e.y+e.height,index:3,node:this,direct:"bottom"},s={x:e.x,y:e.y+e.height/2,index:4,node:this,direct:"left"};this.anchors.push(i,o,n,s)}}]),e}(Ct);H(q,zt.prototype);var Nt=zt,Gt=R.a.Path.extend({type:"perhaps",shape:{x:0,y:0,width:0,height:0},buildPath:function(t,e){var i=e.x,o=e.y,n=e.width,s=e.height,a=.5522848,r=i+n/2,h=o+s/2,c=n/2,l=s/2,d=c*a,u=l*a;t.moveTo(r-c,h),t.bezierCurveTo(r-c,h-u,r-d,h-l,r,h-l),t.bezierCurveTo(r+d,h-l,r+c,h-u,r+c,h),t.bezierCurveTo(r+c,h+u,r+d,h+l,r,h+l),t.bezierCurveTo(r-d,h+l,r-c,h+u,r-c,h),t.closePath(),t.moveTo(r,o),t.lineTo(r,o+s),t.moveTo(i,h),t.lineTo(i+n,h)}}),At=function(t){function e(t){var i;return Object(G["a"])(this,e),i=Object(F["a"])(this,Object(_["a"])(e).call(this,t)),i.data=t,i.oldfill=i.data.style.fill,i.anchors=[],i.nodeType="node",i.createAnchors(),i}return Object(B["a"])(e,t),Object(A["a"])(e,[{key:"createAnchors",value:function(){this.anchors=[];var t=new R.a.Group,e=t.getBoundingRect([this]),i={x:e.x+e.width/2,y:e.y,index:1,node:this,direct:"top"},o={x:e.x+e.width,y:e.y+e.height/2,index:2,node:this,direct:"right"},n={x:e.x+e.width/2,y:e.y+e.height,index:3,node:this,direct:"bottom"},s={x:e.x,y:e.y+e.height/2,index:4,node:this,direct:"left"};this.anchors.push(i,o,n,s)}}]),e}(Gt);H(q,At.prototype);var Ft=At,_t=R.a.Path.extend({type:"contrast",shape:{x:0,y:0,width:0,height:0},buildPath:function(t,e){var i=e.x,o=e.y,n=e.width,s=e.height;t.moveTo(i,o),t.lineTo(i+n,o),t.lineTo(i,o+s),t.lineTo(i+n,o+s),t.closePath()}}),It=function(t){function e(t){var i;return Object(G["a"])(this,e),i=Object(F["a"])(this,Object(_["a"])(e).call(this,t)),i.data=t,i.oldfill=i.data.style.fill,i.anchors=[],i.nodeType="node",i.createAnchors(),i}return Object(B["a"])(e,t),Object(A["a"])(e,[{key:"createAnchors",value:function(){this.anchors=[];var t=new R.a.Group,e=t.getBoundingRect([this]),i={x:e.x+e.width/2,y:e.y,index:1,node:this,direct:"top"},o={x:e.x+e.width,y:e.y+e.height/2,index:2,node:this,direct:"right"},n={x:e.x+e.width/2,y:e.y+e.height,index:3,node:this,direct:"bottom"},s={x:e.x,y:e.y+e.height/2,index:4,node:this,direct:"left"};this.anchors.push(i,o,n,s)}}]),e}(_t);H(q,It.prototype);var Bt=It,$t=R.a.Path.extend({type:"sort",shape:{x:0,y:0,width:0,height:0},buildPath:function(t,e){var i=e.x,o=e.y,n=e.width,s=e.height;t.moveTo(i+n/2,o),t.lineTo(i+n,o+s/2),t.lineTo(i+n/2,o+s),t.lineTo(i,o+s/2),t.closePath(),t.moveTo(i,o+s/2),t.lineTo(i+n,o+s/2)}}),Rt=function(t){function e(t){var i;return Object(G["a"])(this,e),i=Object(F["a"])(this,Object(_["a"])(e).call(this,t)),i.data=t,i.oldfill=i.data.style.fill,i.anchors=[],i.nodeType="node",i.createAnchors(),i}return Object(B["a"])(e,t),Object(A["a"])(e,[{key:"createAnchors",value:function(){this.anchors=[];var t=new R.a.Group,e=t.getBoundingRect([this]),i={x:e.x+e.width/2,y:e.y,index:1,node:this,direct:"top"},o={x:e.x+e.width,y:e.y+e.height/2,index:2,node:this,direct:"right"},n={x:e.x+e.width/2,y:e.y+e.height,index:3,node:this,direct:"bottom"},s={x:e.x,y:e.y+e.height/2,index:4,node:this,direct:"left"};this.anchors.push(i,o,n,s)}}]),e}($t);H(q,Rt.prototype);var Lt=Rt,Wt=R.a.Path.extend({type:"display",shape:{x:0,y:0,width:0,height:0},buildPath:function(t,e){var i=e.x,o=e.y,n=e.width,s=e.height,a=s/2;t.moveTo(i+16,o),t.lineTo(i+n-a,o),t.arc(i+n-a,o+a,a,-Math.PI/2,Math.PI/2,!1),t.lineTo(i+16,o+s),t.lineTo(i,o+s/2),t.closePath()}}),Mt=function(t){function e(t){var i;return Object(G["a"])(this,e),i=Object(F["a"])(this,Object(_["a"])(e).call(this,t)),i.data=t,i.oldfill=i.data.style.fill,i.anchors=[],i.nodeType="node",i.createAnchors(),i}return Object(B["a"])(e,t),Object(A["a"])(e,[{key:"createAnchors",value:function(){this.anchors=[];var t=new R.a.Group,e=t.getBoundingRect([this]),i={x:e.x+e.width/2,y:e.y,index:1,node:this,direct:"top"},o={x:e.x+e.width,y:e.y+e.height/2,index:2,node:this,direct:"right"},n={x:e.x+e.width/2,y:e.y+e.height,index:3,node:this,direct:"bottom"},s={x:e.x,y:e.y+e.height/2,index:4,node:this,direct:"left"};this.anchors.push(i,o,n,s)}}]),e}(Wt);H(q,Mt.prototype);var Ht=Mt,qt=R.a.Path.extend({type:"store",shape:{x:0,y:0,width:0,height:0},buildPath:function(t,e){var i=e.x,o=e.y,n=e.width,s=e.height;t.moveTo(i,o),t.lineTo(i+n,o),t.lineTo(i+n,o+s),t.lineTo(i,o+s),t.closePath(),t.moveTo(i+10,o),t.lineTo(i+10,o+s),t.moveTo(i,o+10),t.lineTo(i+n,o+10)}}),Ut=function(t){function e(t){var i;return Object(G["a"])(this,e),i=Object(F["a"])(this,Object(_["a"])(e).call(this,t)),i.data=t,i.oldfill=i.data.style.fill,i.anchors=[],i.nodeType="node",i.createAnchors(),i}return Object(B["a"])(e,t),Object(A["a"])(e,[{key:"createAnchors",value:function(){this.anchors=[];var t=new R.a.Group,e=t.getBoundingRect([this]),i={x:e.x+e.width/2,y:e.y,index:1,node:this,direct:"top"},o={x:e.x+e.width,y:e.y+e.height/2,index:2,node:this,direct:"right"},n={x:e.x+e.width/2,y:e.y+e.height,index:3,node:this,direct:"bottom"},s={x:e.x,y:e.y+e.height/2,index:4,node:this,direct:"left"};this.anchors.push(i,o,n,s)}}]),e}(qt);H(q,Ut.prototype);var Jt=Ut,Yt=R.a.Path.extend({type:"manualInput",shape:{x:0,y:0,width:0,height:0},buildPath:function(t,e){var i=e.x,o=e.y,n=e.width,s=e.height;t.moveTo(i,o+16),t.lineTo(i+n,o),t.lineTo(i+n,o+s),t.lineTo(i,o+s),t.closePath()}}),Xt=function(t){function e(t){var i;return Object(G["a"])(this,e),i=Object(F["a"])(this,Object(_["a"])(e).call(this,t)),i.data=t,i.oldfill=i.data.style.fill,i.anchors=[],i.nodeType="node",i.createAnchors(),i}return Object(B["a"])(e,t),Object(A["a"])(e,[{key:"createAnchors",value:function(){this.anchors=[];var t=new R.a.Group,e=t.getBoundingRect([this]),i={x:e.x+e.width/2,y:e.y,index:1,node:this,direct:"top"},o={x:e.x+e.width,y:e.y+e.height/2,index:2,node:this,direct:"right"},n={x:e.x+e.width/2,y:e.y+e.height,index:3,node:this,direct:"bottom"},s={x:e.x,y:e.y+e.height/2,index:4,node:this,direct:"left"};this.anchors.push(i,o,n,s)}}]),e}(Yt);H(q,Xt.prototype);var Qt=Xt,Zt=R.a.Path.extend({type:"paperBag",shape:{x:0,y:0,width:0,height:0},buildPath:function(t,e){var i=e.x,o=e.y,n=e.width,s=e.height;t.moveTo(i,o),t.quadraticCurveTo(i+n/4,o+10,i+n/2,o),t.quadraticCurveTo(i+3*n/4,o-10,i+n,o),t.lineTo(i+n,o+s),t.quadraticCurveTo(i+3*n/4,o+s-10,i+n/2,o+s),t.quadraticCurveTo(i+n/4,o+s+10,i,o+s),t.closePath()}}),Kt=function(t){function e(t){var i;return Object(G["a"])(this,e),i=Object(F["a"])(this,Object(_["a"])(e).call(this,t)),i.data=t,i.oldfill=i.data.style.fill,i.anchors=[],i.nodeType="node",i.createAnchors(),i}return Object(B["a"])(e,t),Object(A["a"])(e,[{key:"createAnchors",value:function(){this.anchors=[];var t=new R.a.Group,e=t.getBoundingRect([this]),i={x:e.x+e.width/2,y:e.y,index:1,node:this,direct:"top"},o={x:e.x+e.width,y:e.y+e.height/2,index:2,node:this,direct:"right"},n={x:e.x+e.width/2,y:e.y+e.height,index:3,node:this,direct:"bottom"},s={x:e.x,y:e.y+e.height/2,index:4,node:this,direct:"left"};this.anchors.push(i,o,n,s)}}]),e}(Zt);H(q,Kt.prototype);var Vt=Kt,te=R.a.Path.extend({type:"ordinaldata",shape:{x:0,y:0,width:0,height:0},buildPath:function(t,e){var i=e.x,o=e.y,n=e.width,s=e.height,a=.5522848,r=i+n/2,h=o+s/2,c=n/2,l=s/2,d=c*a,u=l*a;t.moveTo(r-c,h),t.bezierCurveTo(r-c,h-u,r-d,h-l,r,h-l),t.bezierCurveTo(r+d,h-l,r+c,h-u,r+c,h),t.bezierCurveTo(r+c,h+u,r+d,h+l,r,h+l),t.bezierCurveTo(r-d,h+l,r-c,h+u,r-c,h),t.closePath(),t.moveTo(r,o+s),t.lineTo(i+n,o+s)}}),ee=function(t){function e(t){var i;return Object(G["a"])(this,e),i=Object(F["a"])(this,Object(_["a"])(e).call(this,t)),i.data=t,i.oldfill=i.data.style.fill,i.anchors=[],i.nodeType="node",i.createAnchors(),i}return Object(B["a"])(e,t),Object(A["a"])(e,[{key:"createAnchors",value:function(){this.anchors=[];var t=new R.a.Group,e=t.getBoundingRect([this]),i={x:e.x+e.width/2,y:e.y,index:1,node:this,direct:"top"},o={x:e.x+e.width,y:e.y+e.height/2,index:2,node:this,direct:"right"},n={x:e.x+e.width/2,y:e.y+e.height,index:3,node:this,direct:"bottom"},s={x:e.x,y:e.y+e.height/2,index:4,node:this,direct:"left"};this.anchors.push(i,o,n,s)}}]),e}(te);H(q,ee.prototype);var ie=ee,oe=R.a.Path.extend({type:"manualOperation",shape:{x:0,y:0,width:0,height:0},buildPath:function(t,e){var i=e.x,o=e.y,n=e.width,s=e.height;t.moveTo(i,o),t.lineTo(i+n,o),t.lineTo(i+n-16,o+s),t.lineTo(i+16,o+s),t.closePath()}}),ne=function(t){function e(t){var i;return Object(G["a"])(this,e),i=Object(F["a"])(this,Object(_["a"])(e).call(this,t)),i.data=t,i.oldfill=i.data.style.fill,i.anchors=[],i.nodeType="node",i.createAnchors(),i}return Object(B["a"])(e,t),Object(A["a"])(e,[{key:"createAnchors",value:function(){this.anchors=[];var t=new R.a.Group,e=t.getBoundingRect([this]),i={x:e.x+e.width/2,y:e.y,index:1,node:this,direct:"top"},o={x:e.x+e.width,y:e.y+e.height/2,index:2,node:this,direct:"right"},n={x:e.x+e.width/2,y:e.y+e.height,index:3,node:this,direct:"bottom"},s={x:e.x,y:e.y+e.height/2,index:4,node:this,direct:"left"};this.anchors.push(i,o,n,s)}}]),e}(oe);H(q,ne.prototype);var se=ne,ae=R.a.Path.extend({type:"directData",shape:{x:0,y:0,width:0,height:0},buildPath:function(t,e){var i=e.x,o=e.y,n=e.width,s=e.height,a=i+n;t.moveTo(i+5,o),t.lineTo(a-5,o),t.quadraticCurveTo(a,o+s/6,a,o+s/2),t.quadraticCurveTo(a,o+5*s/6,a-5,o+s),t.lineTo(i+5,o+s),t.quadraticCurveTo(i,o+5*s/6,i,o+s/2),t.quadraticCurveTo(i,o+s/6,i+5,o),t.closePath(),t.moveTo(a-5,o+s),t.quadraticCurveTo(i+n-10,o+5*s/6,a-10,o+s/2),t.quadraticCurveTo(i+n-10,o+s/6,a-5,o)}}),re=function(t){function e(t){var i;return Object(G["a"])(this,e),i=Object(F["a"])(this,Object(_["a"])(e).call(this,t)),i.data=t,i.oldfill=i.data.style.fill,i.anchors=[],i.nodeType="node",i.createAnchors(),i}return Object(B["a"])(e,t),Object(A["a"])(e,[{key:"createAnchors",value:function(){this.anchors=[];var t=new R.a.Group,e=t.getBoundingRect([this]),i={x:e.x+e.width/2,y:e.y,index:1,node:this,direct:"top"},o={x:e.x+e.width,y:e.y+e.height/2,index:2,node:this,direct:"right"},n={x:e.x+e.width/2,y:e.y+e.height,index:3,node:this,direct:"bottom"},s={x:e.x,y:e.y+e.height/2,index:4,node:this,direct:"left"};this.anchors.push(i,o,n,s)}}]),e}(ae);H(q,re.prototype);var he=re,ce=R.a.Path.extend({type:"storeData",shape:{x:0,y:0,width:0,height:0},buildPath:function(t,e){var i=e.x,o=e.y,n=e.width,s=e.height;t.moveTo(i+5,o),t.lineTo(i+n-5,o),t.quadraticCurveTo(i+n-10,o+s/6,i+n-10,o+s/2),t.quadraticCurveTo(i+n-10,o+5*s/6,i+n-5,o+s),t.lineTo(i+5,o+s),t.quadraticCurveTo(i,o+5*s/6,i,o+s/2),t.quadraticCurveTo(i,o+s/6,i+5,o),t.closePath()}}),le=function(t){function e(t){var i;return Object(G["a"])(this,e),i=Object(F["a"])(this,Object(_["a"])(e).call(this,t)),i.data=t,i.oldfill=i.data.style.fill,i.anchors=[],i.nodeType="node",i.createAnchors(),i}return Object(B["a"])(e,t),Object(A["a"])(e,[{key:"createAnchors",value:function(){this.anchors=[];var t=new R.a.Group,e=t.getBoundingRect([this]),i={x:e.x+e.width/2,y:e.y,index:1,node:this,direct:"top"},o={x:e.x+e.width,y:e.y+e.height/2,index:2,node:this,direct:"right"},n={x:e.x+e.width/2,y:e.y+e.height,index:3,node:this,direct:"bottom"},s={x:e.x,y:e.y+e.height/2,index:4,node:this,direct:"left"};this.anchors.push(i,o,n,s)}}]),e}(ce);H(q,le.prototype);var de=le,ue=R.a.Path.extend({type:"parallelModel",shape:{x:0,y:0,width:0,height:0},buildPath:function(t,e){var i=e.x,o=e.y,n=e.width,s=e.height;t.moveTo(i,o),t.lineTo(i+n,o),t.moveTo(i,o+s),t.lineTo(i+n,o+s)}}),fe=function(t){function e(t){var i;return Object(G["a"])(this,e),i=Object(F["a"])(this,Object(_["a"])(e).call(this,t)),i.data=t,i.oldfill=i.data.style.fill,i.anchors=[],i.nodeType="node",i.createAnchors(),i}return Object(B["a"])(e,t),Object(A["a"])(e,[{key:"createAnchors",value:function(){this.anchors=[];var t=new R.a.Group,e=t.getBoundingRect([this]),i={x:e.x+e.width/4,y:e.y,index:1,node:this,direct:"top"},o={x:e.x+e.width/2,y:e.y,index:2,node:this,direct:"top"},n={x:e.x+3*e.width/4,y:e.y,index:3,node:this,direct:"top"},s={x:e.x,y:e.y,index:4,node:this,direct:"top"},a={x:e.x+e.width,y:e.y,index:5,node:this,direct:"top"},r={x:e.x+e.width/4,y:e.y+e.height,index:6,node:this,direct:"bottom"},h={x:e.x+e.width/2,y:e.y+e.height,index:7,node:this,direct:"bottom"},c={x:e.x+3*e.width/4,y:e.y+e.height,index:8,node:this,direct:"bottom"},l={x:e.x,y:e.y+e.height,index:9,node:this,direct:"bottom"},d={x:e.x+e.width,y:e.y+e.height,index:10,node:this,direct:"bottom"};this.anchors.push(i,o,n,a,s,r,h,c,l,d)}}]),e}(ue);H(q,fe.prototype);var pe=fe,ge=R.a.Path.extend({type:"annotation",shape:{x:0,y:0,width:0,height:0},buildPath:function(t,e){var i=e.x,o=e.y,n=e.width,s=e.height;t.moveTo(i+n,o),t.lineTo(i,o),t.lineTo(i,o+s),t.lineTo(i+n,o+s)}}),ye=function(t){function e(t){var i;return Object(G["a"])(this,e),i=Object(F["a"])(this,Object(_["a"])(e).call(this,t)),i.data=t,i.oldfill=i.data.style.fill,i.anchors=[],i.nodeType="node",i.createAnchors(),i}return Object(B["a"])(e,t),Object(A["a"])(e,[{key:"createAnchors",value:function(){this.anchors=[];var t=new R.a.Group,e=t.getBoundingRect([this]),i={x:e.x+e.width/4,y:e.y,index:1,node:this,direct:"top"},o={x:e.x+e.width/2,y:e.y,index:2,node:this,direct:"top"},n={x:e.x+3*e.width/4,y:e.y,index:3,node:this,direct:"top"},s={x:e.x+e.width/4,y:e.y+e.height,index:4,node:this,direct:"bottom"},a={x:e.x+e.width/2,y:e.y+e.height,index:5,node:this,direct:"bottom"},r={x:e.x+3*e.width/4,y:e.y+e.height,index:6,node:this,direct:"bottom"},h={x:e.x,y:e.y+e.height/4,index:7,node:this,direct:"left"},c={x:e.x,y:e.y+e.height/2,index:8,node:this,direct:"left"},l={x:e.x,y:e.y+3*e.height/4,index:9,node:this,direct:"left"};this.anchors.push(i,o,n,s,a,r,h,c,l)}}]),e}(ge);H(q,ye.prototype);var xe=ye,ve=R.a.Path.extend({type:"induce",shape:{x:0,y:0,width:0,height:0,direct:"right"},buildPath:function(t,e){var i=e.x,o=e.y,n=e.width,s=e.height,a=e.direct;"right"==a?(t.moveTo(i,o+s/2),t.lineTo(i+n/2,o+s/2),t.moveTo(i+n,o),t.lineTo(i+n/2,o),t.lineTo(i+n/2,o+s),t.lineTo(i+n,o+s)):"left"==a?(t.moveTo(i,o),t.lineTo(i+n/2,o),t.lineTo(i+n/2,o+s),t.lineTo(i,o+s),t.moveTo(i+n/2,o+s/2),t.lineTo(i+n,o+s/2)):"top"==a?(t.moveTo(i,o),t.lineTo(i,o+s/2),t.lineTo(i+n,o+s/2),t.lineTo(i+n,o),t.moveTo(i+n/2,o+s/2),t.lineTo(i+n/2,o+s)):"bottom"==a&&(t.moveTo(i+n/2,o),t.lineTo(i+n/2,o+s/2),t.moveTo(i,o+s),t.lineTo(i,o+s/2),t.lineTo(i+n,o+s/2),t.lineTo(i+n,o+s))}}),me=function(t){function e(t){var i;return Object(G["a"])(this,e),i=Object(F["a"])(this,Object(_["a"])(e).call(this,t)),i.data=t,i.oldfill=i.data.style.fill,i.anchors=[],i.nodeType="node",i.createAnchors(),i}return Object(B["a"])(e,t),Object(A["a"])(e,[{key:"createAnchors",value:function(){this.anchors=[];var t=new R.a.Group,e=t.getBoundingRect([this]),i={x:e.x+e.width/4,y:e.y,index:1,node:this,direct:"top"},o={x:e.x+e.width/2,y:e.y,index:2,node:this,direct:"top"},n={x:e.x+3*e.width/4,y:e.y,index:3,node:this,direct:"top"},s={x:e.x+e.width/4,y:e.y+e.height,index:4,node:this,direct:"bottom"},a={x:e.x+e.width/2,y:e.y+e.height,index:5,node:this,direct:"bottom"},r={x:e.x+3*e.width/4,y:e.y+e.height,index:6,node:this,direct:"bottom"},h={x:e.x,y:e.y+e.height/4,index:7,node:this,direct:"left"},c={x:e.x,y:e.y+e.height/2,index:8,node:this,direct:"left"},l={x:e.x,y:e.y+3*e.height/4,index:9,node:this,direct:"left"};this.anchors.push(i,o,n,s,a,r,h,c,l)}}]),e}(ve);H(q,me.prototype);var we=me,be=R.a.Path.extend({type:"multidocument",shape:{x:0,y:0,width:0,height:0},buildPath:function(t,e){var i=e.width,o=e.height,n=e.x,s=e.y;Oe(t,n+8,s,i-8,o-22),Oe(t,n+4,s+4,i-8,o-22),ke(t,n,s+8,i-8,o-8)}});function ke(t,e,i,o,n){t.moveTo(e,i),t.lineTo(e+o,i),t.lineTo(e+o,i+n-14),t.quadraticCurveTo(e+o/4*3,parseInt(i+n-20),e+o/2,parseInt(i+n-14)),t.quadraticCurveTo(e+o/4,i+n,e,parseInt(i+n-7)),t.lineTo(e,i),t.closePath()}function Oe(t,e,i,o,n){t.moveTo(e,i),t.lineTo(e+o,i),t.lineTo(e+o,i+n),t.lineTo(e+o-4,i+n),t.lineTo(e+o-4,i+4),t.lineTo(e,i+4),t.closePath()}var Te=function(t){function e(t){var i;return Object(G["a"])(this,e),i=Object(F["a"])(this,Object(_["a"])(e).call(this,t)),i.data=t,i.oldfill=i.data.style.fill,i.anchors=[],i.nodeType="node",i.createAnchors(),i}return Object(B["a"])(e,t),Object(A["a"])(e,[{key:"createAnchors",value:function(){this.anchors=[];var t=new R.a.Group,e=t.getBoundingRect([this]),i={x:e.x+e.width/2,y:e.y,index:1,node:this,direct:"top"},o={x:e.x+e.width,y:e.y+e.height/2,index:2,node:this,direct:"right"},n={x:e.x+e.width/2,y:e.y+e.height-10,index:3,node:this,direct:"bottom"},s={x:e.x,y:e.y+e.height/2,index:4,node:this,direct:"left"};this.anchors.push(i,o,n,s)}}]),e}(be);H(q,Te.prototype);var De=Te,Pe=function(t){function e(t){var i;return Object(G["a"])(this,e),i=Object(F["a"])(this,Object(_["a"])(e).call(this,t)),i.data=t,i.oldfill=i.data.style.fill,i.anchors=[],i.nodeType="node",i.createAnchors(),i}return Object(B["a"])(e,t),Object(A["a"])(e,[{key:"createAnchors",value:function(){this.anchors=[];var t=new R.a.Group,e=t.getBoundingRect([this]),i={x:e.x+e.width/2,y:e.y,index:1,node:this,direct:"top"},o={x:e.x+e.width,y:e.y+e.height/2,index:2,node:this,direct:"right"},n={x:e.x+e.width/2,y:e.y+e.height,index:3,node:this,direct:"bottom"},s={x:e.x,y:e.y+e.height/2,index:4,node:this,direct:"left"};this.anchors.push(i,o,n,s)}}]),e}(R.a.Text);H(q,Pe.prototype);var je=Pe,Se=R.a.Path.extend({type:"processBar",shape:{x:0,y:0,width:0,height:0},buildPath:function(t,e){var i=e.x,o=e.y,n=e.height,s=e.width;t.moveTo(i,o),t.lineTo(i+s-20,o),t.lineTo(i+s,o+n/2),t.lineTo(i+s-20,o+n),t.lineTo(i,o+n),t.lineTo(i+20,o+n/2),t.closePath()}}),Ee=function(t){function e(t){var i;return Object(G["a"])(this,e),i=Object(F["a"])(this,Object(_["a"])(e).call(this,t)),i.data=t,i.oldfill=i.data.style.fill,i.anchors=[],i.nodeType="node",i.createAnchors(),i}return Object(B["a"])(e,t),Object(A["a"])(e,[{key:"createAnchors",value:function(){var t=new R.a.Group;this.anchors=[];var e=t.getBoundingRect([this]),i={x:e.x+e.width/2,y:e.y,index:1,node:this,direct:"top"},o={x:e.x+e.width,y:e.y+e.height/2,index:2,node:this,direct:"right"},n={x:e.x+e.width/2,y:e.y+e.height,index:3,node:this,direct:"bottom"},s={x:e.x,y:e.y+e.height/2,index:4,node:this,direct:"left"};this.anchors.push(i,o,n,s)}}]),e}(Se);H(q,Ee.prototype);var Ce=Ee,ze=function(t){function e(t){var i;return Object(G["a"])(this,e),i=Object(F["a"])(this,Object(_["a"])(e).call(this,t)),i.data=t,i.oldfill=i.data.style.fill,i.anchors=[],i.nodeType="node",i.createAnchors(),i}return Object(B["a"])(e,t),Object(A["a"])(e,[{key:"createAnchors",value:function(){this.anchors=[];var t=new R.a.Group,e=t.getBoundingRect([this]),i={x:e.x+e.width/2,y:e.y,index:1,node:this,direct:"top"},o={x:e.x+e.width,y:e.y+e.height/2,index:2,node:this,direct:"right"},n={x:e.x+e.width/2,y:e.y+e.height,index:3,node:this,direct:"bottom"},s={x:e.x,y:e.y+e.height/2,index:4,node:this,direct:"left"};this.anchors.push(i,o,n,s)}}]),e}(R.a.Image);H(q,ze.prototype);var Ne=ze,Ge=function(){function t(e){Object(G["a"])(this,t),this.node=e,this.bars=[],this.create()}return Object(A["a"])(t,[{key:"create",value:function(){var t=this,e=this.node.getAnchors();e.forEach((function(e){var i=new R.a.Circle({style:{fill:"#fff",stroke:"rgb(0,181,237)",lineWidth:1},shape:{cx:e.x,cy:e.y,r:3},cursor:"crosshair",z:30001});i.point=e,i.mark="anch",i.node=t.node,e.anch=i,i.on("mouseover",(function(){i.oldfill=i.style.fill,i.setStyle("fill","rgb(0,181,237)"),t.node.time&&clearTimeout(t.node.time),t.show()})),i.on("mouseout",(function(){i.setStyle("fill",i.oldfill),t.hide()})),i.on("mousedown",(function(){i.setStyle("fill","rgb(0,181,237)")})),t.bars.push(i)}))}},{key:"getBarByIndex",value:function(t){return this.bars.filter((function(e){return e.point.index==t}))[0]}},{key:"show",value:function(){this.bars.forEach((function(t){t.show()}))}},{key:"hide",value:function(){this.bars.forEach((function(t){t.hide()}))}},{key:"refresh",value:function(){var t=this;this.bars.forEach((function(e){var i=t.node.getAnchorByIndex(e.point.index);e.attr({shape:{cx:i.x,cy:i.y}}),e.point=i}))}}]),t}(),Ae=Ge;function Fe(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,o)}return i}function _e(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?Fe(Object(i),!0).forEach((function(e){Object(N["a"])(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):Fe(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}var Ie={common:{style:{fill:"#fff",stroke:"#333",lineWidth:1,text:"title",textFill:"#333",fontWeight:"normal",fontStyle:"",textPosition:"inside",fontSize:12,opacity:1},shape:{x:0,y:0,width:100,height:40,r:[3]},z:10,draggable:!0},rectangle:{style:{fill:"#fff",stroke:"#333",lineWidth:1,text:"title",textFill:"#333",fontWeight:"normal",fontStyle:"",textPosition:"inside",fontSize:12,opacity:1},shape:{x:0,y:0,width:100,height:40,r:[3]},z:200,draggable:!0},cloud:{style:{fill:"#fff",stroke:"#333",lineWidth:1,text:"title",textFill:"#333",fontWeight:"normal",fontStyle:"",textPosition:"inside",fontSize:12,textAlign:"left"},shape:{x:0,y:0,width:100,height:40},z:10,draggable:!0},diamond:{style:{fill:"#fff",stroke:"#333",lineWidth:1,text:"title",textFill:"#333",fontWeight:"normal",fontStyle:"",textPosition:"inside",fontSize:12},shape:{x:0,y:0,width:100,height:60},z:10,draggable:!0},parallelogram:{style:{fill:"#fff",stroke:"#333",lineWidth:1,text:"title",textFill:"#333",fontWeight:"normal",fontStyle:"",textPosition:"inside",fontSize:12},shape:{x:0,y:0,width:100,height:40},z:10,draggable:!0},circular:{style:{fill:"#fff",stroke:"#333",lineWidth:1,text:"title",textFill:"#333",fontWeight:"normal",fontStyle:"",textPosition:"inside",fontSize:12},shape:{cx:0,cy:0,rx:40,ry:40},z:10,draggable:!0},arrowRight:{style:{fill:"#fff",stroke:"#333",lineWidth:1,text:"title",textFill:"#333",fontWeight:"normal",fontStyle:"",textPosition:"inside",fontSize:12},shape:{x:0,y:0,width:100,height:50},z:10,draggable:!0},document:{style:{fill:"#fff",stroke:"#333",lineWidth:1,text:"title",textFill:"#333",fontWeight:"normal",fontStyle:"",textPosition:"inside",fontSize:12,textOffset:[0,-4]},shape:{x:0,y:0,width:100,height:60},z:10,draggable:!0},cylinder:{style:{fill:"#fff",stroke:"#333",lineWidth:1,text:"title",textFill:"#333",fontWeight:"normal",fontStyle:"",textPosition:"inside",fontSize:12},shape:{x:0,y:0,width:100,height:40},z:10,draggable:!0},loop:{style:{fill:"#fff",stroke:"#333",lineWidth:1,text:"title",textFill:"#333",fontWeight:"normal",fontStyle:"",textPosition:"inside",fontSize:12},shape:{x:0,y:0,width:100,height:50},z:10,draggable:!0},perhaps:{style:{fill:"#fff",stroke:"#333",lineWidth:1,text:"title",textFill:"#333",fontWeight:"normal",fontStyle:"",textPosition:"bottom",fontSize:12},shape:{x:0,y:0,width:30,height:30},z:10,draggable:!0},contrast:{style:{fill:"#fff",stroke:"#333",lineWidth:1,text:"title",textFill:"#333",fontWeight:"normal",fontStyle:"",textPosition:"bottom",fontSize:12},shape:{x:0,y:0,width:40,height:30},z:10,draggable:!0},sort:{style:{fill:"#fff",stroke:"#333",lineWidth:1,text:"title",textFill:"#333",fontWeight:"normal",fontStyle:"",textPosition:"bottom",fontSize:12},shape:{x:0,y:0,width:40,height:40},z:10,draggable:!0},ordinaldata:{style:{fill:"#fff",stroke:"#333",lineWidth:1,text:"title",textFill:"#333",fontWeight:"normal",fontStyle:"",textPosition:"inside",fontSize:12},shape:{x:0,y:0,width:60,height:60},z:10,draggable:!0},parallelModel:{style:{fill:"#fff",stroke:"#333",lineWidth:1,text:"",textFill:"#333",fontWeight:"normal",fontStyle:"",textPosition:"inside",fontSize:12},shape:{x:0,y:0,width:100,height:30},z:10,draggable:!0},annotation:{style:{fill:"#fff",stroke:"#333",lineWidth:1,text:"",textFill:"#333",fontWeight:"normal",fontStyle:"",textPosition:"inside",fontSize:12,lineDash:[6,4]},shape:{x:0,y:0,width:60,height:100},z:10,draggable:!0},induce:{style:{fill:"#fff",stroke:"#333",lineWidth:1,text:"",textFill:"#333",fontWeight:"normal",fontStyle:"",textPosition:"inside",fontSize:12},shape:{x:0,y:0,width:60,height:100,direct:"right"},z:10,draggable:!0},multidocument:{style:{fill:"#fff",stroke:"#333",lineWidth:1,text:"",textFill:"#333",fontWeight:"normal",fontStyle:"",textPosition:"inside",fontSize:12},shape:{x:0,y:0,width:100,height:80},z:10,draggable:!0},store:{style:{fill:"#fff",stroke:"#333",lineWidth:1,text:"",textFill:"#333",fontWeight:"normal",fontStyle:"",textPosition:"inside",fontSize:12},shape:{x:0,y:0,width:60,height:60},z:10,draggable:!0},image:{style:{fill:"#fff",stroke:"#333",lineWidth:1,image:"",text:"",textFill:"#333",fontWeight:"normal",fontStyle:"",textPosition:"bottom",fontSize:12,x:0,y:0,width:60,height:60},draggable:!0}},Be={rectangle:J,circular:X,diamond:K,parallelogram:et,cloud:nt,arrowRight:rt,roundRect:dt,preRect:pt,document:xt,delay:wt,card:Ot,cylinder:Pt,prepare:Et,loop:Nt,perhaps:Ft,contrast:Bt,sort:Lt,display:Ht,store:Jt,manualInput:Qt,paperBag:Vt,ordinaldata:ie,manualOperation:se,directData:he,storeData:de,parallelModel:pe,annotation:xe,induce:we,multidocument:De,text:je,processBar:Ce,image:Ne},$e={addShape:function(t,e){Be[t]=e},removeShape:function(t){delete Be[t]},getShape:function(t,e,i){var o=R.a.util.clone(Ie[t]||Ie.common);o.z=200,o.position=[e.x,e.y],o.command=t,e.image&&(o.style.image=e.image),e.style&&(o.style=_e({},o.style,{},R.a.util.clone(e.style),{},{transformText:!0})),e.shape&&(o.shape=_e({},o.shape,{},R.a.util.clone(e.shape)));var n=new Be[t](o);if(n.getData=function(){var t={type:this.type,style:R.a.util.clone(this.style),z:this.oldz,command:this.data.command,id:this.data.id||this.id,position:this.position.slice(),draggable:!0};return"image"!=this.type&&(t.shape=R.a.util.clone(this.shape)),t},n.setData=function(t){this.data=_e({},this.data,{},R.a.util.clone(t)),this.attr(this.data),this.oldz=this.data.z},n.getId=function(){return this.data.id||this.id},n.getAnchByIndex=function(t){if(this.anch)return this.anch.getBarByIndex(t)},!i){var s=new Ae(n);n.anch=s,n.refresh=function(){this.refreshEdge()},n.setShadow=function(){this.attr({style:{shadowBlur:6,shadowColor:"#ccc"}})},n.cancelShadow=function(){this.attr({style:{shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0}})},n.on("mouseover",(function(){this.dragging||this.anch.show(),this.oldz=this.z,this.attr({z:2e4})})),n.on("mouseout",(function(){this.attr({z:this.oldz})})),n.on("click",(function(){this.__zr&&this.__zr.trigger("selectNode",{node:this})})),n.on("dragstart",(function(){this.oldPos=this.position.slice()})),n.on("drag",(function(){this.refreshEdge(),this.anch.hide(),this.__zr&&this.__zr.trigger("hideFrame")})),n.on("dragend",(function(){if(this.createAnchors(),this.anch.refresh(),this.__zr&&this.__zr.trigger("refreshSelectGroup"),this.nodeGroup)if(this.groupTimeout)clearTimeout(this.groupTimeout);else if(this.leaveGroup)return this.__zr.trigger("removeNodeFromGroup",{node:this}),void(this.leaveGroup=!1);this.addToNodeGroup||this.__zr&&this.__zr.trigger("moveNode",{node:this})})),n.on("dblclick",(function(){this.__zr&&this.__zr.trigger("edit",{status:"editNode",node:this,text:this.style.text})}))}return n},hasShape:function(t){return!!Be[t]}},Re=function(){function t(e){Object(G["a"])(this,t),this.name=e}return Object(A["a"])(t,[{key:"execute",value:function(){}},{key:"undo",value:function(){}},{key:"redo",value:function(){this.execute()}}]),t}(),Le=Re;function We(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,o)}return i}function Me(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?We(Object(i),!0).forEach((function(e){Object(N["a"])(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):We(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}var He=function(t){function e(t,i){var o;return Object(G["a"])(this,e),o=Object(F["a"])(this,Object(_["a"])(e).call(this,"addShape")),o.nodes=t,o.editor=i,o}return Object(B["a"])(e,t),Object(A["a"])(e,[{key:"execute",value:function(){var t=this;this.nodes.forEach((function(e){t.editor.addNode(e)}))}},{key:"undo",value:function(){var t=this;this.nodes.forEach((function(e){t.editor.removeNode(e)}))}}]),e}(Le),qe=function(t){function e(t,i){var o;return Object(G["a"])(this,e),o=Object(F["a"])(this,Object(_["a"])(e).call(this,"RemoveShape")),o.nodes=t,o.editor=i,o.edges=o.getEdges(),o}return Object(B["a"])(e,t),Object(A["a"])(e,[{key:"getEdges",value:function(){var t=this,e=[];return this.nodes.forEach((function(i){var o=t.editor.getEdgesByNode(i);o.forEach((function(t){-1==e.indexOf(t)&&e.push(t)}))})),e}},{key:"execute",value:function(){var t=this;this.edges.forEach((function(e){t.editor.removeEdge(e)})),this.nodes.forEach((function(e){if(e.nodeGroup){var i=e.nodeGroup;e.oldRemoveGroup=i,i.removeNode(e),i.refresh()}t.editor.removeNode(e)})),this.editor.frame.hide()}},{key:"undo",value:function(){var t=this;this.edges.forEach((function(e){t.editor.addEdge(e),t.editor.add(e)})),this.nodes.forEach((function(e){t.editor.addNode(e),e.oldRemoveGroup&&(e.oldRemoveGroup.addNode(e),e.nodeGroup.refresh(),e.oldRemoveGroup=null)}))}}]),e}(Le),Ue=function(t){function e(t,i,o){var n;return Object(G["a"])(this,e),n=Object(F["a"])(this,Object(_["a"])(e).call(this,"movePos")),n.item=t,n.oldPos=i.slice(),n.newPos=o.slice(),n.isExec=!0,n}return Object(B["a"])(e,t),Object(A["a"])(e,[{key:"execute",value:function(){this.isExec||(this.item.attr({position:this.newPos.slice()}),this.isExec=!0,this.item.refreshEdge())}},{key:"undo",value:function(){this.item.attr({position:this.oldPos.slice()}),this.isExec=!1,this.item.refreshEdge()}},{key:"refreshGroup",value:function(){"group"==this.item.nodeType&&this.item.refresh(),this.item.nodeGroup&&this.item.nodeGroup.refresh()}}]),e}(Le),Je=function(t){function e(t){var i;return Object(G["a"])(this,e),i=Object(F["a"])(this,Object(_["a"])(e).call(this,"manyCmd")),i.cmds=t,i}return Object(B["a"])(e,t),Object(A["a"])(e,[{key:"execute",value:function(){this.cmds.forEach((function(t){t.execute(),"movePos"==t.name&&(t.refreshEdge&&t.refreshEdge(),t.refreshGroup())}))}},{key:"undo",value:function(){this.cmds.forEach((function(t){t.undo(),"movePos"==t.name&&(t.refreshEdge&&t.refreshEdge(),t.refreshGroup())}))}}]),e}(Le),Ye=function(t){function e(t,i){var o;return Object(G["a"])(this,e),o=Object(F["a"])(this,Object(_["a"])(e).call(this,"addedge")),o.edge=t,o.editor=i,o}return Object(B["a"])(e,t),Object(A["a"])(e,[{key:"execute",value:function(){this.editor.addEdge(this.edge)}},{key:"undo",value:function(){this.editor.removeEdge(this.edge)}}]),e}(Le),Xe=function(t){function e(t,i){var o;return Object(G["a"])(this,e),o=Object(F["a"])(this,Object(_["a"])(e).call(this,"removeEdge")),o.edge=t,o.editor=i,o}return Object(B["a"])(e,t),Object(A["a"])(e,[{key:"execute",value:function(){this.editor.removeEdge(this.edge)}},{key:"undo",value:function(){this.editor.addEdge(this.edge)}}]),e}(Le),Qe=function(t){function e(t,i,o){var n;return Object(G["a"])(this,e),n=Object(F["a"])(this,Object(_["a"])(e).call(this,"createGroup")),n.group=t,n.topGroup=i,n.editor=o,n}return Object(B["a"])(e,t),Object(A["a"])(e,[{key:"execute",value:function(){var t=this;this.topGroup&&(this.topGroup.redoGroup(),this.editor.addGroup(this.topGroup),this.topGroup.addNode(this.group),this.group.nodes.forEach((function(e){var i=t.topGroup.nodes,o=i.indexOf(e);i.splice(o,1)}))),this.editor.addGroup(this.group),this.group.redoGroup()}},{key:"undo",value:function(){this.topGroup&&(this.topGroup.cancelGroup(),this.editor.removeGroup(this.topGroup)),this.group.cancelGroup(),this.editor.removeGroup(this.group)}}]),e}(Le),Ze=function(t){function e(t,i){var o;return Object(G["a"])(this,e),o=Object(F["a"])(this,Object(_["a"])(e).call(this,"cancelGroup")),o.group=t,o.editor=i,o.topGroup=t.topGroup,o.edges=i.getEdgesByGroup(t),o}return Object(B["a"])(e,t),Object(A["a"])(e,[{key:"execute",value:function(){var t=this;this.editor.removeGroup(this.group),this.topGroup&&this.topGroup.removeNode(this.group),this.group.nodes.forEach((function(e){t.topGroup?("group"==e.nodeType?e.topGroup=t.topGroup:e.nodeGroup=t.topGroup,t.topGroup.addNode(e)):"group"==e.nodeType?e.topGroup=null:e.nodeGroup=null})),this.edges.forEach((function(e){t.editor.removeEdge(e)}))}},{key:"undo",value:function(){var t=this;this.editor.addGroup(this.group),this.group.topGroup=this.topGroup,this.group.nodes.forEach((function(e){t.topGroup&&t.topGroup.removeNode(e),"group"==e.nodeType?e.topGroup=t.group:e.nodeGroup=t.group})),this.topGroup&&this.topGroup.addNode(this.group),this.edges.forEach((function(e){t.editor.addEdge(e)}))}}]),e}(Le),Ke=function(t){function e(t){var i;return Object(G["a"])(this,e),i=Object(F["a"])(this,Object(_["a"])(e).call(this,"removeNodeFromGroup")),i.node=t,i.group=i.node.nodeGroup,i.oldPos=i.node.oldPos.slice(),i.newPos=i.node.position.slice(),i}return Object(B["a"])(e,t),Object(A["a"])(e,[{key:"execute",value:function(){this.node.attr({position:[this.newPos[0],this.newPos[1]]}),this.group.removeNode(this.node),this.node.refreshEdge()}},{key:"undo",value:function(){this.node.attr({position:[this.oldPos[0],this.oldPos[1]]}),this.group.addNode(this.node),this.node.refreshEdge()}}]),e}(Le),Ve=function(t){function e(t,i){var o;return Object(G["a"])(this,e),o=Object(F["a"])(this,Object(_["a"])(e).call(this,"addNodeToGroup")),o.node=t,o.oldGroup=t.nodeGroup,o.newGroup=i,o.oldPos=t.oldPos.slice(),o.newPos=t.position.slice(),o}return Object(B["a"])(e,t),Object(A["a"])(e,[{key:"execute",value:function(){this.oldGroup&&(this.oldGroup.removeNode(this.node),this.node.groupTimeout&&(clearTimeout(this.node.groupTimeout),this.node.groupTimeout=null)),this.node.attr({position:this.newPos.slice()}),this.newGroup.addNode(this.node),this.node.refreshEdge()}},{key:"undo",value:function(){this.newGroup.removeNode(this.node),this.oldGroup&&(this.node.attr({position:this.oldPos.slice()}),this.oldGroup.addNode(this.node)),this.node.attr({position:this.oldPos.slice()}),this.node.refreshEdge()}}]),e}(Le),ti=function(t){function e(t,i,o){var n;return Object(G["a"])(this,e),n=Object(F["a"])(this,Object(_["a"])(e).call(this,"changeNode")),n.node=t,n.oldData=i,n.newData=o,n}return Object(B["a"])(e,t),Object(A["a"])(e,[{key:"execute",value:function(){this.node.setData(this.newData),this.node.refresh()}},{key:"undo",value:function(){this.node.setData(this.oldData),this.node.refresh()}}]),e}(Le),ei=function(t){function e(t,i,o,n){var s;return Object(G["a"])(this,e),s=Object(F["a"])(this,Object(_["a"])(e).call(this,"changeGroup")),s.group=t,s.oldData=i,s.newData=o,s.mark=n,s}return Object(B["a"])(e,t),Object(A["a"])(e,[{key:"execute",value:function(){"head"==this.mark?this.group.setHeadStyle(this.newData):this.group.setGroupStyle(this.newData)}},{key:"undo",value:function(){"head"==this.mark?this.group.setHeadStyle(this.oldData):this.group.setGroupStyle(this.oldData)}}]),e}(Le),ii=function(t){function e(t){var i;return Object(G["a"])(this,e),i=Object(F["a"])(this,Object(_["a"])(e).call(this,"removeGroup")),i.group=t,i.topGroup=i.group.topGroup,i.allItems=i.group.getAllItems(),i.editor=i.group.editor,i.edges=i.getAllEdges(),i}return Object(B["a"])(e,t),Object(A["a"])(e,[{key:"getAllEdges",value:function(){var t=this,e=this.editor.getAllEdgesByGroup(this.group);return this.allItems.forEach((function(i){if("node"==i.nodeType){var o=t.editor.getEdgesByNode(i);o.forEach((function(t){-1==e.indexOf(t)&&e.push(t)}))}})),e}},{key:"execute",value:function(){var t=this;this.group.editor.removeGroup(this.group),this.allItems.forEach((function(e){"node"==e.nodeType?t.editor.removeNode(e):"group"==e.nodeType&&t.editor.removeGroup(e)})),this.edges.forEach((function(e){t.editor.removeEdge(e)})),this.topGroup&&this.topGroup.removeNode(this.group)}},{key:"undo",value:function(){var t=this;this.editor.addGroup(this.group),this.allItems.forEach((function(e){"node"==e.nodeType?t.editor.addNode(e):"group"==e.nodeType&&t.editor.addGroup(e)})),this.edges.forEach((function(e){t.editor.addEdge(e),t.editor.add(e)})),this.group.refresh(),this.topGroup&&(this.topGroup.addNode(this.group),this.group.topGroup=this.topGroup)}}]),e}(Le),oi=function(t){function e(t,i){var o;return Object(G["a"])(this,e),o=Object(F["a"])(this,Object(_["a"])(e).call(this,"changeGroupHead")),o.group=t,o.showHead=i,o}return Object(B["a"])(e,t),Object(A["a"])(e,[{key:"execute",value:function(){this.group.changeHead(this.showHead)}},{key:"undo",value:function(){this.group.changeHead(!this.showHead)}}]),e}(Le),ni=function(t){function e(t,i,o){var n;return Object(G["a"])(this,e),n=Object(F["a"])(this,Object(_["a"])(e).call(this,"changeEdge")),n.edge=t,n.oldData=i,n.newData=o,n.edge.unactive(),n}return Object(B["a"])(e,t),Object(A["a"])(e,[{key:"execute",value:function(){this.edge.setData(this.newData)}},{key:"undo",value:function(){this.edge.setData(this.oldData)}}]),e}(Le),si=function(t){function e(t,i,o){var n;return Object(G["a"])(this,e),n=Object(F["a"])(this,Object(_["a"])(e).call(this,"changeEdgeText")),n.edge=t,n.oldText=i,n.newText=o,n}return Object(B["a"])(e,t),Object(A["a"])(e,[{key:"execute",value:function(){this.edge.setText(this.newText)}},{key:"undo",value:function(){this.edge.setText(this.oldText)}}]),e}(Le),ai=function(t){function e(t,i){var o;return Object(G["a"])(this,e),o=Object(F["a"])(this,Object(_["a"])(e).call(this,"changeEdge")),o.edge=t,o.data=i,o.edge.unactive(),o}return Object(B["a"])(e,t),Object(A["a"])(e,[{key:"execute",value:function(){"anch"==this.data.mark?"from"==this.data.position?(this.data.newCenter&&this.edge.setFromPoint(Me({},this.data.newCenter),!0),this.data.newNode&&(this.edge.setFromNode(this.data.newNode),this.edge.setFromAnch(this.data.newAnch))):(this.data.newCenter&&this.edge.setToPoint(Me({},this.data.newCenter),!0),this.data.newNode&&(this.edge.setToNode(this.data.newNode),this.edge.setToAnch(this.data.newAnch))):"point"==this.data.mark&&("from"==this.data.position?(this.edge.setFromPoint({x:this.data.newCenter.x,y:this.data.newCenter.y},!0),this.data.newNode&&(this.edge.setFromNode(this.data.newNode),this.edge.setFromAnch(this.data.newAnch))):(this.edge.setToPoint({x:this.data.newCenter.x,y:this.data.newCenter.y}),this.data.newNode&&(this.edge.setToNode(this.data.newNode),this.edge.setToAnch(this.data.newAnch))))}},{key:"undo",value:function(){"anch"==this.data.mark?"from"==this.data.position?(this.data.oldCenter&&this.edge.setFromPoint(Me({},this.data.oldCenter),!0),this.data.oldNode&&(this.edge.setFromNode(this.data.oldNode),this.edge.setFromAnch(this.data.oldAnch))):(this.data.oldCenter&&this.edge.setToPoint(Me({},this.data.oldCenter),!0),this.data.oldNode&&(this.edge.setToNode(this.data.oldNode),this.edge.setToAnch(this.data.oldAnch))):"point"==this.data.mark&&("from"==this.data.position?(this.edge.setFromPoint({x:this.data.oldCenter.x,y:this.data.oldCenter.y},!0),this.data.newNode&&this.edge.removeFromNode()):(this.edge.setToPoint({x:this.data.oldCenter.x,y:this.data.oldCenter.y}),this.data.newNode&&this.edge.removeToNode()))}}]),e}(Le),ri=function(){function t(e){Object(G["a"])(this,t),this.editor=e,this.w=6,this.isShow=!0,this.createBar(),this.initEvent(),this.hide()}return Object(A["a"])(t,[{key:"addTo",value:function(t){this.zr=t,t.add(this.lefttopbar),t.add(this.leftbottombar),t.add(this.righttopbar),t.add(this.rightbottombar),t.add(this.frame)}},{key:"createBar",value:function(){var t=this.w;this.frame=new R.a.Rect({style:{fill:"transparent"}}),this.lefttopbar=new R.a.Rect({style:{fill:"#fff",stroke:"red",lineWidth:1},shape:{width:t,height:t},draggable:!0,cursor:"nw-resize",z:30001}),this.righttopbar=new R.a.Rect({style:{fill:"#fff",stroke:"red",lineWidth:1},shape:{width:t,height:t},draggable:!0,cursor:"ne-resize",z:30001}),this.leftbottombar=new R.a.Rect({style:{fill:"#fff",stroke:"red",lineWidth:1},shape:{width:t,height:t},draggable:!0,cursor:"sw-resize",z:30001}),this.rightbottombar=new R.a.Rect({style:{fill:"#fff",stroke:"red",lineWidth:1},shape:{width:t,height:t},draggable:!0,cursor:"se-resize",z:30001}),this.hide()}},{key:"hide",value:function(){this.isShow&&(this.lefttopbar.hide(),this.leftbottombar.hide(),this.righttopbar.hide(),this.rightbottombar.hide(),this.frame.hide(),this.isShow=!1)}},{key:"show",value:function(){this.isShow||(this.lefttopbar.show(),this.leftbottombar.show(),this.righttopbar.show(),this.rightbottombar.show(),this.frame.show(),this.isShow=!0)}},{key:"boxSelect",value:function(t,e){this.boxItem=e,t.x=parseInt(t.x)+.5,t.y=parseInt(t.y)+.5,t.width=t.width-1,t.height=t.height-1,this.box=t,this.frame.attr({position:[t.x,t.y],style:{stroke:"red",lineWidth:1},shape:{x:0,y:0,width:t.width,height:t.height}}),this.show()}},{key:"refreshBar",value:function(){var t=this.w;this.lefttopbar.attr({position:[this.box.x,this.box.y],shape:{x:-t/2,y:-t/2}}),this.righttopbar.attr({position:[this.box.x+this.box.width,this.box.y],shape:{x:-t/2,y:-t/2}}),this.leftbottombar.attr({position:[this.box.x,this.box.y+this.box.height],shape:{x:-t/2,y:-t/2}}),this.rightbottombar.attr({position:[this.box.x+this.box.width,this.box.y+this.box.height],shape:{x:-t/2,y:-t/2}})}},{key:"refreshGroup",value:function(){var t=this.box,e=this.boxItem.position.slice();if("ellipse"==this.boxItem.type){var i=t.width/2,o=t.height/2,n=t.x+i,s=t.y+o;this.boxItem.attr({shape:{cx:n-e[0],cy:s-e[1],rx:i,ry:o}})}else"image"==this.boxItem.type?this.boxItem.attr({position:[t.x,t.y],style:{width:t.width,height:t.height}}):this.boxItem.attr({position:[t.x,t.y],shape:{x:0,y:0,width:t.width,height:t.height}})}},{key:"initEvent",value:function(){var t,e,i,o,n,s,a,r=this,h=this,c=!1,l=[this.lefttopbar,this.leftbottombar,this.righttopbar,this.rightbottombar];l.forEach((function(r,l){r.on("dragstart",(function(r){o=h.box.x,n=h.box.y,s=h.box.width,a=h.box.height,c=!0,t=r.offsetX,e=r.offsetY,i=h.boxItem.getData(),h.editor.status="resizeNode"})),r.on("drag",(function(i){if(c){var r=i.offsetX-t,d=i.offsetY-e;0==l?(h.box.x=o+r,h.box.y=n+d,h.box.width=s-r,h.box.height=a-d):1==l?(h.box.x=o+r,h.box.y=n,h.box.width=s-r,h.box.height=a+d):2==l?(h.box.x=o,h.box.y=n+d,h.box.width=s+r,h.box.height=a-d):(h.box.x=o,h.box.y=n,h.box.width=s+r,h.box.height=a+d),h.refreshGroup(),h.boxSelect(h.box,h.boxItem),h.refreshBar(),h.boxItem.refreshEdge(),h.boxItem.nodeGroup&&h.boxItem.nodeGroup.refresh()}})),r.on("dragend",(function(){this.__zr&&this.__zr.trigger("resizeNode",{oldData:i}),c=!1,h.editor.status=""}))})),document.addEventListener("mouseup",(function(){c&&(c=!1,r.editor.status="")}))}}]),t}(),hi=ri,ci=i("3835"),li=(i("7db0"),function(t,e){return[t[0]+e[0],t[1]+e[1]]}),di=function(t,e){return[t[0]*e,t[1]*e]},ui=function(t,e){return[e[0]-t[0],e[1]-t[1]]},fi=function(t,e){return t[0]*e[1]-t[1]*e[0]===0},pi=function(t,e){return t[0]*e[0]+t[1]*e[1]},gi=function(t){var e=Math.sqrt(t[0]*t[0]+t[1]*t[1]);return[t[0]/e,t[1]/e]};function yi(t){var e=t.entryPoint,i=void 0===e?[0,0]:e,o=t.entryDirection,n=void 0===o?[0,1]:o,s=t.entryExt,a=void 0===s?10:s,r=t.exitPoint,h=void 0===r?[10,10]:r,c=t.exitDirection,l=void 0===c?[1,0]:c,d=t.exitExt,u=void 0===d?10:d,f=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5;if(null===l||"0,0"==l.join()){var p=ui(h,i);l=Math.abs(p[0])>Math.abs(p[1])?[p[0]/Math.abs(p[0]),0]:[0,p[1]/Math.abs(p[1])]}var g=li(i,di(n,a)),y=li(h,di(l,u));l=di(l,-1);var x,v,m=[y[0]-g[0],0],w=[0,y[1]-g[1]],b=[m,w],k=b.find((function(t){return fi(t,n)}));x=pi(k,n)>0?k:xi(b,k);var O=b.find((function(t){return fi(t,l)}));v=pi(O,l)>0?O:xi(b,O);var T=pi(x,v)>0?2:1,D=xi(b,v),P=[];if(P.push({position:i,direction:null},{position:g,direction:n}),1==T){var j=li(g,x),S=vi(x),E=li(j,v),C=vi(v);P.push({position:j,direction:S},{position:E,direction:C})}else{var z=li(g,di(x,f)),N=vi(x),G=li(z,D),A=vi(D),F=li(G,di(v,1-f)),_=vi(v);P.push({position:z,direction:N},{position:G,direction:A,type:"pathMiddleP"},{position:F,direction:_})}return P.push({position:h,direction:l}),P.filter((function(t){return!1!==t.direction}))}function xi(t,e){return t.find((function(t){return t!=e}))}function vi(t){return(0!=t[0]||0!=t[1])&&(0==t[0]?[0,t[1]/Math.abs(t[1])]:0==t[1]?[t[0]/Math.abs(t[0]),0]:gi(t))}var mi=yi;function wi(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,o)}return i}function bi(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?wi(Object(i),!0).forEach((function(e){Object(N["a"])(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):wi(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}var ki=function(t){function e(){var t,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"#666",a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"#666",r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"#fff",h=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"polyline",c=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"solid";return Object(G["a"])(this,e),t=Object(F["a"])(this,Object(_["a"])(e).call(this)),t.fromNode=i,t.toNode=o,t.direct="",t.stroke=s,t.textFill=a||"#fff",t.lineDashType=c,t.textBackgroundColor=r,t.fontStyle="normal",t.fontWeight="normal",t.lineCenter=[],t.isCpxDrag=!1,t.status="create",t.cpx={cpx1:0,cpy1:0,cpx2:0,cpy2:0,fromcx:0,fromcy:0,tocx:0,tocy:0},t.entryDirection=[1,0],t.exitDirection=[-1,0],t.entryExt=20,t.exitExt=20,t.text=n,t.lineWidth=1,t.type=h,t.temx=0,t.temy=0,t.nodeType="edge",t.create(),t.initEvent(),t.relateText.hide(),t}return Object(B["a"])(e,t),Object(A["a"])(e,[{key:"setLineDashType",value:function(){"solid"==this.lineDashType?this.lineDash=[0]:"dott"==this.lineDashType?this.lineDash=[2,2]:"dash"==this.lineDashType?this.lineDash=[6,3]:"dashed"==this.lineDashType&&(this.lineDash=[10,4,4,4])}},{key:"create",value:function(){var t=this;this.setLineDashType(),"bs"==this.type?(this.bs=new R.a.BezierCurve({style:{stroke:this.stroke,lineWidth:this.lineWidth,lineDash:this.lineDash},z:16}),this.entryExt=70,this.exitExt=70):"polyline"==this.type?(this.bs=new R.a.Polyline({style:{stroke:this.stroke,lineWidth:this.lineWidth,lineDash:this.lineDash},z:16}),this.entryExt=20,this.exitExt=20):this.bs=new R.a.Line({style:{stroke:this.stroke,lineWidth:this.lineWidth,lineDash:this.lineDash},z:16}),this.cpx1=new R.a.Circle({style:{stroke:"#666",fill:"#fff"},shape:{r:4},draggable:!0,z:2e4}),this.cpx2=new R.a.Circle({style:{stroke:"#666",fill:"#fff"},shape:{r:4},draggable:!0,z:2e4}),this.fromPointCircle=new R.a.Circle({style:{fill:"#fff",stroke:"red",shadowColor:"yellow",shadowBlur:3},shape:{r:4},z:1e4}),this.toPointCircle=new R.a.Circle({style:{fill:"#fff",stroke:"red",shadowColor:"yellow",shadowBlur:3},shape:{r:4},z:1e4}),this.fromPointCircle.edge=this,this.fromPointCircle.edgeType="from",this.toPointCircle.edge=this,this.toPointCircle.edgeType="to",this.line1=new R.a.Line({style:{stroke:"#ccc"},z:1e4}),this.line2=new R.a.Line({style:{stroke:"#ccc"},z:1e4}),this.pl=new R.a.Polygon({style:{stroke:this.stroke,fill:this.stroke},z:17}),this.relateText=new R.a.Text({style:{text:this.text,textFill:this.textFill,fontSize:12,fontStyle:this.fontSize,fontWeight:this.fontWeight,textBackgroundColor:this.textBackgroundColor,textPadding:[2,2],textBorderRadius:2},z:17}).on("dblclick",(function(e){e.relate=t,t.__zr.trigger("editRelate",e)})),this.add(this.bs),this.add(this.line1),this.add(this.line2),this.add(this.cpx1),this.add(this.cpx2),this.add(this.fromPointCircle),this.add(this.toPointCircle),this.add(this.pl),this.add(this.relateText),this.cpx1.relate=this,this.cpx1.mark="from",this.cpx2.relate=this,this.cpx2.mark="to",this.cpx1.hide(),this.cpx2.hide(),this.line1.hide(),this.line2.hide(),this.fromPointCircle.hide(),this.toPointCircle.hide(),this.pl.hide()}},{key:"setFromNode",value:function(t){this.fromNode=t}},{key:"setFromAnch",value:function(t){this.fromAnch=t,t&&(this.setFromPoint(this.fromNode.getAnchorByIndex(t.point.index)),this._refresh())}},{key:"removeFromNode",value:function(){this.fromNode=null,this.fromAnch=null}},{key:"setFromPoint",value:function(t,e){this.fromPoint=bi({},this.fromPoint,{},t),this.cpx.x1=t.x,this.cpx.y1=t.y,this.calcDirection(),e&&(this._refresh(),this.renderText())}},{key:"calc",value:function(t,e){var i,o=this.fromPoint;t&&e?(this.toPoint={x:t,y:e},i=this.toPoint):i=this.toPoint;var n=o.x+(i.x-o.x)/4,s=o.y+(i.y-o.y)/4,a=o.x+(i.x-o.x)/4*3,r=o.y+(i.y-o.y)/4*3;return{x1:o.x,y1:o.y,x2:i.x,y2:i.y,cpx1:n,cpx2:a,cpy1:s,cpy2:r}}},{key:"judgeDirect",value:function(t,e){var i="";return i=t.x>=e.x?"left":"right",t.y>=e.y?i+="top":i+="bottom",i}},{key:"calcDirection",value:function(){this.fromPoint&&this.fromPoint.direct&&("top"==this.fromPoint.direct?this.entryDirection=[0,-1]:"right"==this.fromPoint.direct?this.entryDirection=[1,0]:"bottom"==this.fromPoint.direct?this.entryDirection=[0,1]:this.entryDirection=[-1,0]),this.toPoint&&this.toPoint.direct&&("top"==this.toPoint.direct?this.exitDirection=[0,-1]:"right"==this.toPoint.direct?this.exitDirection=[1,0]:"bottom"==this.toPoint.direct?this.exitDirection=[0,1]:this.exitDirection=[-1,0])}},{key:"polylineConnection",value:function(t,e){t&&e&&(this.toPoint={x:t,y:e}),this.calcDirection();var i={entryPoint:[this.fromPoint.x,this.fromPoint.y],exitPoint:[this.toPoint.x,this.toPoint.y],entryDirection:this.entryDirection,exitDirection:this.exitDirection,entryExt:this.entryExt,exitExt:this.exitExt};if("number"==typeof i.entryPoint[0]&&"number"==typeof i.entryPoint[0]&&"number"==typeof i.exitPoint[0]&&"number"==typeof i.exitPoint[0]){var o=mi(i),n=[];o.forEach((function(t){n.push(t.position)})),this.cpx.cpx1=n[1][0],this.cpx.cpy1=n[1][1],this.cpx.cpx2=n[n.length-2][0],this.cpx.cpy2=n[n.length-2][1];var s=o.length,a=parseInt(s/2)-1;this.lineCenter=[(n[a][0]+n[a+1][0])/2,(n[a][1]+n[a+1][1])/2],this.lineWidth%2==1?n.forEach((function(t){t[0]=parseInt(t[0])+.5,t[1]=parseInt(t[1])+.5})):n.forEach((function(t){t[0]=parseInt(t[0]),t[1]=parseInt(t[1])})),this.cpx.points=R.a.util.clone(n),this.cpx.lineCenter=this.lineCenter.slice(),this.bs.attr({shape:{points:n}}),this.renderText()}}},{key:"bsConnection",value:function(t,e){t&&e&&(this.toPoint={x:t,y:e}),this.calcDirection();var i={entryPoint:[this.fromPoint.x,this.fromPoint.y],exitPoint:[this.toPoint.x,this.toPoint.y],entryDirection:this.entryDirection,exitDirection:this.exitDirection,entryExt:this.entryExt,exitExt:this.exitExt};if("number"==typeof i.entryPoint[0]&&"number"==typeof i.entryPoint[0]&&"number"==typeof i.exitPoint[0]&&"number"==typeof i.exitPoint[0]){var o=mi(i),n=[];o.forEach((function(t){n.push(t.position)})),this.cpx.cpx1=n[1][0],this.cpx.cpy1=n[1][1],this.cpx.cpx2=n[n.length-2][0],this.cpx.cpy2=n[n.length-2][1];var s=o.length,a=parseInt(s/2)-1;this.lineCenter=[(n[a][0]+n[a+1][0])/2,(n[a][1]+n[a+1][1])/2],this.lineWidth%2==1?n.forEach((function(t){t[0]=parseInt(t[0])+.5,t[1]=parseInt(t[1])+.5})):n.forEach((function(t){t[0]=parseInt(t[0]),t[1]=parseInt(t[1])})),this.cpx.points=R.a.util.clone(n),this.cpx.lineCenter=this.lineCenter.slice(),this.renderText()}}},{key:"move",value:function(t,e){if("left"==this.fromPoint.direct||"right"==this.fromPoint.direct?t>this.fromPoint.x||t>this.temx?this.exitDirection=[-1,0]:(t<this.fromPoint.x||t<this.temx)&&(this.exitDirection=[1,0]):e>this.fromPoint.y||e>this.temy?this.exitDirection=[0,-1]:(e<this.fromPoint.y||t<this.temy)&&(this.exitDirection=[0,1]),this.temx=t,this.temy=e,"polyline"==this.type)this.polylineConnection(t,e);else{this.bsConnection(t,e);var i=this.calc(t,e);this.bs.attr({shape:i}),this._refresh()}}},{key:"calcPoints",value:function(t){if(t){var e;e="line"==this.type?Math.atan((t.x1-t.x2)/(t.y1-t.y2)):Math.atan((t.cpx2-t.x2)/(t.cpy2-t.y2));var i=8,o=3,n=[],s=[],a=[];"line"==this.type?t.y1>=t.y2?(s[0]=i*Math.sin(e)- -o*Math.cos(e)+t.x2,s[1]=i*Math.cos(e)+-o*Math.sin(e)+t.y2,a[0]=i*Math.sin(e)-o*Math.cos(e)+t.x2,a[1]=i*Math.cos(e)+o*Math.sin(e)+t.y2):(s[0]=-i*Math.sin(e)- -o*Math.cos(e)+t.x2,s[1]=-i*Math.cos(e)+-o*Math.sin(e)+t.y2,a[0]=-i*Math.sin(e)-o*Math.cos(e)+t.x2,a[1]=-i*Math.cos(e)+o*Math.sin(e)+t.y2):t.cpy2>=t.y2?(s[0]=i*Math.sin(e)- -o*Math.cos(e)+t.x2,s[1]=i*Math.cos(e)+-o*Math.sin(e)+t.y2,a[0]=i*Math.sin(e)-o*Math.cos(e)+t.x2,a[1]=i*Math.cos(e)+o*Math.sin(e)+t.y2):(s[0]=-i*Math.sin(e)- -o*Math.cos(e)+t.x2,s[1]=-i*Math.cos(e)+-o*Math.sin(e)+t.y2,a[0]=-i*Math.sin(e)-o*Math.cos(e)+t.x2,a[1]=-i*Math.cos(e)+o*Math.sin(e)+t.y2);var r=[t.x2,t.y2];return n.push(s,a,r),n}}},{key:"setToNode",value:function(t){this.toNode=t}},{key:"setToAnch",value:function(t){this.toAnch=t,t&&(this.setToPoint(this.toNode.getAnchorByIndex(t.point.index)),this._refresh())}},{key:"removeToNode",value:function(){this.toNode=null,this.toAnch=null}},{key:"setToPoint",value:function(t){this.toPoint=bi({},this.toPoint,{},t),this.cpx.x2=t.x,this.cpx.y2=t.y,this.calcDirection(),this._refresh(),this.renderText()}},{key:"active",value:function(){if(this.status="active",this.bs.setStyle("stroke","orange"),this.fromPointCircle.attr({shape:{cx:this.cpx.x1,cy:this.cpx.y1}}),this.toPointCircle.attr({shape:{cx:this.cpx.x2,cy:this.cpx.y2}}),this.fromPointCircle.show(),this.toPointCircle.show(),"bs"==this.type){var t=this.cpx;this.cpx1.attr({position:[t.cpx1,t.cpy1]}),this.cpx2.attr({position:[t.cpx2,t.cpy2]}),this.cpx1.show(),this.cpx2.show(),this.line1.show(),this.line2.show()}}},{key:"unactive",value:function(){this.status="over",this.bs.setStyle("stroke",this.stroke),this.cpx1.hide(),this.cpx2.hide(),this.line1.hide(),this.line2.hide(),this.fromPointCircle.hide(),this.toPointCircle.hide()}},{key:"isactive",value:function(){return"active"==this.status}},{key:"setTextBackground",value:function(t){this.textBackgroundColor=t,this.relateText.attr({style:{textBackgroundColor:t}})}},{key:"flush",value:function(){this._refresh()}},{key:"refresh",value:function(){this._refresh()}},{key:"doRefresh",value:function(){this._refresh()}},{key:"showCircle",value:function(){this.fromPointCircle.show(),this.toPointCircle.show()}},{key:"initEvent",value:function(){var t=this;this.bs.on("click",(function(){t.active(),t.__zr&&t.__zr.trigger("clearSelectNode"),t.__zr&&t.__zr.trigger("selectEdge",{edge:t})})),this.bs.on("dblclick",(function(e){e.edge=t,e.status="editEdge",e.text=t.relateText.style.text,t.__zr&&t.__zr.trigger("edit",e)})),this.bs.on("contextmenu",(function(e){t.active(),t.__zr&&t.__zr.trigger("showRelateLinkMenu",e)})),this.fromPointCircle.on("mousedown",(function(){t.fromPointCircle.oldCenter={x:t.fromPointCircle.shape.cx,y:t.fromPointCircle.shape.cy}})),this.toPointCircle.on("mousedown",(function(){t.toPointCircle.oldCenter={x:t.toPointCircle.shape.cx,y:t.toPointCircle.shape.cy}})),this.cpx1.on("drag",(function(){var e=t.cpx1.position.slice();t.cpx.cpx1=e[0],t.cpx.cpy1=e[1],t.isCpxDrag=!0,t._refresh()})),this.cpx2.on("drag",(function(){var e=t.cpx2.position.slice();t.cpx.cpx2=e[0],t.cpx.cpy2=e[1],t.isCpxDrag=!0,t._refresh()}))}},{key:"setCpx1",value:function(t,e,i,o){this.cpx.cpx1=t,this.cpx.cpy1=e,this.setx1(t,e,i,o),this._refresh()}},{key:"setCpx2",value:function(t,e,i,o){this.cpx.cpx2=t,this.cpx.cpy2=e,this.setx2(t,e,i,o),this._refresh()}},{key:"_refresh",value:function(){var t;this.setLineDashType();var e=this.cpx;"bs"==this.type||"line"==this.type?(this.fromPoint=bi({},this.fromPoint,{},{x:this.cpx.x1,y:this.cpx.y1}),this.toPoint=bi({},this.toPoint,{},{x:this.cpx.x2,y:this.cpx.y2}),this.isCpxDrag?this.isCpxDrag=!1:this.bsConnection(),this.bs.attr({shape:e})):(this.fromPoint=bi({},this.fromPoint,{},{x:this.cpx.x1,y:this.cpx.y1}),this.toPoint=bi({},this.toPoint,{},{x:this.cpx.x2,y:this.cpx.y2}),this.polylineConnection()),this.line1.attr({shape:{x1:e.x1,y1:e.y1,x2:e.cpx1,y2:e.cpy1}}),this.line2.attr({shape:{x1:e.x2,y1:e.y2,x2:e.cpx2,y2:e.cpy2}}),t=this.calcPoints(e),this.pl.attr({shape:{points:t}}),this.pl.show(),this.renderText()}},{key:"setx1",value:function(t,e){var i=this.fromNode.getPosition(),o=this.fromNode.getBoundingRect();t>=i.x-2&&t<=i.x+o.width+2?(this.cpx.x1=t,this.cpx.fromcx=t-i.x):(t<i.x-2||t>i.x+o.width+2)&&e>i.y-2&&e<i.y+o.height+2&&(this.cpx.y1=e,this.cpx.fromcy=e-i.y)}},{key:"setx2",value:function(t,e){var i=this.toNode.getPosition(),o=this.toNode.getBoundingRect();t>i.x-2&&t<i.x+o.width+2?(this.cpx.x2=t,this.cpx.tocx=t-i.x):(t<i.x-2||t>i.x+o.width+2)&&e>i.y-2&&e<i.y+o.height+2&&(this.cpx.y2=e,this.cpx.tocy=e-i.y)}},{key:"getCpx",value:function(){return{cpx1:this.cpx.cpx1,cpx2:this.cpx.cpx2,cpy1:this.cpx.cpy1,cpy2:this.cpx.cpy2,x1:this.cpx.x1,y1:this.cpx.y1,x2:this.cpx.x2,y2:this.cpx.y2,points:R.a.util.clone(this.cpx.points),lineCenter:this.lineCenter.slice(),type:this.type}}},{key:"setCpx",value:function(t){if(this.cpx=R.a.util.clone(t),"polyline"==t.type){this.cpx=t,this.lineCenter=this.cpx.lineCenter.slice(),this.bs.attr({shape:{points:t.points}});var e=this.calcPoints(t);this.pl.attr({shape:{points:e}}),this.renderText()}else this._refresh()}},{key:"setPosition",value:function(t,e){this.attr({position:[t,e]})}},{key:"renderText",value:function(){var t,e=this.cpx,i=[e.x1,e.y1],o=[e.cpx1,e.cpy1],n=[e.cpx2,e.cpy2],s=[e.x2,e.y2];t="bs"==this.type?this.threeBezier(.5,i,o,n,s):"polyline"==this.type?this.lineCenter:[(i[0]+s[0])/2,(i[1]+s[1])/2];var a=this.relateText.getBoundingRect(),r=t[0]-a.width/2,h=t[1]-a.height/2;this.relateText.attr({style:{textBackgroundColor:this.textBackgroundColor},position:[r,h]}),this.text?this.relateText.show():this.relateText.hide()}},{key:"setText",value:function(t){this.text=t,this.relateText.setStyle("text",this.text),this.renderText()}},{key:"getText",value:function(){return this.text||this.relateText.style.text}},{key:"setColor",value:function(t){this.stroke=t,this.bs.attr({style:{stroke:t}}),this.pl.attr({style:{stroke:t}})}},{key:"oneBezier",value:function(t,e,i){var o=Object(ci["a"])(e,2),n=o[0],s=o[1],a=Object(ci["a"])(i,2),r=a[0],h=a[1],c=n+(r-n)*t,l=s+(h-s)*t;return[c,l]}},{key:"twoBezier",value:function(t,e,i,o){var n=Object(ci["a"])(e,2),s=n[0],a=n[1],r=Object(ci["a"])(i,2),h=r[0],c=r[1],l=Object(ci["a"])(o,2),d=l[0],u=l[1],f=(1-t)*(1-t)*s+2*t*(1-t)*h+t*t*d,p=(1-t)*(1-t)*a+2*t*(1-t)*c+t*t*u;return[f,p]}},{key:"threeBezier",value:function(t,e,i,o,n){var s=Object(ci["a"])(e,2),a=s[0],r=s[1],h=Object(ci["a"])(n,2),c=h[0],l=h[1],d=Object(ci["a"])(i,2),u=d[0],f=d[1],p=Object(ci["a"])(o,2),g=p[0],y=p[1],x=a*(1-t)*(1-t)*(1-t)+3*u*t*(1-t)*(1-t)+3*g*t*t*(1-t)+c*t*t*t,v=r*(1-t)*(1-t)*(1-t)+3*f*t*(1-t)*(1-t)+3*y*t*t*(1-t)+l*t*t*t;return[x,v]}},{key:"getTextPosition",value:function(){var t=this.position.slice(),e=this.relateText.position.slice();return{x:t[0]+e[0],y:t[1]+e[1]}}},{key:"getTextBox",value:function(){return this.relateText.getBoundingRect()}},{key:"setAttr",value:function(t){this.bs.attr({style:{stroke:t}}),this.pl.attr({style:{stroke:t,fill:this.stroke}}),this.relateText.attr({style:{text:this.text,textFill:this.textFill,fontSize:this.fontSize,fontStyle:this.fontStyle,fontWeight:this.fontWeight,textBackgroundColor:this.textBackgroundColor}})}},{key:"setData",value:function(t){this.id=t["id"],this.text=t["text"],this.stroke=t["stroke"],this.textFill=t["textFill"],this.type=t["type"],this.textBackgroundColor=t["fill"],this.lineDashType=t["lineDashType"]||this.lineDashType,this.lineWidth=t["lineWidth"]||1,this.fontSize=t["fontSize"]||12,this.fontStyle=t["fontStyle"]||"normal",this.fontWeight=t["fontWeight"],this.entryExt=t["ext"],this.exitExt=t["ext"],this.entryDirection=t["entryDirection"],this.exitDirection=t["exitDirection"],t["position"]&&this.setPosition(t["position"][0],t["position"][1]),this.cpx=t["cpx"]||this.getCpx(),this.lineCenter=t["lineCenter"],this.setLineDashType(),this.setAttr(this.stroke,this.textFill,this.textBackgroundColor),this.setText(this.text),this.changeType(this.type),"bs"==this.type&&this.setCpx(t.cpx),this.text?this.relateText.show():this.relateText.hide()}},{key:"getData",value:function(){var t=this.getCpx();return bi({},{id:this.id||this.bs.id,fromNode:this.fromNode&&this.fromNode.getId()||"",endNode:this.toNode&&this.toNode.getId()||"",fromAnch:this.fromAnch&&this.fromAnch.point.index||"",toAnch:this.toAnch&&this.toAnch.point.index||"",text:this.text,stroke:this.stroke,textFill:this.textFill,lineWidth:this.lineWidth,lineDashType:this.lineDashType,fontSize:this.fontSize,fontStyle:this.fontStyle,fontWeight:this.fontWeight,type:this.type,ext:this.entryExt,lineDash:this.lineDash.slice(),fill:this.textBackgroundColor,lineCenter:this.lineCenter.slice(),entryDirection:this.entryDirection.slice(),entryExt:this.entryExt,exitDirection:this.exitDirection.slice(),exitExt:this.exitExt,cpx:t,position:this.position.slice()})}},{key:"changeType",value:function(t){this.type=t||this.type,this.remove(this.bs),this.bs="bs"==t?new R.a.BezierCurve({style:{stroke:this.stroke,lineWidth:this.lineWidth||1,lineDash:this.lineDash},z:16}):"polyline"==t?new R.a.Polyline({style:{stroke:this.stroke,lineWidth:this.lineWidth||1,lineDash:this.lineDash},z:16}):new R.a.Line({style:{stroke:this.stroke,lineWidth:this.lineWidth||1,lineDash:this.lineDash},z:16}),this.add(this.bs),this.initEvent(),this._refresh()}}]),e}(R.a.Group);function Oi(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,o)}return i}function Ti(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?Oi(Object(i),!0).forEach((function(e){Object(N["a"])(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):Oi(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}var Di=function(t){function e(){var t,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"新建分组",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"#fafafa",s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"#ccc",a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"#333",r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"dash",h=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1;return Object(G["a"])(this,e),t=Object(F["a"])(this,Object(_["a"])(e).call(this)),t.nodes=i,t.groupText=o,t.stroke=s,t.fill=n,t.textFill=a,t.strokeType=r,t.headFill="",t.locked=!1,t.lockImage={lockImage:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAABEklEQVQ4T2NkoBAwYtOvKCkgz/iftZfhP4MEWJ6R4cV/xt/F959/eIiuHsMAJUFBfgY25tP/GBlSH7x4cxCkQU5CSIuFgWnGvx9//B58+PAB2RBMAyREGv/9/Xf8wet3O5AVKkiIODAyMDjdf/GmDr8B4iKb7718E8TAwPAbzbmsSuIi6++9fONDyIDd916+ccUWNkriIhhycC/IifErMTGxyjH9Y+j5x8RQgs0AmNy/f78fPXr18R4kfKFAWUKk6/9/Br5///+LMTExXsJmwL9///WYGBlfMTIyfLr74k0ZhgF//jIuf/j69Xl8SUNeVNSQhfl/5KgBtAoDBgYGJwYGhi8EMigPAwPDPoxYIDdXAwB8nKARpjp7NAAAAABJRU5ErkJggg==",unLockImage:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAA00lEQVQ4T93TIUuDURSA4WdJmC4blvQ/iHmiYYYV2/6FMEw2MSwOhIFhdTBYmFXDksExFlzSosXmTxDkwhe+Xa67sDVPPuc9977nnIoto/JH/Q7ucI49zHGN5zg/BQjFUyzQwzcu0MUZZmVICnCFJhpRt07xopMcYIwn9CPAIZao5gCPGGAYAXbxhvqmgKTvsoMa3rGfmewHWngNeWXAESZoZwCXeMFtDDgu/h1krYsg9ws3/xAQJI5wkHFwj8+UxLAoD1hZ1QTsB6fFvayMcaPD/gW+1yoRIiSCtwAAAABJRU5ErkJggg=="},t.lockImageItem=new R.a.Image({style:{image:t.lockImage.unLockImage,width:16,height:16},z:h+1}),t.getLineDash(),t.showHead=!0,t.anchors=[],t.groupStyle={fill:t.fill,lineWidth:1,stroke:t.stroke,lineDash:t.lineDash},t.headStyle={fill:t.fill,lineWidth:1,stroke:t.stroke,text:t.groupText,textFill:t.textFill,lineDash:t.lineDash,textPosition:"insideLeft",fontSize:12,fontStyle:"",fontWeight:"",transformText:!0},t.z=h,t.groupRect=new R.a.Rect({style:t.groupStyle,z:h}),t.groupHead=new R.a.Rect({style:t.headStyle,z:h}),t.gtext=new R.a.Text({style:{textPadding:[6,10],fontSize:14,text:t.groupText}}),t.nodeType="group",t.add(t.groupRect),t.add(t.groupHead),t.add(t.lockImageItem),t.redoGroup(),t.groupHead.nodeGroup=Object(I["a"])(t),t.groupRect.nodeGroup=Object(I["a"])(t),t.create(),t.createAnchors(),t.anch=new Ae(Object(I["a"])(t)),t.anch.hide(),t.initEvent(),t}return Object(B["a"])(e,t),Object(A["a"])(e,[{key:"getId",value:function(){return this.id||this.groupRect.id}},{key:"setId",value:function(t){this.id=t}},{key:"getLineDash",value:function(){"solid"==this.strokeType?this.lineDash=[]:this.lineDash=[4,2]}},{key:"create",value:function(t){if(this.locked){var e=this.position.slice(),i=new R.a.Group,o=i.getBoundingRect([this]);return o.width=parseInt(o.width),o.height=parseInt(o.height),o={x:e[0],y:e[1],width:o.width,height:o.height},this.box=o,void this._refresh()}var n=new R.a.Group,s={};this.gtext.setStyle("text",this.groupText),this.tb=this.gtext.getBoundingRect();var a=this.tb;if(a.height=Math.ceil(a.height),this.nodes.length>0)s=n.getBoundingRect(t||this.nodes),s.x=parseInt(s.x),s.y=parseInt(s.y),s.width=parseInt(s.width),s.height=parseInt(s.height),s.width<40&&(s.width=40),s.height<40&&(s.height=40),s.x-=20,s.width+=40,this.showHead?(s.y=s.y-a.height-20,s.height+=40+a.height,this.groupHead.show()):(s.y=s.y-20,s.height+=40,this.groupHead.hide()),this.box=s;else{var r=this.position.slice();s={x:r[0],y:r[1],width:80,height:60+a.height},this.box=s}this._refresh()}},{key:"toggleLock",value:function(){this.locked=!this.locked,this.locked?this.lockImageItem.attr({style:{image:this.lockImage.lockImage}}):this.lockImageItem.attr({style:{image:this.lockImage.unLockImage}})}},{key:"createAnchors",value:function(){this.anchors=[];var t=this.box,e={x:t.x+t.width/4,y:t.y,index:1,node:this,direct:"top"},i={x:t.x+t.width/2,y:t.y,index:2,node:this,direct:"top"},o={x:t.x+t.width/4*3,y:t.y,index:3,node:this,direct:"top"},n={x:t.x+t.width,y:t.y+t.height/4,index:4,node:this,direct:"right"},s={x:t.x+t.width,y:t.y+t.height/2,index:5,node:this,direct:"right"},a={x:t.x+t.width,y:t.y+t.height/4*3,index:6,node:this,direct:"right"},r={x:t.x+t.width/4,y:t.y+t.height,index:7,node:this,direct:"bottom"},h={x:t.x+t.width/2,y:t.y+t.height,index:8,node:this,direct:"bottom"},c={x:t.x+t.width/4*3,y:t.y+t.height,index:9,node:this,direct:"bottom"},l={x:t.x,y:t.y+t.height/4,index:10,node:this,direct:"left"},d={x:t.x,y:t.y+t.height/2,index:11,node:this,direct:"left"},u={x:t.x,y:t.y+t.height/4*3,index:12,node:this,direct:"left"};this.anchors.push(e,i,o,n,s,a,r,h,c,l,d,u)}},{key:"getAnchorByIndex",value:function(t){return this.anchors.filter((function(e){return e.index==t}))[0]}},{key:"getAnchByIndex",value:function(t){if(this.anch)return this.anch.getBarByIndex(t)}},{key:"getAnchors",value:function(){return this.anchors}},{key:"_refresh",value:function(){var t=this.box;if(this.attr({position:[t.x,t.y]}),this.locked)this.groupRect.attr({style:this.groupStyle}),this.groupHead.attr({style:this.headStyle});else{var e=this.tb;this.groupRect.attr({style:this.groupStyle,shape:{x:.5,y:.5,width:t.width,height:t.height}}),this.groupHead.attr({style:this.headStyle,shape:{x:.5,y:.5,width:t.width,height:e.height}}),this.lockImageItem.attr({position:[t.width-20,5]})}}},{key:"setPosition",value:function(t,e){this.attr({position:[t,e]})}},{key:"getPosition",value:function(){var t=this.position.slice();return{x:t[0],y:t[1]}}},{key:"viewTemGroup",value:function(t,e){if("up"==t){var i=this.nodes.slice();this.create(i.concat(e))}else{var o=this.nodes.filter((function(t){return t!=e}));o.length?this.create(o):this.create([this])}}},{key:"move",value:function(t,e){var i=this.getPosition();this.attr({position:[i.x+t,i.y+e]})}},{key:"addNode",value:function(t){t.nodeGroup=this,this.nodes.indexOf(-1==t)&&(this.nodes.push(t),this.refresh())}},{key:"setLevel",value:function(t){this.z=t,this.groupRect.attr({z:t}),this.groupHead.attr({z:t})}},{key:"getLevel",value:function(){return this.z}},{key:"removeNode",value:function(t){var e=this.nodes.indexOf(t);e>-1&&this.nodes.splice(e,1),t.nodeGroup=null,this.refresh()}},{key:"refresh",value:function(){this.create(),this.refreshEdge();var t=this.topGroup;while(t)t.refresh(),t=t.topGroup}},{key:"refreshEdge",value:function(){this.createAnchors(),this.anch.refresh(),this.__zr&&this.__zr.trigger("refreshEdge",{node:this})}},{key:"cancelGroup",value:function(){this.nodes.forEach((function(t){t.nodeGroup=null}))}},{key:"redoGroup",value:function(){var t=this;this.nodes.forEach((function(e){e.nodeGroup=t}))}},{key:"getStyle",value:function(){var t=this.groupHead.style;return Ti({stroke:this.stroke,groupFill:this.fill,text:this.text,showHead:this.showHead},t)}},{key:"getGroupStyle",value:function(){return R.a.util.clone(this.groupStyle)}},{key:"setGroupStyle",value:function(t){this.stroke=t.stroke,this.fill=t.fill,this.groupStyle=Ti({},this.groupStyle,{},t),this.headStyle.stroke=this.stroke,this.refresh()}},{key:"getHeadStyle",value:function(){return R.a.util.clone(this.headStyle)}},{key:"setHeadStyle",value:function(t){this.headFill=t.fill,this.groupText=t.text,this.headStyle=Ti({},this.headStyle,{},t),this.gtext.setStyle("fontSize",t.fontSize),this.gtext.setStyle("text",t.groupText),this.refresh()}},{key:"changeHead",value:function(t){this.showHead=t,t?this.groupHead.show():this.groupHead.hide(),this.refresh()}},{key:"getGroupData",value:function(t){var e=[];t.nodes.forEach((function(t){if("node"==t.nodeType){var i={type:"node",node:t.getId()};e.push(i)}}));var i={id:t.getId(),nodes:e,topGroup:t.topGroup&&t.topGroup.getId()||"",headStyle:R.a.util.clone(t.groupHead.style),groupStyle:R.a.util.clone(t.groupRect.style),showHead:t.showHead,locked:t.locked};return t.locked&&(i.box=R.a.util.clone(t.box)),i}},{key:"setBox",value:function(t){this.box=t}},{key:"getData",value:function(){return this.getGroupData(this)}},{key:"setOldPos",value:function(){function t(e){e.oldPos=e.position.slice(),e.nodes.forEach((function(e){e.oldPos=e.position.slice(),"group"==e.type&&t(e)}))}t(this)}},{key:"getAllItems",value:function(){var t=[this];function e(i){i.nodes.forEach((function(i){t.push(i),"group"==i.type&&e(i)}))}return e(this),t}},{key:"initEvent",value:function(){var t,e,i,o,n,s,a=this,r=!1,h=!1,c=this;this.on("mouseover",(function(){a.create(),a.createAnchors(),a.anch.refresh(),a.anch.show(),a.lockImageItem.show()})),this.on("mouseout",(function(){a.anch.hide(),a.lockImageItem.hide()})),this.on("mousedown",(function(o){if(a.__zr.trigger("clearSelectItems"),a.__zr.trigger("selectGroup",{group:a}),t=parseInt(o.offsetX),e=parseInt(o.offsetY),r=!0,i=a.position.slice(),a.setOldPos(),s=a.getAllItems(),a.editor){a.editor.multipleSelectEdges(s);var n=new R.a.Group,h=n.getBoundingRect([a]);a.editor.cover.attr({position:[i[0],i[1]],shape:{width:h.width,height:h.height}})}s.forEach((function(t){t.anch&&t.anch.hide()})),a.dragging=!1,document.addEventListener("mousemove",l),document.addEventListener("mouseup",d),o.stopPropagation&&o.stopPropagation()}));var l=function(s){r&&(o=parseInt(s.offsetX-t),n=parseInt(s.offsetY-e),a.editor&&(a.editor.cover.show(),a.editor.cover.attr({position:[i[0]+o,i[1]+n]})),h=!0,a.dragging=!0,a.anch.hide())};this.on("dblclick",(function(){this.showHead&&this.__zr.trigger("edit",{status:"editGroup",group:this,text:this.headStyle.text})})),this.groupRect.on("dragenter",(function(t){var e=t.topTarget;e&&"node"!=e.nodeType||(-1==c.nodes.indexOf(e)?(this.setStyle("stroke","red"),e.addToNodeGroup=!0):(e.groupTime&&(e.groupTime=null,e.leaveGroup=!1,e.groupTimeout&&(clearTimeout(e.groupTimeout),e.groupTimeout=null)),e.addToNodeGroup=!1))})).on("dragleave",(function(t){var e=t.topTarget;e&&"node"!=e.nodeType||(c.nodes.indexOf(e)>-1?c.locked?(this.setStyle("stroke","red"),e.groupTime=+new Date,e.leaveGroup=!0,e.groupTimeout=setTimeout((function(){c.groupRect.setStyle("stroke","#ccc"),clearTimeout(e.groupTimeout),e.groupTimeout=null,e.groupTime=null,e.leaveGroup=!0,c.refresh()}),50)):(this.setStyle("stroke","red"),e.groupTime=+new Date,e.leaveGroup=!0,e.groupTimeout=setTimeout((function(){c.viewTemGroup("down",e),clearTimeout(e.groupTimeout),e.groupTimeout=null,e.groupTime=null,e.leaveGroup=!0}),1500)):(this.setStyle("stroke",c.stroke),e&&(e.addToNodeGroup=!1,e.leaveGroup=!1)))})).on("drop",(function(t){var e=t.topTarget;if(e){if("node"!=e.nodeType)return;-1==c.nodes.indexOf(e)&&(e.addToNodeGroup=!1,this.__zr.trigger("addNodeToGroup",{node:e,group:c}),this.setStyle("stroke",c.stroke),e.leaveGroup=!1)}}));var d=function t(){r&&(a.dragging=!1,r=!1,h&&(a.attr({position:[i[0]+o,i[1]+n]}),a.editor.moveNode(o,n,s),a.__zr.trigger("moveGroup",{group:a}),h=!1,a.create(),a.createAnchors(),a.refreshEdge(),a.anch.refresh(),a.anch.show(),a.editor.cover.hide()),s.forEach((function(t){t.create&&t.create(),t.createAnchors(),t.anch&&t.anch.refresh()}))),document.removeEventListener("mousemove",l),document.removeEventListener("mouseup",t)};document.addEventListener("mouseup",d),this.lockImageItem.on("click",(function(){a.toggleLock()}))}}]),e}(R.a.Group),Pi=Di;function ji(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,o)}return i}function Si(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?ji(Object(i),!0).forEach((function(e){Object(N["a"])(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):ji(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}var Ei=function(t){function e(t,i){var o;return Object(G["a"])(this,e),o=Object(F["a"])(this,Object(_["a"])(e).call(this)),o.zr=R.a.init(document.getElementById(t),{renderer:"canvas"}),o.id=o.uuid(),o.data=i||{},o.stack=new W(o.data.stackStep||50),window.editor=Object(I["a"])(o),o.nodes=[],o.edges=[],o.curEdgeType="polyline",o.groups=[],o.status="",o.frame=new hi(Object(I["a"])(o)),o.frame.addTo(Object(I["a"])(o)),o.selectFrame=new R.a.Rect({style:{fill:"#1890ff",opacity:.1},shape:{x:0,y:0,width:0,heigt:0},z:1e4}),o.zr.add(o.selectFrame),o.selectFrame.hide(),o.zr.add(Object(I["a"])(o)),o.cover=new R.a.Rect({style:{fill:"rgb(231, 247, 254)",stroke:"rgb(178, 222, 254)",opacity:.6},shape:{width:0,height:0},z:1e5}),o.cover.hide(),o.add(o.cover),o.commandChange(),o.initEvent(),o}return Object(B["a"])(e,t),Object(A["a"])(e,[{key:"init",value:function(t,e){var i=this;if(this.nodes=[],this.edges=[],this.curEdgeType="polyline",this.groups=[],this.removeAll(),this.add(this.cover),this.frame.addTo(this),this.attr({position:[0,0]}),!t||!t.type||"cicadaFlow"!=t.type)throw new Error("不支持的数据");this.initData=t;var o=t.node,n=t.group,s=t.edge;o.forEach((function(t){var o=$e.getShape(t.command,t,e);o.setData(t),e||(o.createAnchors(),o.anch.refresh()),i.addNode(o)})),n.forEach((function(t){var e=[];t.nodes.forEach((function(t){e.push(i.getNodeById(t.node))}));var o=new Pi(e);o.setHeadStyle(t.headStyle),o.setGroupStyle(t.groupStyle),o.setId(t.id),o.changeHead(t.showHead),t.locked&&(o.setBox(t.box),o.toggleLock()),i.addGroup(o)})),n.forEach((function(t){if(t.topGroup){var e=i.getGroupById(t.topGroup),o=i.getGroupById(t.id);o.topGroup=e,e.nodes.push(o),e.refresh()}})),s.forEach((function(t){var e=new ki;if(e.setData(t),t.fromNode){var o=i.getItemById(t.fromNode),n=o.getAnchByIndex(t.fromAnch);e.setFromNode(o),e.setFromAnch(n)}if(t.endNode){var s=i.getItemById(t.endNode),a=s.getAnchByIndex(t.toAnch);e.setToNode(s),e.setToAnch(a)}i.addEdge(e)}))}},{key:"clearHistory",value:function(){this.stack.clear()}},{key:"getItemById",value:function(t){var e=this.nodes.concat(this.groups);return e.filter((function(e){return e.getId()==t}))[0]}},{key:"getNodeById",value:function(t){return this.nodes.filter((function(e){return e.getId()==t}))[0]}},{key:"getGroupById",value:function(t){return this.groups.filter((function(e){return e.getId()==t}))[0]}},{key:"getEdgeById",value:function(t){return this.edges.filter((function(e){return e.getId()==t}))[0]}},{key:"parseSvg",value:function(){}},{key:"addShape",value:function(t){this.execute("addShape",t)}},{key:"execute",value:function(t,e,i){var o,n=[];switch(t){case"addShape":e.x=e.x-this.position[0],e.y=e.y-this.position[1];try{e.image&&(e.command="image");var s=$e.getShape(e.command,e);this.stack.execute(new He([s],this))}catch(b){window.console.log(b)}break;case"moveNode":i.length&&(i.forEach((function(t){if("node"==t.nodeType){var e=t.oldPos.slice(),i=t.position.slice(),o=new Ue(t,e,i);n.push(o)}})),n.length&&(o=new Je(n),this.stack.execute(o)));break;case"addEdge":var a=e.edge;this.stack.execute(new Ye(a,this));break;case"createGroup":this.stack.execute(new Qe(e.group,e.topGroup,this));break;case"cancelGroup":this.stack.execute(new Ze(e.group,this.zr));break;case"removeNodeFromGroup":this.stack.execute(new Ke(e.node));break;case"addNodeToGroup":this.stack.execute(new Ve(e.node,e.group));break;case"changeNode":i.length&&(i.forEach((function(t){var i=t.getData(),o=R.a.util.clone(i);e.style&&(o.style=Si({},o.style,{},e.style)),e.shape&&(o.shape=Si({},o.shape,{},e.shape)),e.hasOwnProperty("z")&&(o.z=parseInt(e.z));var s=new ti(t,i,o);n.push(s)})),o=new Je(n),this.stack.execute(o));break;case"resizeNode":var r=this.getSelectNodes()[0],h=r.getData(),c=new ti(r,e.oldData,h);this.stack.execute(c);break;case"changeGroup":var l,d,u=e.mark,f=e.group,p=e.style;"head"==u?(l=Si({},f.getHeadStyle()),d=Si({},l,{},p),this.stack.execute(new ei(f,l,d,u))):"group"==u?(l=Si({},f.getGroupStyle()),d=Si({},l,{},p),this.stack.execute(new ei(f,l,d,u))):this.stack.execute(new oi(f,e.showHead));break;case"deleteNode":this.stack.execute(new qe([e.node],this));break;case"deleteNodes":this.stack.execute(new qe(e.nodes,this));break;case"deleteGroup":this.stack.execute(new ii(e.group,this));break;case"deleteEdge":this.stack.execute(new Xe(e.edge,this));break;case"changeEdge":var g=e.type;if("changeAnch"==g)"anch"==e.mark?this.stack.execute(new ai(e.edge,e)):"point"==e.mark&&this.stack.execute(new ai(e.edge,e));else if("text"==e.mark){var y=e.edge.getText(),x=e.style.text;this.stack.execute(new si(e.edge,y,x))}else{var v,m;v=e.edge.getData(),m=Si({},v,{},e.style),this.stack.execute(new ni(e.edge,v,m))}break;case"ungroup":var w=e.group;w&&this.stack.execute(new Ze(w,this));break}}},{key:"undo",value:function(){this.stack.undo()}},{key:"redo",value:function(){this.stack.redo()}},{key:"commandChange",value:function(){var t=this;this.stack.change=function(){t.refreshHistory()}}},{key:"refreshFullEdge",value:function(){this.fullSelectEdges.length&&this.fullSelectEdges.forEach((function(t){var e=t.oldPos?t.oldPos.slice():t.position.slice(),i=t.position.slice(),o=i[0]-e[0],n=i[1]-e[1],s=R.a.util.clone(t.oldCpx);if(s.x1=s.x1+o,s.x2=s.x2+o,s.y1=s.y1+n,s.y2=s.y2+n,s.cpx1=parseFloat(s.cpx1)+o,s.cpy1=parseFloat(s.cpy1)+n,s.cpx2=parseFloat(s.cpx2)+o,s.cpy2=parseFloat(s.cpy2)+n,"polyline"==t.type){var a=s.points;a.forEach((function(t){t[0]=t[0]+o,t[1]=t[1]+n})),s.points=a;var r=s.lineCenter.slice();s.lineCenter[0]=r[0]+o,s.lineCenter[1]=r[1]+n}t.setCpx(s),t.refresh(),t.setPosition(0,0)}))}},{key:"refreshHistory",value:function(){this.zr.trigger("undoredo",{undo:!!this.stack.canUndo(),redo:!!this.stack.canRedo()})}},{key:"uuid",value:function(){function t(){return(65536*(1+Math.random())|0).toString(16).substring(1)}function e(){return t()+t()+t()+t()}return e()}},{key:"getData",value:function(){var t=this.nodes.map((function(t){return t.getData()})),e=this.groups.map((function(t){return t.getData()})),i=this.edges.map((function(t){return t.getData()}));return{id:this.id,type:"cicadaFlow",node:t,group:e,edge:i}}},{key:"copy",value:function(t,e){var i=this,o=[],n=[];if("node"==t){if(e.forEach((function(t){var e=t.position.slice(),n=R.a.util.clone(t.getData());n.id=i.uuid();var s=$e.getShape(n.command,n,!1);o.push(s),s.attr({position:[e[0]+20,e[1]+20]}),s.createAnchors(),s.anch.refresh()})),o.length){var s=new He(o,this);this.stack.execute(s)}}else if("group"==t){var a=R.a.util.clone(e.getData());e.nodes.forEach((function(t){if("node"==t.nodeType){var e=t.position.slice(),n=R.a.util.clone(t.getData());n.id=i.uuid();var s=$e.getShape(n.command,n,!1);o.push(s),s.attr({position:[e[0]+20,e[1]+20]}),s.createAnchors(),s.anch.refresh()}}));var r=new Pi(o);r.editor=this,r.setGroupStyle(a.groupStyle),r.setHeadStyle(a.headStyle),r.changeHead(a.showHead);var h=new Qe(r,null,this),c=new He(o,this);n.push(h),n.push(c),this.stack.execute(new Je(n))}}},{key:"selectItem",value:function(t){this.clearSelectItems(),t.active();var e=new R.a.Group,i=e.getBoundingRect([t]);this.frame.boxSelect(i,t),this.frame.refreshBar(),this.frame.show()}},{key:"selectItems",value:function(t){this.clearSelectItems();var e=new R.a.Group;t.forEach((function(t){t.selected=!0,e.add(t)}));var i=e.getBoundingRect(t);this.frame.boxSelect(i,t)}},{key:"getSelectItems",value:function(){return this.nodes.filter((function(t){return t.selected})).concat(this.edges.filter((function(t){return t.selected})))}},{key:"getSelectNodes",value:function(){return this.nodes.filter((function(t){return t.selected||t.dragging}))}},{key:"getSelectEdges",value:function(){return this.edges.filter((function(t){return t.selected}))}},{key:"getEdgesByNode",value:function(t){var e=[];return this.edges.forEach((function(i){i.fromNode!=t&&i.toNode!=t||-1==e.indexOf(i)&&e.push(i)})),e}},{key:"clearSelectItems",value:function(){this.nodes.forEach((function(t){t.unactive()})),this.edges.forEach((function(t){t.unactive()})),this.groups.forEach((function(t){return t.selected=!1})),this.frame.hide()}},{key:"addNode",value:function(t){var e=this;this.nodes.push(t),this.add(t),t.anch&&t.anch.bars.forEach((function(t){e.add(t)}))}},{key:"addEdge",value:function(t){-1==this.edges.indexOf(t)&&(this.edges.push(t),this.add(t),t.editor=this)}},{key:"removeEdge",value:function(t){var e=this.edges.indexOf(t);e>-1&&(this.remove(t),this.edges.splice(e,1))}},{key:"removeNode",value:function(t){var e=this,i=this.nodes.indexOf(t);i>-1&&(this.nodes.splice(i,1),t.anch&&t.anch.bars.forEach((function(t){e.remove(t)})),this.remove(t))}},{key:"getAllEdgesByGroup",value:function(t){var e=this;if(t){var i=this.getEdgesByGroup(t),o=t.nodes;return o.forEach((function(t){var o=e.getEdgesByNode(t);o.forEach((function(t){-1==i.indexOf(t)&&i.push(t)}))})),i}return[]}},{key:"showAllAnch",value:function(){this.hasShowAllAnch||(this.nodes.forEach((function(t){t.time&&clearTimeout(t.time),t.anch.show()})),this.groups.forEach((function(t){t.time&&clearTimeout(t.time),t.anch.show()})),this.hasShowAllAnch=!0)}},{key:"hideAllAnch",value:function(){this.nodes.forEach((function(t){t.anch.hide()})),this.hasShowAllAnch=!1}},{key:"getEdgesByGroup",value:function(t){var e=[];return this.edges.forEach((function(i){i.fromNode!=t&&i.toNode!=t||-1==e.indexOf(i)&&e.push(i)})),e}},{key:"multipleSelect",value:function(){var t=this.selectFrame.getBoundingRect(),e=new R.a.Group,i=this.position.slice();this.nodes.forEach((function(o){var n=e.getBoundingRect([o]);n.x=n.x+i[0],n.y=n.y+i[1],t.intersect(n)?o.active():o.unactive()}))}},{key:"multipleSelectEdges",value:function(t){var e=this;this.selectGroups=[],this.fullSelectEdges=[],this.notFullSelectEdges=[];var i=t||this.getSelectNodes(),o=[],n=[];i.forEach((function(t){if("node"==t.nodeType){t.nodeGroup&&-1==e.selectGroups.indexOf(t.nodeGroup)&&e.selectGroups.push(t.nodeGroup);var s=e.getEdgesByNode(t);s.forEach((function(t){i.indexOf(t.fromNode)>-1&&i.indexOf(t.toNode)>-1?-1==n.indexOf(t)&&(n.push(t),t.oldCpx=Si({},{},{},t.getCpx()),t.oldPos=t.position.slice()):-1==o.indexOf(t)&&(o.push(t),t.oldCpx=Si({},{},{},t.getCpx()),t.oldPos=t.position.slice())}))}else if("group"==t.nodeType){var a=e.getEdgesByGroup(t);a.forEach((function(t){i.indexOf(t.fromNode)>-1&&i.indexOf(t.toNode)>-1?-1==n.indexOf(t)&&(n.push(t),t.oldCpx=Si({},{},{},t.getCpx()),t.oldPos=t.position.slice()):-1==o.indexOf(t)&&(o.push(t),t.oldCpx=Si({},{},{},t.getCpx()),t.oldPos=t.position.slice())}))}})),this.fullSelectEdges=n,this.notFullSelectEdges=o}},{key:"moveNode",value:function(t,e,i){var o=this,n=i||this.getSelectNodes();n.forEach((function(i){var n=i.oldPos;i.attr({position:[n[0]+t,n[1]+e]}),o.moveEdge(t,e,i)}))}},{key:"moveRefreshEdge",value:function(){this.fullSelectEdges.forEach((function(t){t.refresh()})),this.notFullSelectEdges.forEach((function(t){t.refresh()}))}},{key:"viewProGroup",value:function(){var t=this.getSelectNodes();t.forEach((function(t){t.nodeGroup?t.groupTime&&t.groupEndTime&&t.groupEndTime-t.groupTime>1e3&&t.nodeGroup.viewTemGroup("down",t):t.groupTime&&t.groupEndTime&&t.temporaryGroup&&t.groupEndTime-t.groupTime>1e3&&t.temporaryGroup.viewTemGroup("up",t)}))}},{key:"dropProGroup",value:function(){var t=this.getSelectNodes();t.forEach((function(t){t.nodeGroup?t.groupTime&&t.groupEndTime&&t.groupEndTime-t.groupTime>1e3&&t.nodeGroup.removeNode(t):t.groupTime&&t.groupEndTime&&t.temporaryGroup&&t.groupEndTime-t.groupTime>1e3&&t.temporaryGroup.addNode(t)}))}},{key:"moveEdge",value:function(t,e,i){this.fullSelectEdges.forEach((function(i){var o=R.a.util.clone(i.oldCpx);if(o.x1=o.x1+t,o.x2=o.x2+t,o.y1=o.y1+e,o.y2=o.y2+e,o.cpx1=o.cpx1+t,o.cpy1=o.cpy1+e,o.cpx2=o.cpx2+t,o.cpy2=o.cpy2+e,"polyline"==i.type){var n=o.points;n.forEach((function(i){i[0]=i[0]+t,i[1]=i[1]+e})),o.points=n;var s=o.lineCenter.slice();o.lineCenter[0]=s[0]+t,o.lineCenter[1]=s[1]+e}i.setCpx(o),i.refresh()})),this.notFullSelectEdges.forEach((function(t){"group"==i.nodeType&&i.create(),i.createAnchors(),t.fromNode==i?(t.setFromPoint(i.getAnchorByIndex(t.fromAnch.point.index)),t.refresh()):t.toNode==i&&(t.setToPoint(i.getAnchorByIndex(t.toAnch.point.index)),t.refresh())}))}},{key:"updateNodeAnch",value:function(){var t=this.getSelectNodes();t.forEach((function(t){t.createAnchors(),t.anch&&t.anch.refresh()}))}},{key:"setShadow",value:function(){this.nodes.forEach((function(t){return t.setShadow()})),this.groups.forEach((function(t){return t.setShadow()})),this.edges.forEach((function(t){return t.setShadow()}))}},{key:"cancelShadow",value:function(){this.nodes.forEach((function(t){return t.cancelShadow()})),this.groups.forEach((function(t){return t.cancelShadow()})),this.edges.forEach((function(t){return t.cancelShadow()}))}},{key:"leftAlign",value:function(){var t=[],e=this.getSelectNodes();if(e.length>1){var i=new R.a.Group,o=i.getBoundingRect(e);e.forEach((function(e){e.oldPos=e.position.slice();var n=i.getBoundingRect([e]),s=o.x-n.x,a=e.position.slice();a[0]=a[0]+parseInt(s),e.attr({position:a.slice()}),e.refreshEdge(),e.nodeGroup&&-1==t.indexOf(e.nodeGroup)&&t.push(e.nodeGroup)})),this.execute("moveNode",{},e),t.forEach((function(t){t.refresh()}))}}},{key:"rightAlign",value:function(){var t=[],e=this.getSelectNodes();if(e.length>1){var i=new R.a.Group,o=i.getBoundingRect(e);e.forEach((function(e){e.oldPos=e.position.slice();var n=i.getBoundingRect([e]),s=o.x+o.width-n.x-n.width,a=e.position.slice();a[0]=a[0]+parseInt(s),e.attr({position:a.slice()}),e.refreshEdge(),e.nodeGroup&&-1==t.indexOf(e.nodeGroup)&&t.push(e.nodeGroup)})),this.execute("moveNode",{},e),t.forEach((function(t){t.refresh()}))}}},{key:"verticalAlign",value:function(){var t=[],e=this.getSelectNodes();if(e.length>1){var i=new R.a.Group,o=i.getBoundingRect([e[0]]),n=o.x+o.width/2;e.forEach((function(o){if(o.oldPos=o.position.slice(),o!=e[0]){var s=i.getBoundingRect([o]),a=s.x+s.width/2,r=n-a,h=o.position.slice();h[0]=h[0]+parseInt(r),o.attr({position:h.slice()})}o.refreshEdge(),o.nodeGroup&&-1==t.indexOf(o.nodeGroup)&&t.push(o.nodeGroup)})),this.execute("moveNode",{},e),t.forEach((function(t){t.refresh()}))}}},{key:"horizontalAlign",value:function(){var t=[],e=this.getSelectNodes();if(e.length>1){var i=new R.a.Group,o=i.getBoundingRect([e[0]]),n=o.y+o.height/2;e.forEach((function(o){if(o.oldPos=o.position.slice(),o!=e[0]){var s=i.getBoundingRect([o]),a=s.y+s.height/2,r=n-a,h=o.position.slice();h[1]=h[1]+parseInt(r),o.attr({position:h.slice()})}o.refreshEdge(),o.nodeGroup&&-1==t.indexOf(o.nodeGroup)&&t.push(o.nodeGroup)})),this.execute("moveNode",{},e),t.forEach((function(t){t.refresh()}))}}},{key:"createGroup",value:function(){var t,e=this.getSelectNodes();if(e.length>1){var i=e.every((function(t){return!t.nodeGroup}));if(i)t=new Pi(e),t.editor=this,this.execute("createGroup",{group:t});else{var o=e.every((function(t){return t.nodeGroup}));if(o){var n=e[0].nodeGroup,s=e.every((function(t){return t.nodeGroup==n}));if(s){var a=n.getLevel();t=new Pi(e,"新建分组","#fafafa","#ccc","#333","dash",a+1),t.editor=this,t.topGroup=n,this.execute("createGroup",{group:t,topGroup:n})}}}}}},{key:"listen",value:function(t,e){this.zr.on(t,e)}},{key:"removeListen",value:function(t,e){this.zr.off(t,e)}},{key:"emit",value:function(t,e){this.zr.trigger(t,e)}},{key:"addGroup",value:function(t){var e=this;-1==this.groups.indexOf(t)&&(this.add(t),t.anch.bars.forEach((function(t){e.add(t)})),this.groups.push(t),t.editor=this)}},{key:"removeGroup",value:function(t){var e=this,i=this.groups.indexOf(t);i>-1&&(this.groups.splice(i,1),this.remove(t),t.anch.bars.forEach((function(t){e.remove(t)})))}},{key:"refreshGroup",value:function(){this.groups.forEach((function(t){t.refresh()}))}},{key:"showAnch",value:function(t,e){if("selectEdge"!=this.status&&"selectFrame"!=this.status){var i=new R.a.Group,o=this.position.slice(),n=0;"isCreateLink"!=this.status&&"changeEdge"!=this.status||(n=30);var s=this.nodes.concat(this.groups);s.forEach((function(s){if(s.dragging)s.anch&&s.anch.hide();else{var a=i.getBoundingRect([s]);a.x=a.x+o[0]-n,a.y=a.y+o[1]-n,a.width=a.width+2*n,a.height=a.height+2*n,a.contain(t,e)?s.anch&&s.anch.show():s.anch&&s.anch.hide()}}))}}},{key:"offEvent",value:function(){this.zr.off()}},{key:"initEvent",value:function(){var t=this;function e(t,e){clearTimeout(t.tId),t.tId=setTimeout((function(){t.call(e)}),300)}window.onresize=function(){e((function(){var e=document.getElementById("flowEditor").offsetWidth,i=document.getElementById("flowEditor").offsetHeight;t.zr.resize({width:e,height:i}),window.console.log(e,i)}))},this.zr.on("selectNode",(function(e){t.selectItem(e.node)})),this.zr.on("clearSelectItems",(function(){t.clearSelectItems()})),this.zr.on("judgeWidthGroup",(function(){t.judgeWidthGroup()})),this.zr.on("viewProGroup",(function(){t.viewProGroup()})),this.zr.on("hideFrame",(function(){t.frame.hide()})),this.zr.on("selectFrame",(function(){t.status="selectFrame"})),this.zr.on("moveGroup",(function(e){var i=e.group;t.execute("moveNode",{dx:l,dy:d},i.getAllItems())})),this.zr.on("refreshEdge",(function(e){var i,o=e.node;i="node"==o.nodeType?t.getEdgesByNode(o):t.getEdgesByGroup(o),i.forEach((function(t){t.fromNode==o?(t.setFromPoint(o.getAnchorByIndex(t.fromAnch.point.index)),t.refresh()):t.toNode==o&&(t.setToPoint(o.getAnchorByIndex(t.toAnch.point.index)),t.refresh())}))})),this.zr.on("moveNode",(function(e){var i=e.node,o=t.getSelectNodes();i&&-1==o.indexOf(i)&&(o=o.concat([i])),t.execute("moveNode",{dx:l,dy:d},o)})),this.zr.on("removeNodeFromGroup",(function(e){t.execute("removeNodeFromGroup",{node:e.node})})),this.zr.on("addNodeToGroup",(function(e){t.execute("addNodeToGroup",e)})),this.zr.on("resizeNode",(function(e){t.execute("resizeNode",e)})),this.zr.on("refreshSelectGroup",(function(){t.selectGroups.forEach((function(t){return t.refresh()}))}));var i,o,n,s,a=!1,r=0,h=0,c=!1,l=0,d=0,u=null,f=function(){"selectFrame"==t.status?(t.selectFrame.attr({shape:{width:l,height:d}}),t.multipleSelect()):t.attr({position:[u[0]+l,u[1]+d]})},p=function e(){t.selectFrame.attr({shape:{x:0,y:0,width:0,heigt:0}}),t.status="",t.selectFrame.hide(),document.removeEventListener("mousemove",f),document.removeEventListener("mouseup",e)};this.zr.on("mousedown",(function(e){if(r=e.offsetX,h=e.offsetY,a=!0,u=t.position.slice(),e.target||(t.zr.trigger("clearSelectItems"),"selectFrame"==t.status&&(t.selectFrame.attr({shape:{x:r,y:h}}),t.selectFrame.show()),document.addEventListener("mousemove",f),document.addEventListener("mouseup",p)),e.target){if(e.target.mark&&"anch"==e.target.mark){if(c&&i)return t.remove(i),t.status="",void(c=!1);s=e.target,t.status="isCreateLink",c=!0,i="polyline"===t.curEdgeType?new ki(s.node,null,"","#666","#666","#fff","polyline","solid"):"bs"===t.curEdgeType?new ki(s.node,null,"","#666","#666","#fff","bs","solid"):new ki(s.node,null,"","#666","#666","#fff","line","solid"),i.setFromPoint(Si({},s.point)),i.fromAnch=s,t.add(i)}var l=t.getSelectNodes();l.forEach((function(t){t.oldPos=t.position.slice()})),"node"==e.target.nodeType&&t.multipleSelectEdges(),e.target.edge&&(t.status="changeEdge",o=e.target.edge,n=e.target)}})),this.zr.on("mousemove",(function(e){if(l=e.offsetX-r,d=e.offsetY-h,t.showAnch(e.offsetX,e.offsetY),a){if((c||"changeEdge"==t.status)&&c&&i.move(e.offsetX-u[0],e.offsetY-u[1]),"selectFrame"==t.status)return;if(!c&&e.target&&"node"==e.target.nodeType){if("resizeNode"==t.status||"changeEdge"==t.status)return;t.moveNode(l,d),t.viewProGroup()}if("changeEdge"==t.status&&o&&n){var s=n.oldCenter.x,f=n.oldCenter.y;n.attr({shape:{cx:s+l,cy:f+d}}),"from"==n.edgeType?o.setFromPoint({x:s+l,y:f+d},!0):o.setToPoint({x:s+l,y:f+d})}}})),this.zr.on("mouseup",(function(e){if(e.target&&e.target.mark&&"anch"==e.target.mark){if(c){if(e.target==s)return t.removeEdge(i),void(t.status="");try{i.setToNode(e.target.node),i.setToPoint(Si({},e.target.point)),i.toAnch=e.target,t.execute("addEdge",{edge:i})}catch(e){t.removeEdge(i),i=null,t.status=""}finally{i=null,t.status=""}}if("changeEdge"==t.status){if("from"==n.edgeType)if(o.fromNode){if(o.fromAnch!=e.target){var l=o.fromNode,d=o.fromAnch;t.execute("changeEdge",{edge:o,type:"changeAnch",position:"from",oldNode:l,oldAnch:d,newNode:e.target.node,newAnch:e.target,mark:"anch"})}}else t.execute("changeEdge",{edge:o,type:"changeAnch",position:"from",oldCenter:Si({},n.oldCenter),newCenter:{x:n.shape.cx,y:n.shape.cy},newNode:e.target.node,newAnch:e.target,mark:"point"});else if(o.toNode){if(o.toAnch!=e.target){var u=o.toNode,f=o.toAnch;t.execute("changeEdge",{edge:o,type:"changeAnch",position:"to",oldNode:u,oldAnch:f,newNode:e.target.node,newAnch:e.target,mark:"anch"})}}else t.execute("changeEdge",{edge:o,type:"changeAnch",position:"to",oldCenter:Si({},n.oldCenter),newCenter:{x:n.shape.cx,y:n.shape.cy},newNode:e.target.node,newAnch:e.target,mark:"point"});o.refresh(),t.status="",n=null,o=null}}if("changeEdge"==t.status){if("from"==n.edgeType)if(o.fromNode){var p=o.fromNode,g=o.fromAnch;o.removeFromNode(),t.execute("changeEdge",{edge:o,type:"changeAnch",position:"from",oldNode:p,oldAnch:g,oldCenter:Si({},n.oldCenter),newCenter:{x:n.shape.cx,y:n.shape.cy},mark:"anch"})}else t.execute("changeEdge",{edge:o,type:"changeAnch",position:"from",oldCenter:Si({},n.oldCenter),newCenter:{x:n.shape.cx,y:n.shape.cy},mark:"point"});else if(o.toNode)if(o.toNode){var y=o.toNode,x=o.toAnch;o.removeToNode(),t.execute("changeEdge",{edge:o,type:"changeAnch",position:"to",oldNode:y,oldAnch:x,oldCenter:Si({},n.oldCenter),newCenter:{x:n.shape.cx,y:n.shape.cy},mark:"anch"})}else t.execute("changeEdge",{edge:o,type:"changeAnch",position:"to",oldCenter:Si({},n.oldCenter),newCenter:{x:n.shape.cx,y:n.shape.cy},mark:"point"});t.status="",n=null,o=null}i&&t.remove(i),t.selectFrame.ignore?t.updateNodeAnch():t.zr.trigger("selectNodes"),c=!1,a=!1,r=0,h=0}))}}]),e}(R.a.Group),Ci=Ei,zi=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"div-editable",attrs:{contenteditable:"true"},domProps:{innerHTML:t._s(t.innerText)},on:{input:t.changeText,focus:function(e){t.isChange=!1},blur:t.blurFunc}})},Ni=[],Gi={name:"Edit",props:{value:{type:String,default:""}},data:function(){return{innerText:this.value,isChange:!0}},watch:{value:function(t){this.isChange&&(this.innerText=t)}},methods:{changeText:function(){this.$emit("input",this.$el.innerHTML)},blurFunc:function(){this.isChange=!0,this.$emit("blurFunc")}}},Ai=Gi,Fi=Object(w["a"])(Ai,zi,Ni,!1,null,null,null),_i=Fi.exports,Ii=(i("4ec9"),function t(e,i){Object(G["a"])(this,t),this.node_id=e||this.nodeCount++,this.name=i||"",this.child_nodes=[]});Object(N["a"])(Ii,"nodeCount",0);var Bi=Ii,$i=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"1";Object(G["a"])(this,t),this.graphId=(new Date).getTime(),this.graphType=e,this.nodes=null,this.tempNodeList=[],this.tempEdgeList=[]}return Object(A["a"])(t,[{key:"getNodeById",value:function(t){var e=null;function i(o){if(o)if(o.node_id!==t){if(o.child_nodes&&o.child_nodes.length)for(var n=0;n<o.child_nodes.length;n++)i(o.child_nodes[n])}else e=o}return this.tempNodeList.forEach((function(t){i(t)})),e}},{key:"init",value:function(t,e){var i=this;t.forEach((function(t){var e=t.id,o=t.data&&t.data.style&&t.data.style.text,n=new Bi(e,o);i.tempNodeList.push(n)})),this.tempEdgeList=e,console.log("tmp",this.tempNodeList,this.tempEdgeList)}},{key:"createTree",value:function(){if(this.tempNodeList.length>1)for(var t=0;t<this.tempEdgeList.length;t++){var e=this.tempEdgeList[t],i=e.fromNode.id,o=e.toNode.id,n=this.getNodeById(i),s=this.getNodeById(o);n.child_nodes.push(s)}return console.log("calc",this.tempNodeList),this.getRoot()}},{key:"getRoot",value:function(){var t=this,e=0,i=null;return this.tempNodeList.forEach((function(o){var n=t.getLength(o);n>e&&(e=n,i=o)})),console.log("res",i),i}},{key:"getLength",value:function(t){var e=0;function i(t){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Map;if(t){if(n.has(t))return e=Math.max(e,o),void console.log("成环");if(n.set(t,t),!t.child_nodes||t.child_nodes.length){if(t.child_nodes&&t.child_nodes.length)for(var s=0;s<t.child_nodes.length;s++)i(t.child_nodes[s],o+1,n)}else e=Math.max(e,o)}}return i(t),e}}]),t}(),Ri=$i,Li=(i("4d63"),i("466d"),function(){var t=navigator.userAgent.toLowerCase(),e=window.opera,i={ie:/(msie\s|trident.*rv:)([\w.]+)/.test(t),opera:!!e&&e.version,webkit:t.indexOf(" applewebkit/")>-1,mac:t.indexOf("macintosh")>-1,quirks:"BackCompat"==document.compatMode};i.gecko="Gecko"==navigator.product&&!i.webkit&&!i.opera&&!i.ie;var o=0;if(i.ie){var n=t.match(/(?:msie\s([\w.]+))/),s=t.match(/(?:trident.*rv:([\w.]+))/);o=n&&s&&n[1]&&s[1]?Math.max(1*n[1],1*s[1]):n&&n[1]?1*n[1]:s&&s[1]?1*s[1]:0,i.ie11Compat=11==document.documentMode,i.ie9Compat=9==document.documentMode,i.ie8=!!document.documentMode,i.ie8Compat=8==document.documentMode,i.ie7Compat=7==o&&!document.documentMode||7==document.documentMode,i.ie6Compat=o<7||i.quirks,i.ie9above=o>8,i.ie9below=o<9}return/chrome\/(\d+\.\d)/i.test(t)&&(i.chrome=+RegExp["$1"]),/(\d+\.\d)?(?:\.\d)?\s+safari\/?(\d+\.\d+)?/i.test(t)&&!/chrome/i.test(t)&&(i.safari=+(RegExp["$1"]||RegExp["$2"])),i.opera&&(o=parseFloat(e.version())),i.webkit&&(o=parseFloat(t.match(/ applewebkit\/(\d+)/)[1])),i.version=o,i.isCompatible=!i.mobile&&(i.ie&&o>=6||i.gecko&&o>=10801||i.opera&&o>=9.5||i.air&&o>=1||i.webkit&&o>=522||!1),i}),Wi=Li,Mi=function(){function t(t){for(var e in t)t[e.toUpperCase()]=t[e];return t}var e=function(t){for(var e=arguments,i=1;i<e.length;i++){var o=e[i];for(var n in o)t.hasOwnProperty(n)||(t[n]=o[n])}return t},i=t({isindex:1,fieldset:1}),o=t({input:1,button:1,select:1,textarea:1,label:1}),n=e(t({a:1}),o),s=e({iframe:1},n),a=t({hr:1,ul:1,menu:1,div:1,blockquote:1,noscript:1,table:1,center:1,address:1,dir:1,pre:1,h5:1,dl:1,h4:1,noframes:1,h6:1,ol:1,h1:1,h3:1,h2:1}),r=t({ins:1,del:1,script:1,style:1}),h=e(t({b:1,acronym:1,bdo:1,var:1,"#":1,abbr:1,code:1,br:1,i:1,cite:1,kbd:1,u:1,strike:1,s:1,tt:1,strong:1,q:1,samp:1,em:1,dfn:1,span:1}),r),c=e(t({sub:1,img:1,embed:1,object:1,sup:1,basefont:1,map:1,applet:1,font:1,big:1,small:1}),h),l=e(t({p:1}),c),d=e(t({iframe:1}),c,o),u=t({img:1,embed:1,noscript:1,br:1,kbd:1,center:1,button:1,basefont:1,h5:1,h4:1,samp:1,h6:1,ol:1,h1:1,h3:1,h2:1,form:1,font:1,"#":1,select:1,menu:1,ins:1,abbr:1,label:1,code:1,table:1,script:1,cite:1,input:1,iframe:1,strong:1,textarea:1,noframes:1,big:1,small:1,span:1,hr:1,sub:1,bdo:1,var:1,div:1,object:1,sup:1,strike:1,dir:1,map:1,dl:1,applet:1,del:1,isindex:1,fieldset:1,ul:1,b:1,acronym:1,a:1,blockquote:1,i:1,u:1,s:1,tt:1,address:1,q:1,pre:1,p:1,em:1,dfn:1}),f=e(t({a:0}),d),p=t({tr:1}),g=t({"#":1}),y=e(t({param:1}),u),x=e(t({form:1}),i,s,a,l),v=t({li:1,ol:1,ul:1}),m=t({style:1,script:1}),w=t({base:1,link:1,meta:1,title:1}),b=e(w,m),k=t({head:1,body:1}),O=t({html:1}),T=t({address:1,blockquote:1,center:1,dir:1,div:1,dl:1,fieldset:1,form:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,hr:1,isindex:1,menu:1,noframes:1,ol:1,p:1,pre:1,table:1,ul:1}),D=t({area:1,base:1,basefont:1,br:1,col:1,command:1,dialog:1,embed:1,hr:1,img:1,input:1,isindex:1,keygen:1,link:1,meta:1,param:1,source:1,track:1,wbr:1});return t({$nonBodyContent:e(O,k,w),$block:T,$inline:f,$inlineWithA:e(t({a:1}),f),$body:e(t({script:1,style:1}),T),$cdata:t({script:1,style:1}),$empty:D,$nonChild:t({iframe:1,textarea:1}),$listItem:t({dd:1,dt:1,li:1}),$list:t({ul:1,ol:1,dl:1}),$isNotEmpty:t({table:1,ul:1,ol:1,dl:1,iframe:1,area:1,base:1,col:1,hr:1,img:1,embed:1,input:1,link:1,meta:1,param:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1}),$removeEmpty:t({a:1,abbr:1,acronym:1,address:1,b:1,bdo:1,big:1,cite:1,code:1,del:1,dfn:1,em:1,font:1,i:1,ins:1,label:1,kbd:1,q:1,s:1,samp:1,small:1,span:1,strike:1,strong:1,sub:1,sup:1,tt:1,u:1,var:1}),$removeEmptyBlock:t({p:1,div:1}),$tableContent:t({caption:1,col:1,colgroup:1,tbody:1,td:1,tfoot:1,th:1,thead:1,tr:1,table:1}),$notTransContent:t({pre:1,script:1,style:1,textarea:1}),html:k,head:b,style:g,script:g,body:x,base:{},link:{},meta:{},title:g,col:{},tr:t({td:1,th:1}),img:{},embed:{},colgroup:t({thead:1,col:1,tbody:1,tr:1,tfoot:1}),noscript:x,td:x,br:{},th:x,center:x,kbd:f,button:e(l,a),basefont:{},h5:f,h4:f,samp:f,h6:f,ol:v,h1:f,h3:f,option:g,h2:f,form:e(i,s,a,l),select:t({optgroup:1,option:1}),font:f,ins:f,menu:v,abbr:f,label:f,table:t({thead:1,col:1,tbody:1,tr:1,colgroup:1,caption:1,tfoot:1}),code:f,tfoot:p,cite:f,li:x,input:{},iframe:x,strong:f,textarea:g,noframes:x,big:f,small:f,span:t({"#":1,br:1,b:1,strong:1,u:1,i:1,em:1,sub:1,sup:1,strike:1,span:1}),hr:f,dt:f,sub:f,optgroup:t({option:1}),param:{},bdo:f,var:f,div:x,object:y,sup:f,dd:x,strike:f,area:{},dir:v,map:e(t({area:1,form:1,p:1}),i,r,a),applet:y,dl:t({dt:1,dd:1}),del:f,isindex:{},fieldset:e(t({legend:1}),u),thead:p,ul:v,acronym:f,b:f,a:e(t({a:1}),d),blockquote:e(t({td:1,tr:1,tbody:1,li:1}),x),caption:f,i:f,u:f,tbody:p,s:f,address:e(s,l),tt:f,legend:f,q:f,pre:e(h,n),p:e(t({a:1}),f),em:f,dfn:f})},Hi=Mi;function qi(t){return t?t.replace(/&((g|l|quo)t|amp|#39);/g,(function(t){return{"&lt;":"<","&amp;":"&","&quot;":'"',"&gt;":">","&#39;":"'"}[t]})):""}var Ui=Wi().ie&&"6"==Wi().version?"\ufeff":"​",Ji=function(t){var e=new RegExp(Ui,"g"),i=t.replace(/[\n\r]/g,"");return i=i.replace(/<(p|div)[^>]*>(<br\/?>|&nbsp;)<\/\1>/gi,"\n").replace(/<br\/?>/gi,"\n").replace(/<[^>/]+>/g,"").replace(/(\n)?<\/([^>]+)>/g,(function(t,e,i){return Hi().$block[i]?"\n":e||""})),qi(i.replace(e,"").replace(/\u00a0/g," ").replace(/&nbsp;/g," "))},Yi=Ji,Xi={name:"Editor",components:{Edit:_i},data:function(){return{left:0,top:0,width:0,height:0,text:"",plainTxt:"",editModel:!1,icon:[],colors:"#194d33",show:!1,edge:null}},mounted:function(){var t=this,e=this;function i(t,e){var i=document.createElement("a"),o=new Blob([t]),n=window.URL.createObjectURL(o);i.href=n,i.download=e,i.click(),window.URL.revokeObjectURL(n)}function o(t){if(window.getSelection){t.focus();var e=window.getSelection();e.selectAllChildren(t),e.collapseToEnd()}else if(document.selection){var i=document.selection.createRange();i.moveToElementText(t),i.collapse(!1),i.select()}}this.editor=new Ci("flowEditor"),x.$on("leftAlign",(function(){t.editor.leftAlign()})),x.$on("rightAlign",(function(){t.editor.rightAlign()})),x.$on("horizontalAlign",(function(){t.editor.horizontalAlign()})),x.$on("verticalAlign",(function(){t.editor.verticalAlign()})),x.$on("createGroup",(function(){t.editor.createGroup()})),x.$on("redo",(function(){t.editor.redo()})),x.$on("undo",(function(){t.editor.undo()})),x.$on("initFlow",(function(e){try{t.editor.clearHistory(),t.editor.refreshHistory(),t.editor.init(e.data),x.$emit("refreshMap",{editor:t.editor})}catch(e){window.console.log(e),alert("不支持的数据")}})),x.$on("copy",(function(){t.editStatus||("selectNode"==t.status||"selectNodes"==t.status?t.editor.copy("node",t.editor.getSelectNodes()):"selectGroup"==t.status&&t.editor.copy("group",t.group))})),x.$on("delete",(function(){"selectNode"==t.status?t.editor.execute("deleteNode",{node:t.node}):"selectNodes"==t.status?t.editor.execute("deleteNodes",{nodes:t.nodes}):"selectGroup"==t.status?t.editor.execute("deleteGroup",{group:t.group}):"selectEdge"==t.status&&t.editor.execute("deleteEdge",{edge:t.edge})})),x.$on("saveData",(function(e){var o=null,n=null;switch(e.type){case"json":var s=JSON.stringify(t.editor.getData());i(s,"flowchart.json");break;case"png":o=t.editor.getBoundingRect(t.editor.nodes.concat(t.editor.groups).concat(t.editor.edges)),document.getElementById("download-canvas").style.width=o.width+"px",document.getElementById("download-canvas").style.height=o.height+"px",n=new Ci("download-canvas"),n.init(JSON.parse(JSON.stringify(t.editor.getData())),!0),n.attr({position:[-parseInt(o.x),-parseInt(o.y)]});try{n.zr.painter.getRenderedCanvas({backgroundColor:"transparent"}).toBlob((function(t){var e=window.URL.createObjectURL(t);window.console.log(e),window.open(e)}),"image/png")}catch(e){document.getElementById("download-win").style.display="block"}break;case"jpg":o=t.editor.getBoundingRect(t.editor.nodes.concat(t.editor.groups).concat(t.editor.edges)),document.getElementById("download-canvas").style.width=o.width+"px",document.getElementById("download-canvas").style.height=o.height+"px",n=new Ci("download-canvas"),n.init(JSON.parse(JSON.stringify(t.editor.getData())),!0),n.attr({position:[-o.x,-o.y]});try{n.zr.painter.getRenderedCanvas({backgroundColor:"#fff"}).toBlob((function(t){var e=window.URL.createObjectURL(t);window.open(e)}),"image/jpeg")}catch(e){document.getElementById("download-win").style.display="block"}break;case"local":localStorage.setItem("tempFile",JSON.stringify(t.editor.getData())),z["a"].success("保存成功");break;case"case":var a=new Ri;a.init(t.editor.nodes,t.editor.edges);var r=a.createTree(),h=new XMLHttpRequest;h.onreadystatechange=function(){4===h.readyState&&h.status},h.open("PUT","http://150.158.157.62:3000/rest/pc/testcase"),h.send([JSON.stringify({nodes:r,graphType:a.graphType,testcase_id:a.graphId})]);break}})),x.$on("changeNode",(function(e){var i=e.nodes||t.editor.getSelectNodes();t.editor.execute("changeNode",e,i)})),x.$on("align",(function(e){t.editor[e.align]&&t.editor[e.align]()})),x.$on("changeGroup",(function(e){t.editor.execute("changeGroup",e)})),x.$on("changeEdge",(function(e){t.editor.execute("changeEdge",e)})),x.$on("ungroup",(function(){t.editStatus||"selectGroup"==t.status&&t.editor.execute("ungroup",{group:t.group})})),x.$on("selectFrame",(function(){t.editor.emit("selectFrame")})),x.$on("shadow",(function(e){var i=e.shadow;i?t.editor.setShadow():t.editor.cancelShadow()})),x.$on("changeCurLineType",(function(e){t.editor.curEdgeType=e})),this.editor.listen("selectNode",(function(t){e.status="selectNode",e.node=t.node,x.$emit("selectNode",{node:t.node})})),this.editor.listen("selectNodes",(function(i){if(i&&i.nodes.length>1)e.status="selectNodes",e.nodes=i.nodes,x.$emit("selectNodes",{nodes:i.nodes});else{var o=t.editor.getSelectNodes();1==o.length?(e.status="selectNode",e.node=o[0],x.$emit("selectNode",{node:o[0]})):o.length>1&&(e.status="selectNodes",e.nodes=o,x.$emit("selectNodes",{nodes:o}))}})),this.editor.listen("selectGroup",(function(t){e.status="selectGroup",e.group=t.group,x.$emit("selectGroup",t)})),this.editor.listen("selectEdge",(function(i){e.status="selectEdge",t.editor.status="selectEdge",e.edge=i.edge,x.$emit("selectEdge",i)})),this.editor.listen("undoredo",(function(e){x.$emit("undoredo",e),x.$emit("refreshMap",{editor:t.editor})})),this.editor.listen("clearSelectItems",(function(){x.$emit("clearSelect")})),this.editor.listen("edit",(function(i){e.editStatus=i.status;var n=new R.a.Group,s=null,a=i.text,r=null;switch(e.editModel=!0,i.status){case"editNode":e.node=i.node,s=n.getBoundingRect([t.node]),e.left=s.x+t.editor.position[0],e.top=s.y+t.editor.position[1],e.width=s.width,e.height=s.height,e.text=e.domText(a),a="";break;case"editGroup":e.editGroup=i.group,s=n.getBoundingRect([e.group.groupHead]),r=n.getBoundingRect([e.group]),e.left=r.x+t.editor.position[0],e.top=r.y+t.editor.position[1],e.width=s.width,e.height=s.height,e.text=e.domText(a),a="";break;case"editEdge":e.edge=i.edge;var h=i.edge.getData();if(h.text)s=n.getBoundingRect([i.edge.relateText]),e.left=s.x+t.editor.position[0],e.top=s.y+t.editor.position[1],e.width=s.width,e.height=s.height,e.text=e.domText(h.text);else{var c=h.cpx;e.left=c.x1+t.editor.position[0],e.top=c.y1+t.editor.position[1],e.width=80,e.height=20}break}e.$nextTick((function(){o(e.$refs["edit"].$el)}))})),x.$emit("initFlow",{data:JSON.parse(localStorage.getItem("tempFile"))})},methods:{dragover:function(t){t.preventDefault()},dragstart:function(t){t.preventDefault()},drop:function(t){var e=t.dataTransfer.getData("addShape"),i=parseInt(t.offsetX)+.5,o=parseInt(t.offsetY)+.5;try{var n=JSON.parse(e);n["x"]=i,n["y"]=o,this.editor.addShape(n)}catch(s){}},trim:function(t){return t.replace(/^\s+|\s+$/gm,"")},updateText:function(){var t=Yi(this.text);this.plainTxt=this.trim(t),"editNode"==this.editStatus&&x.$emit("changeNode",{style:{text:this.trim(t)},nodes:[this.node]}),"editGroup"==this.editStatus&&x.$emit("changeGroup",{mark:"head",style:{text:this.trim(t)},group:this.editGroup}),"editEdge"==this.editStatus&&x.$emit("changeEdge",{mark:"text",style:{text:this.trim(t)},edge:this.edge}),this.editModel=!1,this.editStatus="",this.text="",this.plainTxt=""},domText:function(t){var e=[],i=t.split("\n");return i.forEach((function(t){e.push("<div>"+t+"</div>")})),e.join("")},closeDownLoadWin:function(){document.getElementById("download-win").style.display="none"}}},Qi=Xi,Zi=(i("b2c8"),Object(w["a"])(Qi,E,C,!1,null,"c659085e",null)),Ki=Zi.exports,Vi=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"property"},[i("v-canvas",{directives:[{name:"show",rawName:"v-show",value:t.showCanvas,expression:"showCanvas"}]}),i("Node",{directives:[{name:"show",rawName:"v-show",value:t.showNode,expression:"showNode"}]}),i("Group",{directives:[{name:"show",rawName:"v-show",value:t.showGroup,expression:"showGroup"}]}),i("Edge",{directives:[{name:"show",rawName:"v-show",value:t.showEdge,expression:"showEdge"}]})],1)},to=[],eo=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"node",on:{click:function(e){return t.hideWin(e)}}},[i("div",{staticClass:"node-header"},[t._v(" "+t._s(t.text)+" ")]),i("div",{staticClass:"section-group clearfix"},[i("h3",[t._v(t._s(t.$t("node.head")))]),i("p",[i("span",[t._v(t._s(t.$t("node.fill")))]),i("span",{staticClass:"color-picker",style:{background:t.nodeData.style.fill},on:{click:function(e){return e.stopPropagation(),t.showColorPicker("fill")}}}),i("Sketch-picker",{directives:[{name:"show",rawName:"v-show",value:t.nodeData.fillshow,expression:"nodeData.fillshow"}],on:{input:t.updateFill},model:{value:t.nodeData.style.fill,callback:function(e){t.$set(t.nodeData.style,"fill",e)},expression:"nodeData.style.fill"}})],1),i("p",[i("span",[t._v(t._s(t.$t("node.stroke")))]),i("span",{staticClass:"color-picker",style:{background:t.nodeData.style.stroke},on:{click:function(e){return e.stopPropagation(),t.showColorPicker("stroke")}}}),i("Sketch-picker",{directives:[{name:"show",rawName:"v-show",value:t.nodeData.strokeshow,expression:"nodeData.strokeshow"}],on:{input:t.updateStroke},model:{value:t.nodeData.style.stroke,callback:function(e){t.$set(t.nodeData.style,"stroke",e)},expression:"nodeData.style.stroke"}})],1)]),i("div",{staticClass:"section-group clearfix"},[i("h3",[t._v(t._s(t.$t("node.font")))]),i("p",[i("span",[t._v(t._s(t.$t("node.fontSize")))]),i("span",{staticClass:"font-size right color-picker",on:{click:function(e){return e.stopPropagation(),t.showColorPicker("fontsize")}}},[t._v(t._s(t.nodeData.style.fontSize))]),i("ul",{directives:[{name:"show",rawName:"v-show",value:t.nodeData.fontsizeshow,expression:"nodeData.fontsizeshow"}],staticClass:"font-size-select"},t._l(t.fontsize,(function(e){return i("li",{key:e,on:{click:function(i){return t.pickFontSize(e)}}},[t._v(t._s(e))])})),0)]),i("p",[i("span",[t._v(t._s(t.$t("node.textFill")))]),i("span",{staticClass:"color-picker",style:{background:t.nodeData.style.textFill},on:{click:function(e){return e.stopPropagation(),t.showColorPicker("textFill")}}}),i("Sketch-picker",{directives:[{name:"show",rawName:"v-show",value:t.nodeData.textfillshow,expression:"nodeData.textfillshow"}],on:{input:t.updateTextFill},model:{value:t.nodeData.style.textFill,callback:function(e){t.$set(t.nodeData.style,"textFill",e)},expression:"nodeData.style.textFill"}})],1),i("p",[i("span",{staticClass:"left"},[t._v(t._s(t.$t("node.fontStyle")))]),i("span",{class:"textPos right iconfont icon-qingxie"+("italic"==t.nodeData.style.fontStyle?" active":""),on:{click:function(e){return t.setStyle(e)}}}),i("span",{class:"textPos right iconfont icon-jiacu"+("bold"==t.nodeData.style.fontWeight?" active":""),on:{click:function(e){return t.setBold(e)}}})]),i("p",[i("span",{staticClass:"left"},[t._v(t._s(t.$t("node.position")))]),i("span",{class:"textPos right iconfont icon-you"+("left"==t.nodeData.style.textPosition?" active":""),staticStyle:{transform:"rotate(180deg)"},on:{click:function(e){return t.setTextPos(e,"left")}}}),i("span",{class:"textPos right iconfont icon-arrow-down-last"+("bottom"==t.nodeData.style.textPosition?" active":""),on:{click:function(e){return t.setTextPos(e,"bottom")}}}),i("span",{class:"textPos right iconfont icon-you"+("right"==t.nodeData.style.textPosition?" active":""),on:{click:function(e){return t.setTextPos(e,"right")}}}),i("span",{class:"textPos right iconfont icon-arrow-down-last"+("top"==t.nodeData.style.textPosition?" active":""),staticStyle:{transform:"rotate(180deg)"},on:{click:function(e){return t.setTextPos(e,"top")}}}),i("span",{class:"textPos right iconfont icon-juzhong"+("inside"==t.nodeData.style.textPosition?" active":""),on:{click:function(e){return t.setTextPos(e,"inside")}}})])]),t.multipleSelect?i("div",{staticClass:"section-group clearfix"},[i("h3",[t._v(t._s(t.$t("node.nodeAlign")))]),i("ul",[i("li",{staticClass:"iconfont icon-halign",on:{click:function(e){return t.align("horizontalAlign")}}}),i("li",{staticClass:"iconfont icon-juzhongduiqi",on:{click:function(e){return t.align("verticalAlign")}}}),i("li",{staticClass:"iconfont icon-align-left",on:{click:function(e){return t.align("leftAlign")}}}),i("li",{staticClass:"iconfont icon-youduiqi",on:{click:function(e){return t.align("rightAlign")}}})])]):t._e(),i("div",{staticClass:"section-group clearfix"},[i("h3",[t._v(t._s(t.$t("node.prefabrication")))]),i("ul",{staticClass:"theme"},t._l(t.preStyle,(function(e,o){return i("li",{key:o,staticClass:"theme-item",style:{background:e.fill,"border-color":e.stroke},on:{click:function(i){return t.changeNodeStyle(e)}}})})),0)])])},io=[],oo=i("c345"),no={node:[{fill:"rgb(231,253,250)",stroke:"rgb(149, 231, 226)",textFill:"#333"},{fill:"#e7f7fe",stroke:"#b2defe",textFill:"#333"},{fill:"#fef7e7",stroke:"#fedcab",textFill:"#333"},{fill:"#f8f0fe",stroke:"#d7bdf4",textFill:"#333"},{fill:"rgb(255, 218, 218)",stroke:"rgb(247, 155, 155)",textFill:"#333"},{fill:"#fbfbca",stroke:"#f7f71c",textFill:"#333"},{fill:"#7EA6E0",stroke:"#333",textFill:"#333"},{fill:"#FFCE9F",stroke:"#333",textFill:"#333"},{fill:"#A9C4EB",stroke:"#333",textFill:"#333"},{fill:"#DFEFCA",stroke:"#333",textFill:"#333"},{fill:"#D1F5FF",stroke:"#333",textFill:"#333"},{fill:"#D4AEF9",stroke:"#333",textFill:"#333"},{fill:"#80beaf",stroke:"#333",textFill:"#333"},{fill:"#b3ddd1",stroke:"#333",textFill:"#333"},{fill:"#d1dce2",stroke:"#333",textFill:"#333"},{fill:"#f58994",stroke:"#333",textFill:"#333"},{fill:"#ee9c6c",stroke:"#333",textFill:"#333"},{fill:"#86e3ce",stroke:"#333",textFill:"#333"},{fill:"#d0e6a5",stroke:"#333",textFill:"#333"},{fill:"#ffdd94",stroke:"#333",textFill:"#333"},{fill:"#fa897b",stroke:"#333",textFill:"#333"},{fill:"#ccabd8",stroke:"#333",textFill:"#333"},{fill:"#60efdb",stroke:"#333",textFill:"#333"},{fill:"#bef2e5",stroke:"#333",textFill:"#333"},{fill:"#c5e7f1",stroke:"#333",textFill:"#333"},{fill:"#79ceed",stroke:"#333",textFill:"#333"},{fill:"#6f89a2",stroke:"#333",textFill:"#333"},{fill:"#dea3dc",stroke:"#333",textFill:"#333"},{fill:"#f7db70",stroke:"#333",textFill:"#333"},{fill:"#eabebf",stroke:"#333",textFill:"#333"},{fill:"#75cce8",stroke:"#333",textFill:"#333"},{fill:"#a5dee5",stroke:"#333",textFill:"#333"},{fill:"#5d7599",stroke:"#333",textFill:"#333"},{fill:"#abb6c8",stroke:"#333",textFill:"#333"},{fill:"#dadada",stroke:"#333",textFill:"#333"},{fill:"#f7f0c6",stroke:"#333",textFill:"#333"},{fill:"#c2c4b6",stroke:"#333",textFill:"#333"},{fill:"#478ba2",stroke:"#333",textFill:"#333"},{fill:"#de5b6d",stroke:"#333",textFill:"#333"},{fill:"#e9765b",stroke:"#333",textFill:"#333"},{fill:"#f2a490",stroke:"#333",textFill:"#333"},{fill:"#b9d4db",stroke:"#333",textFill:"#333"}],group:[{headStyle:{fill:"#F1ECAA",stroke:"#333",textFill:"#333",textPosition:"insideLeft",fontSize:14,fontStyle:"normal",fontWeight:"normal"},groupStyle:{fill:"#F0BABA",stroke:"#333"}},{headStyle:{fill:"#FD9973",stroke:"#333",textFill:"#333",textPosition:"insideLeft",fontSize:14,fontStyle:"normal",fontWeight:"normal"},groupStyle:{fill:"#5AC39D",stroke:"#333"}},{headStyle:{fill:"#5AB978",stroke:"#333",textFill:"#333",textPosition:"insideLeft",fontSize:14,fontStyle:"normal",fontWeight:"normal"},groupStyle:{fill:"#DD727F",stroke:"#333"}}]},so=no;function ao(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,o)}return i}function ro(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?ao(Object(i),!0).forEach((function(e){Object(N["a"])(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):ao(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}var ho={name:"Node",components:{"Sketch-picker":oo["Sketch"]},data:function(){return{text:"Single Node",multipleSelect:!1,fontsize:[8,10,12,14,16,18,20,24,28,32,36,40],nodeData:{fillshow:!1,strokeshow:!1,textfillshow:!1,fontsizeshow:!1,style:{fill:"#fff",stroke:"transparent",textFill:"transparent",text:"",lineWidth:1,opacity:1,fontSize:12,fontWeight:"normal",fontStyle:"italic",textPosition:"inside"},shape:{},z:10},preStyle:so.node}},mounted:function(){var t=this;x.$on("selectNode",(function(e){t.text="Single Node",t.multipleSelect=!1,t.node=e.node;var i=t.node.getData();t.nodeData=ro({},t.nodeData,{},i)})),x.$on("selectNodes",(function(e){t.text="Multiple Node",t.multipleSelect=!0,t.nodes=e.nodes})),x.$on("changeLanguage",(function(t){c(t.language)})),this.language=localStorage.getItem("localeLanguage")||"zh",c(this.language)},methods:{align:function(t){x.$emit("align",{align:t})},showColorPicker:function(t){switch(t){case"fill":this.nodeData.strokeshow=!1,this.nodeData.textfillshow=!1,this.nodeData.fontsizeshow=!1,this.nodeData.fillshow?this.nodeData.fillshow=!1:this.nodeData.fillshow=!0;break;case"stroke":this.nodeData.fillshow=!1,this.nodeData.textfillshow=!1,this.nodeData.fontsizeshow=!1,this.nodeData.strokeshow?this.nodeData.strokeshow=!1:this.nodeData.strokeshow=!0;break;case"textFill":this.nodeData.fillshow=!1,this.nodeData.strokeshow=!1,this.nodeData.fontsizeshow=!1,this.nodeData.textfillshow?this.nodeData.textfillshow=!1:this.nodeData.textfillshow=!0;break;case"fontsize":this.nodeData.fillshow=!1,this.nodeData.strokeshow=!1,this.nodeData.textfillshow=!1,this.nodeData.fontsizeshow?this.nodeData.fontsizeshow=!1:this.nodeData.fontsizeshow=!0;break}},updateFill:function(t){var e=t.rgba,i="rgba(".concat(e.r,",").concat(e.g,",").concat(e.b,",").concat(e.a,")");this.nodeData.style.fill=i,x.$emit("changeNode",{style:{fill:i}})},updateStroke:function(t){var e=t.rgba,i="rgb(".concat(e.r,",").concat(e.g,",").concat(e.b,")");this.nodeData.style.stroke=i,x.$emit("changeNode",{style:{stroke:i}})},updateTextFill:function(t){var e=t.rgba,i="rgb(".concat(e.r,",").concat(e.g,",").concat(e.b,")");this.nodeData.style.textFill=i,x.$emit("changeNode",{style:{textFill:i}})},setStyle:function(){"italic"==this.nodeData.style.fontStyle?(this.nodeData.style.fontStyle="",x.$emit("changeNode",{style:{fontStyle:""}})):(this.nodeData.style.fontStyle="italic",x.$emit("changeNode",{style:{fontStyle:"italic"}}))},setBold:function(){"bold"==this.nodeData.style.fontWeight?(this.nodeData.style.fontWeight="",x.$emit("changeNode",{style:{fontWeight:""}})):(this.nodeData.style.fontWeight="bold",x.$emit("changeNode",{style:{fontWeight:"bold"}}))},pickFontSize:function(t){this.nodeData.style.fontSize!=t&&(this.nodeData.style.fontSize=t,x.$emit("changeNode",{style:{fontSize:t}}))},setTextPos:function(t,e){this.nodeData.style.textPosition!=e&&(this.nodeData.style.textPosition=e,x.$emit("changeNode",{style:{textPosition:e}}))},changeNodeStyle:function(t){this.nodeData.style.fill=t.fill,this.nodeData.style.stroke=t.stroke,this.nodeData.style.fontSize=t.fontSize;var e=ro({},{},{},t);x.$emit("changeNode",{style:e,z:this.nodeData.z})},hideColorPicker:function(){this.nodeData.fillshow=!1,this.nodeData.strokeshow=!1,this.nodeData.textfillshow=!1,this.nodeData.fontsizeshow=!1},hideWin:function(t){var e=t.target,i=!1;while(e){if(1==e.nodeType&&e&&e.className&&e.className.indexOf("vc-sketch")>-1){i=!0;break}e=e.parentElement}i||this.hideColorPicker()}}},co=ho,lo=(i("8dc2"),Object(w["a"])(co,eo,io,!1,null,"1af651cb",null)),uo=lo.exports,fo=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"group",on:{click:t.hideWin}},[i("div",{staticClass:"node-header"},[t._v(" "+t._s(t.text)+" ")]),i("div",{staticClass:"section-group clearfix"},[i("h3",[t._v(t._s(t.$t("group.head")))]),i("p",[i("span",[t._v(t._s(t.$t("group.fill")))]),i("span",{staticClass:"color-picker",style:{background:t.groupData.groupFill},on:{click:function(e){return e.stopPropagation(),t.showColorPicker("groupfill")}}}),i("Sketch-picker",{directives:[{name:"show",rawName:"v-show",value:t.groupData.groupfillshow,expression:"groupData.groupfillshow"}],on:{input:t.updateFill},model:{value:t.groupData.groupFill,callback:function(e){t.$set(t.groupData,"groupFill",e)},expression:"groupData.groupFill"}})],1),i("p",[i("span",[t._v(t._s(t.$t("group.stroke")))]),i("span",{staticClass:"color-picker",style:{background:t.groupData.stroke},on:{click:function(e){return e.stopPropagation(),t.showColorPicker("stroke")}}}),i("Sketch-picker",{directives:[{name:"show",rawName:"v-show",value:t.groupData.strokeshow,expression:"groupData.strokeshow"}],on:{input:t.updateStroke},model:{value:t.groupData.stroke,callback:function(e){t.$set(t.groupData,"stroke",e)},expression:"groupData.stroke"}})],1),i("p",{staticStyle:{"line-height":"20px","margin-top":"6px"}},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.groupData.showHead,expression:"groupData.showHead"}],staticClass:"magic-checkbox",attrs:{type:"checkbox",id:"showhead",name:"checkbox"},domProps:{checked:Array.isArray(t.groupData.showHead)?t._i(t.groupData.showHead,null)>-1:t.groupData.showHead},on:{change:function(e){var i=t.groupData.showHead,o=e.target,n=!!o.checked;if(Array.isArray(i)){var s=null,a=t._i(i,s);o.checked?a<0&&t.$set(t.groupData,"showHead",i.concat([s])):a>-1&&t.$set(t.groupData,"showHead",i.slice(0,a).concat(i.slice(a+1)))}else t.$set(t.groupData,"showHead",n)}}}),i("label",{attrs:{for:"showhead"}},[t._v(t._s(t.$t("group.showHead")))])])]),i("div",{staticClass:"section-group clearfix"},[i("h3",[t._v(t._s(t.$t("group.font")))]),i("p",[i("span",[t._v(t._s(t.$t("group.fontSize")))]),i("span",{staticClass:"font-size right color-picker",on:{click:function(e){return e.stopPropagation(),t.showColorPicker("fontsize")}}},[t._v(t._s(t.groupData.fontSize))]),i("ul",{directives:[{name:"show",rawName:"v-show",value:t.groupData.fontsizeshow,expression:"groupData.fontsizeshow"}],staticClass:"font-size-select"},t._l(t.fontsize,(function(e){return i("li",{key:e,on:{click:function(i){return t.pickFontSize(e)}}},[t._v(t._s(e))])})),0)]),i("p",[i("span",[t._v(t._s(t.$t("group.textFill")))]),i("span",{staticClass:"color-picker",style:{background:t.groupData.textFill},on:{click:function(e){return e.stopPropagation(),t.showColorPicker("textfill")}}}),i("Sketch-picker",{directives:[{name:"show",rawName:"v-show",value:t.groupData.textfillshow,expression:"groupData.textfillshow"}],on:{input:t.updateTextFill},model:{value:t.groupData.textFill,callback:function(e){t.$set(t.groupData,"textFill",e)},expression:"groupData.textFill"}})],1),i("p",[i("span",{staticClass:"left"},[t._v(t._s(t.$t("group.fontStyle")))]),i("span",{class:"textPos right iconfont icon-qingxie"+("italic"==t.groupData.fontStyle?" active":""),on:{click:function(e){return t.setStyle(e)}}}),i("span",{class:"textPos right iconfont icon-jiacu"+("bold"==t.groupData.fontWeight?" active":""),on:{click:function(e){return t.setBold(e)}}})]),i("p",[i("span",[t._v(t._s(t.$t("group.fill")))]),i("span",{staticClass:"color-picker",style:{background:t.groupData.fill},on:{click:function(e){return e.stopPropagation(),t.showColorPicker("fill")}}}),i("Sketch-picker",{directives:[{name:"show",rawName:"v-show",value:t.groupData.fillshow,expression:"groupData.fillshow"}],on:{input:t.updateHeadFill},model:{value:t.groupData.fill,callback:function(e){t.$set(t.groupData,"fill",e)},expression:"groupData.fill"}})],1),i("p",[i("span",{staticClass:"left"},[t._v(t._s(t.$t("group.align")))]),i("span",{class:"textPos right iconfont icon-juyou"+("insideRight"==t.groupData.textPosition?" active":""),on:{click:function(e){return t.setTextPos(e,"insideRight")}}}),i("span",{class:"textPos right iconfont icon-juzhong1"+("inside"==t.groupData.textPosition?" active":""),on:{click:function(e){return t.setTextPos(e,"inside")}}}),i("span",{class:"textPos right iconfont icon-juzuo"+("insideLeft"==t.groupData.textPosition?" active":""),on:{click:function(e){return t.setTextPos(e,"insideLeft")}}})])])])},po=[];function go(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,o)}return i}function yo(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?go(Object(i),!0).forEach((function(e){Object(N["a"])(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):go(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}var xo={name:"Group",components:{"Sketch-picker":oo["Sketch"]},data:function(){return{text:"Group",fontsize:[12,14,16,18,20,24,28,32,36,40],groupData:{fillshow:!1,strokeshow:!1,textfillshow:!1,fontsizeshow:!1,groupfillshow:!1,showHead:!0,groupFill:"",stroke:"",fill:"",textAlign:"left",fontSize:14,fontStyle:"",fontWeight:"",textFill:""},theme:so.group}},watch:{"groupData.showHead":{handler:function(t){x.$emit("changeGroup",{mark:"showHead",showHead:t,group:this.group})}}},mounted:function(){var t=this;x.$on("selectGroup",(function(e){var i=e&&e.group;if(i){var o=i.getStyle();t.groupData=yo({},t.groupData,{},o),t.group=i}})),x.$on("changeLanguage",(function(t){c(t.language)})),this.language=localStorage.getItem("localeLanguage")||"zh",c(this.language)},methods:{align:function(t){x.$emit("align",{align:t})},showColorPicker:function(t){switch(t){case"groupfill":this.groupData.strokeshow=!1,this.groupData.textfillshow=!1,this.groupData.fontsizeshow=!1,this.groupData.fillshow=!1,this.groupData.groupfillshow?this.groupData.groupfillshow=!1:this.groupData.groupfillshow=!0;break;case"stroke":this.groupData.fillshow=!1,this.groupData.textfillshow=!1,this.groupData.fontsizeshow=!1,this.groupData.groupfillshow=!1,this.groupData.strokeshow?this.groupData.strokeshow=!1:this.groupData.strokeshow=!0;break;case"textfill":this.groupData.fillshow=!1,this.groupData.strokeshow=!1,this.groupData.fontsizeshow=!1,this.groupData.groupfillshow=!1,this.groupData.textfillshow?this.groupData.textfillshow=!1:this.groupData.textfillshow=!0;break;case"fontsize":this.groupData.fillshow=!1,this.groupData.strokeshow=!1,this.groupData.textfillshow=!1,this.groupData.groupfillshow=!1,this.groupData.fontsizeshow?this.groupData.fontsizeshow=!1:this.groupData.fontsizeshow=!0;break;case"fill":this.groupData.groupfillshow=!1,this.groupData.strokeshow=!1,this.groupData.textfillshow=!1,this.groupData.fontsizeshow=!1,this.groupData.fillshow?this.groupData.fillshow=!1:this.groupData.fillshow=!0;break}},getRgba:function(t){var e=t.rgba,i="rgba(".concat(e.r,",").concat(e.g,",").concat(e.b,",").concat(e.a,")");return i},updateFill:function(t){var e=this.getRgba(t);this.groupData.groupFill=e,x.$emit("changeGroup",{mark:"group",style:{fill:e},group:this.group})},updateStroke:function(t){var e=this.getRgba(t);this.groupData.stroke=e,x.$emit("changeGroup",{mark:"group",style:{stroke:e},group:this.group})},updateTextFill:function(t){var e=this.getRgba(t);this.groupData.textFill=e,x.$emit("changeGroup",{mark:"head",style:{textFill:e},group:this.group})},updateHeadFill:function(t){var e=this.getRgba(t);this.groupData.fill=e,x.$emit("changeGroup",{mark:"head",style:{fill:e},group:this.group})},setStyle:function(){"italic"==this.groupData.fontStyle?(this.groupData.fontStyle="",x.$emit("changeGroup",{mark:"head",style:{fontStyle:""},group:this.group})):(this.groupData.fontStyle="italic",x.$emit("changeGroup",{mark:"head",style:{fontStyle:"italic"},group:this.group}))},setBold:function(){"bold"==this.groupData.fontWeight?(this.groupData.fontWeight="",x.$emit("changeGroup",{mark:"head",style:{fontWeight:""},group:this.group})):(this.groupData.fontWeight="bold",x.$emit("changeGroup",{mark:"head",style:{fontWeight:"bold"},group:this.group}))},pickFontSize:function(t){this.groupData.fontSize!=t&&(this.groupData.fontSize=t,x.$emit("changeGroup",{mark:"head",style:{fontSize:t},group:this.group}))},setTextPos:function(t,e){this.groupData.textPosition!=e&&(this.groupData.textPosition=e,x.$emit("changeGroup",{mark:"head",style:{textPosition:e},group:this.group}))},hideColorPicker:function(){this.groupData.fillshow=!1,this.groupData.strokeshow=!1,this.groupData.textfillshow=!1,this.groupData.fontsizeshow=!1,this.groupData.groupfillshow=!1},hideWin:function(t){var e=t.target,i=!1;while(e){if(1==e.nodeType&&e&&e.className&&e.className.indexOf("vc-sketch")>-1){i=!0;break}e=e.parentElement}i||this.hideColorPicker()}}},vo=xo,mo=(i("9168"),Object(w["a"])(vo,fo,po,!1,null,"6edfa479",null)),wo=mo.exports,bo=function(){var t=this,e=t.$createElement;t._self._c;return t._m(0)},ko=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"canvas"},[i("div",{staticClass:"node-header"},[t._v("Canvas")]),i("div",{staticClass:"section-group"})])}],Oo={name:"Canvas",data:function(){return{shadow:!1}},mounted:function(){},methods:{changeShadow:function(){this.shadow=!this.shadow,x.$emit("shadow",{shadow:this.shadow})}}},To=Oo,Do=(i("0346"),Object(w["a"])(To,bo,ko,!1,null,"06173c74",null)),Po=Do.exports,jo=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"edge",on:{click:t.hideWin}},[i("div",{staticClass:"node-header"},[t._v("Relate Link")]),i("div",{staticClass:"section-group"},[i("h3",[t._v(t._s(t.$t("edge.head")))]),i("p",[i("span",[t._v(t._s(t.$t("edge.stroke")))]),i("span",{staticClass:"color-picker",style:{background:t.edgeData.stroke},on:{click:function(e){return e.stopPropagation(),t.showColorPicker("stroke")}}}),i("Sketch-picker",{directives:[{name:"show",rawName:"v-show",value:t.edgeData.strokeshow,expression:"edgeData.strokeshow"}],on:{input:t.updateStroke},model:{value:t.edgeData.stroke,callback:function(e){t.$set(t.edgeData,"stroke",e)},expression:"edgeData.stroke"}})],1),i("p",[i("span",[t._v(t._s(t.$t("edge.lineDash")))]),t._l(t.lineDash,(function(e,o){return i("span",{key:o,class:"iconfont right lineType lineDash "+e.icon+(t.edgeData.lineDashType==e.name?" active":""),on:{click:function(i){return i.stopPropagation(),t.changeLineDash(e.name)}}})}))],2),i("p",[i("span",[t._v(t._s(t.$t("edge.lineStyle")))]),i("span",{class:"iconfont icon-quxianjiantou right lineType"+("bs"==t.edgeData.type?" active":""),on:{click:function(e){return e.stopPropagation(),t.changeLineType("bs")}}}),i("span",{class:"iconfont icon-zhexianjiantou right lineType"+("polyline"==t.edgeData.type?" active":""),on:{click:function(e){return e.stopPropagation(),t.changeLineType("polyline")}}}),i("span",{class:"iconfont icon-zhixianjiantou right lineType"+("line"==t.edgeData.type?" active":""),on:{click:function(e){return e.stopPropagation(),t.changeLineType("line")}}})]),i("p",{directives:[{name:"show",rawName:"v-show",value:"polyline"==t.edgeData.type,expression:"edgeData.type=='polyline'"}]},[i("span",[t._v(t._s(t.$t("edge.turningDistance")))]),i("span",{staticClass:"font-size right color-picker",on:{click:function(e){return e.stopPropagation(),t.showColorPicker("ext")}}},[t._v(t._s(t.edgeData.ext))]),i("ul",{directives:[{name:"show",rawName:"v-show",value:t.edgeData.extshow,expression:"edgeData.extshow"}],staticClass:"ext-select"},t._l(t.exts,(function(e){return i("li",{key:e,on:{click:function(i){return t.pickExt(e)}}},[t._v(t._s(e))])})),0)])]),i("div",{staticClass:"section-group"},[i("h3",[t._v(t._s(t.$t("edge.font")))]),i("p",[i("span",[t._v(t._s(t.$t("edge.fontSize")))]),i("span",{staticClass:"font-size right color-picker",on:{click:function(e){return e.stopPropagation(),t.showColorPicker("fontsize")}}},[t._v(t._s(t.edgeData.fontSize))]),i("ul",{directives:[{name:"show",rawName:"v-show",value:t.edgeData.fontsizeshow,expression:"edgeData.fontsizeshow"}],staticClass:"font-size-select"},t._l(t.fontsize,(function(e){return i("li",{key:e,on:{click:function(i){return t.pickFontSize(e)}}},[t._v(t._s(e))])})),0)]),i("p",[i("span",[t._v(t._s(t.$t("edge.textFill")))]),i("span",{staticClass:"color-picker",style:{background:t.edgeData.textFill},on:{click:function(e){return e.stopPropagation(),t.showColorPicker("textFill")}}}),i("Sketch-picker",{directives:[{name:"show",rawName:"v-show",value:t.edgeData.textfillshow,expression:"edgeData.textfillshow"}],on:{input:t.updateTextFill},model:{value:t.edgeData.textFill,callback:function(e){t.$set(t.edgeData,"textFill",e)},expression:"edgeData.textFill"}})],1),i("p",[i("span",{staticClass:"left"},[t._v(t._s(t.$t("edge.fontStyle")))]),i("span",{class:"textPos right iconfont icon-qingxie"+("italic"==t.edgeData.fontStyle?" active":""),on:{click:function(e){return t.setStyle(e)}}}),i("span",{class:"textPos right iconfont icon-jiacu"+("bold"==t.edgeData.fontWeight?" active":""),on:{click:function(e){return t.setBold(e)}}})]),i("p",[i("span",[t._v(t._s(t.$t("edge.fill")))]),i("span",{staticClass:"color-picker",style:{background:t.edgeData.fill},on:{click:function(e){return e.stopPropagation(),t.showColorPicker("fill")}}}),i("Sketch-picker",{directives:[{name:"show",rawName:"v-show",value:t.edgeData.fillshow,expression:"edgeData.fillshow"}],on:{input:t.updateFill},model:{value:t.edgeData.fill,callback:function(e){t.$set(t.edgeData,"fill",e)},expression:"edgeData.fill"}})],1)])])},So=[];function Eo(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,o)}return i}function Co(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?Eo(Object(i),!0).forEach((function(e){Object(N["a"])(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):Eo(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}var zo={name:"Edge",components:{"Sketch-picker":oo["Sketch"]},data:function(){return{fontsize:[12,14,16,18,20,24,28,32,36,40],exts:[20,30,40,50,60,70,80,90,100,120,140,160,180,200,240,280,320,400,460,520,600,700,800,900,1e3],lineDash:[{dash:[6,2,2,2],name:"dashed",icon:"icon-line1"},{dash:[4,2],name:"dash",icon:"icon-line-dashed"},{dash:[1,1],name:"dott",icon:"icon-linedotted"},{dash:[0],name:"solid",icon:"icon-line"}],edgeData:{strokeshow:!1,fillshow:!1,textfillshow:!1,fontsizeshow:!1,extshow:!1,stroke:"",fontSize:12,fontStyle:"",fontWeight:"",fill:"",textFill:"",ext:30,lineDashType:"solid"},edge:null}},mounted:function(){var t=this;x.$on("selectEdge",(function(e){var i=e.edge.getData();t.edge=e.edge,t.edgeData=Co({},t.edgeData,{},i)})),x.$on("changeLanguage",(function(t){c(t.language)})),this.language=localStorage.getItem("localeLanguage")||"zh",c(this.language)},methods:{showColorPicker:function(t){switch(t){case"stroke":this.edgeData.fillshow=!1,this.edgeData.textfillshow=!1,this.edgeData.fontsizeshow=!1,this.edgeData.extshow=!1,this.edgeData.strokeshow?this.edgeData.strokeshow=!1:this.edgeData.strokeshow=!0;break;case"textFill":this.edgeData.fillshow=!1,this.edgeData.strokeshow=!1,this.edgeData.fontsizeshow=!1,this.edgeData.extshow=!1,this.edgeData.textfillshow?this.edgeData.textfillshow=!1:this.edgeData.textfillshow=!0;break;case"fontsize":this.edgeData.fillshow=!1,this.edgeData.strokeshow=!1,this.edgeData.textfillshow=!1,this.edgeData.extshow=!1,this.edgeData.fontsizeshow?this.edgeData.fontsizeshow=!1:this.edgeData.fontsizeshow=!0;break;case"fill":this.edgeData.fontsizeshow=!1,this.edgeData.strokeshow=!1,this.edgeData.textfillshow=!1,this.edgeData.extshow=!1,this.edgeData.fillshow?this.edgeData.fillshow=!1:this.edgeData.fillshow=!0;break;case"ext":this.edgeData.fontsizeshow=!1,this.edgeData.strokeshow=!1,this.edgeData.textfillshow=!1,this.edgeData.fillshow=!1,this.edgeData.extshow?this.edgeData.extshow=!1:this.edgeData.extshow=!0;break}},getRgba:function(t){var e=t.rgba,i="rgba(".concat(e.r,",").concat(e.g,",").concat(e.b,",").concat(e.a,")");return i},updateStroke:function(t){var e=this.getRgba(t);this.edgeData.stroke=e,x.$emit("changeEdge",{style:{stroke:e},mark:"line",edge:this.edge})},updateTextFill:function(t){var e=this.getRgba(t);this.edgeData.textFill=e,x.$emit("changeEdge",{style:{textFill:e},mark:"text",edge:this.edge})},updateFill:function(t){var e=this.getRgba(t);this.edgeData.fill=e,x.$emit("changeEdge",{style:{fill:e},mark:"text",edge:this.edge})},pickFontSize:function(t){this.edgeData.fontSize!=t&&(this.edgeData.fontSize=t,x.$emit("changeEdge",{mark:"text",style:{fontSize:t},edge:this.edge}))},pickExt:function(t){this.edgeData.ext!=t&&(this.edgeData.ext=t,x.$emit("changeEdge",{mark:"line",style:{ext:t},edge:this.edge}))},setStyle:function(){"italic"==this.edgeData.fontStyle?(this.edgeData.fontStyle="",x.$emit("changeEdge",{style:{fontStyle:""},edge:this.edge,mark:"text"})):(this.edgeData.fontStyle="italic",x.$emit("changeEdge",{style:{fontStyle:"italic"},edge:this.edge,mark:"text"}))},setBold:function(){"bold"==this.edgeData.fontWeight?(this.edgeData.fontWeight="",x.$emit("changeEdge",{style:{fontWeight:""},edge:this.edge,mark:"text"})):(this.edgeData.fontWeight="bold",x.$emit("changeEdge",{style:{fontWeight:"bold"},edge:this.edge,mark:"text"}))},changeLineType:function(t){this.edgeData.type=t,x.$emit("changeEdge",{mark:"type",style:{type:t},edge:this.edge})},changeLineDash:function(t){this.edgeData.lineDashType=t,x.$emit("changeEdge",{mark:"type",style:{lineDashType:t},edge:this.edge})},hideWin:function(t){var e=t.target,i=!1;while(e){if(1==e.nodeType&&e&&e.className&&e.className.indexOf("vc-sketch")>-1){i=!0;break}e=e.parentElement}i||this.hideColorPicker()},hideColorPicker:function(){this.edgeData.fillshow=!1,this.edgeData.strokeshow=!1,this.edgeData.textfillshow=!1,this.edgeData.fontsizeshow=!1,this.edgeData.extshow=!1}}},No=zo,Go=(i("d51a"),Object(w["a"])(No,jo,So,!1,null,"647d7996",null)),Ao=Go.exports,Fo={name:"Property",components:{Node:uo,Group:wo,"v-canvas":Po,Edge:Ao},data:function(){return{showCanvas:!0,showGroup:!1,showNode:!1,showLink:!1,showEdge:!1,node:null,group:null,nodes:null,edge:null}},mounted:function(){var t=this;x.$on("clearSelect",(function(){t.showGroup=!1,t.showNode=!1,t.showLink=!1,t.showCanvas=!0,t.showEdge=!1})),x.$on("selectNode",(function(){t.showGroup=!1,t.showNode=!0,t.showLink=!1,t.showCanvas=!1,t.showEdge=!1})),x.$on("selectNodes",(function(){t.showGroup=!1,t.showNode=!0,t.showLink=!1,t.showCanvas=!1,t.showEdge=!1})),x.$on("selectLink",(function(){t.showGroup=!1,t.showNode=!1,t.showLink=!0,t.showCanvas=!1,t.showEdge=!1})),x.$on("selectGroup",(function(){t.showGroup=!0,t.showNode=!1,t.showLink=!1,t.showCanvas=!1,t.showEdge=!1})),x.$on("selectEdge",(function(){t.showGroup=!1,t.showNode=!1,t.showLink=!1,t.showCanvas=!1,t.showEdge=!0}))},methods:{}},_o=Fo,Io=(i("6911"),Object(w["a"])(_o,Vi,to,!1,null,"cd75a2c2",null)),Bo=Io.exports,$o=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"flow-map"},[i("div",{staticClass:"flowmap-container",on:{mousedown:t.mousedown,mousemove:t.mousemove,mouseup:t.mouseup}},[i("div",{attrs:{id:"canvas-map"}})])])},Ro=[],Lo={name:"Map",data:function(){return{width:0,height:0,sx:0,sy:0,dx:0,dy:0,pos:[],drag:!1}},mounted:function(){var t=this,e=document.getElementById("canvas-map");this.width=e.offsetWidth,this.height=e.offsetHeight;var i=this.width/this.height;this.mapeditor=new Ci("canvas-map"),this.mapeditor.offEvent(),x.$on("refreshMap",(function(e){var o=e.editor;t.edit=e.editor;var n=JSON.stringify(o.getData()),s=o.getBoundingRect(o.nodes.concat(o.groups).concat(o.edges)),a=s.width,r=s.height,h=a/r,c=1;c=h>i?t.width/s.width:t.height/s.height,t.mapeditor.init(JSON.parse(n),!0),t.mapeditor.attr({position:[-s.x*c,-s.y*c],scale:[c,c]})}))},methods:{mousedown:function(t){this.pos=this.edit.position.slice(),this.sx=t.offsetX,this.sy=t.offsetY,this.drag=!0},mousemove:function(t){this.drag&&(this.dx=t.offsetX-this.sx,this.dy=t.offsetY-this.sy,this.edit.attr({position:[this.pos[0]-2*this.dx,this.pos[1]-2*this.dy]}))},mouseup:function(){this.drag=!1,this.dx=0,this.dy=0,this.pos=[0,0]}}},Wo=Lo,Mo=(i("5490"),Object(w["a"])(Wo,$o,Ro,!1,null,null,null)),Ho=Mo.exports,qo={name:"MainPage",components:{Header:k,Toolbar:S,Editor:Ki,Property:Bo,Map:Ho},data:function(){return{}},mounted:function(){}},Uo=qo,Jo=(i("8e49"),Object(w["a"])(Uo,f,p,!1,null,"22f80f01",null)),Yo=Jo.exports,Xo={name:"app",components:{MainPage:Yo}},Qo=Xo,Zo=(i("034f"),Object(w["a"])(Qo,d,u,!1,null,null,null)),Ko=Zo.exports;i("a75e");o["a"].config.productionTip=!1,new o["a"]({i18n:l,render:function(t){return t(Ko)}}).$mount("#app")},6911:function(t,e,i){"use strict";var o=i("12be"),n=i.n(o);n.a},"7afc":function(t,e,i){"use strict";var o=i("cd8a"),n=i.n(o);n.a},"85ec":function(t,e,i){},"8dc2":function(t,e,i){"use strict";var o=i("d79d"),n=i.n(o);n.a},"8e49":function(t,e,i){"use strict";var o=i("9860"),n=i.n(o);n.a},9168:function(t,e,i){"use strict";var o=i("4813"),n=i.n(o);n.a},9860:function(t,e,i){},a6b6:function(t,e,i){},a75e:function(t,e,i){},b2c8:function(t,e,i){"use strict";var o=i("3821"),n=i.n(o);n.a},cd8a:function(t,e,i){},d51a:function(t,e,i){"use strict";var o=i("e489"),n=i.n(o);n.a},d79d:function(t,e,i){},e489:function(t,e,i){},edd4:function(t){t.exports=JSON.parse('{"node":{"title1":"Single Node","titl2":"Multiple Node","head":"Style","fill":"Fill","stroke":"Stroke","font":"Font","fontStyle":"Font Style","fontSize":"Font Size","textFill":"Text Fill","nodeAlign":"Node Alignment","position":"Position","prefabrication":"Prefabrication Style"},"group":{"head":"Style","fill":"Fill","stroke":"Stroke","showHead":"Show Head","font":"Font","fontStyle":"Font Style","fontSize":"Font Size","fontBackground":"Font Background","align":"Text Align","textFill":"Text Fill","position":"Position","prefabrication":"Prefabrication Style"},"edge":{"head":"Style","fill":"Fill","stroke":"Stroke","lineDash":"Line Dash","lineStyle":"Line Style","turningDistance":"Turning Distance","font":"Font","fontStyle":"Font Style","fontSize":"Font Size","textFill":"Text Fill","nodeAlign":"Node Alignment","position":"Position","prefabrication":"Prefabrication Style"}}')},ee91:function(t,e,i){}});
//# sourceMappingURL=app.04112fcf.js.map